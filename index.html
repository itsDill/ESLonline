<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Google AdSense - Deferred for better LCP -->
    <meta name="google-adsense-account" content="ca-pub-2456627863532019" />
    <meta
      name="description"
      content="Play free ESL games online, explore fun activities, and learn English with interactive lessons. Perfect for students & teachers worldwide."
    />
    <meta
      name="keywords"
      content="ESL online learning, English language courses, IELTS preparation, TOEIC test prep, business English, coding tutorials, programming lessons, educational games, online teachers, interactive learning platform, English grammar, vocabulary building"
    />
    <meta name="author" content="ESL Fun Online" />
    <meta name="robots" content="index, follow" />
    <meta name="language" content="English" />
    <meta name="geo.region" content="TH" />
    <meta name="geo.placename" content="Thailand" />
    <meta name="theme-color" content="#46bbe5" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="format-detection" content="telephone=no" />

    <!-- Open Graph tags for social sharing -->
    <!-- Note: Add your Google Search Console verification code here after registering your site -->
    <!-- <meta name="google-site-verification" content="YOUR_VERIFICATION_CODE" /> -->
    <link rel="alternate" hreflang="en" href="https://eslfunonline.com/" />

    <!-- Open Graph tags for social sharing -->
    <meta
      property="og:title"
      content="ESL Fun Online | Free ESL Games, Activities & Lessons"
    />
    <meta
      property="og:description"
      content="Play free ESL games online, explore fun activities, and learn English with interactive lessons. Perfect for students & teachers worldwide."
    />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://eslfunonline.com/" />
    <meta
      property="og:image"
      content="https://eslfunonline.com/images/hero.webp"
    />
    <meta property="og:site_name" content="ESL Fun Online" />
    <meta property="og:locale" content="en_US" />

    <!-- Twitter Card tags -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta
      name="twitter:title"
      content="ESL Fun Online | Free ESL Games, Activities & Lessons"
    />
    <meta
      name="twitter:description"
      content="Play free ESL games online, explore fun activities, and learn English with interactive lessons. Perfect for students & teachers worldwide."
    />
    <meta
      name="twitter:image"
      content="https://eslfunonline.com/images/hero.webp"
    />
    <meta name="twitter:creator" content="@eslfunonline" />
    <meta name="twitter:site" content="@eslfunonline" />

    <link rel="canonical" href="https://eslfunonline.com/" />

    <!-- Preconnect to external domains -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="dns-prefetch" href="https://www.googletagmanager.com" />
    <link rel="dns-prefetch" href="https://pagead2.googlesyndication.com" />

    <!-- Conditional preload for hero image on desktop only -->
    <link
      rel="preload"
      href="images/hero.webp"
      as="image"
      media="(min-width: 769px)"
    />

    <!-- Preload critical CSS for mobile -->
    <link
      rel="preload"
      href="css/hero-mobile.css"
      as="style"
      media="(max-width: 768px)"
    />

    <title>ESL Fun Online | Free ESL Games, Activities & Lessons</title>

    <!-- Favicon and Icons - Optimized for Google Search -->
    <link rel="icon" href="/favicon.ico" sizes="any" />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="/images/favicon-16x16.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="/images/favicon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="48x48"
      href="/images/favicon-48x48.png"
    />
    <link rel="apple-touch-icon" sizes="180x180" href="/images/1.png" />
    <link
      rel="icon"
      type="image/png"
      sizes="192x192"
      href="/images/favicon-192x192.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="512x512"
      href="/images/favicon-512x512.png"
    />

    <!-- Enhanced Structured Data for SEO -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": ["EducationalOrganization", "OnlineStore"],
        "name": "ESL Fun Online",
        "alternateName": "ESL Fun Online Learning Platform",
        "description": "Premier online learning platform offering comprehensive English language courses, coding tutorials, test preparation, and interactive educational resources for learners worldwide",
        "url": "https://eslfunonline.com",
        "logo": {
          "@type": "ImageObject",
          "url": "https://eslfunonline.com/images/1.png",
          "width": 1181,
          "height": 1181,
          "contentUrl": "https://eslfunonline.com/images/1.png",
          "caption": "ESL Fun Online Logo"
        },
        "image": "https://eslfunonline.com/images/hero.webp",
        "sameAs": [
          "https://www.facebook.com/eslfunonline",
          "https://twitter.com/eslfunonline",
          "https://www.instagram.com/eslfunonline",
          "https://www.linkedin.com/company/eslfunonline"
        ],
        "address": {
          "@type": "PostalAddress",
          "addressCountry": "Global"
        },
        "contactPoint": {
          "@type": "ContactPoint",
          "contactType": "Customer Service",
          "availableLanguage": ["English", "Thai"],
          "areaServed": "Global"
        },
        "offers": [
          {
            "@type": "Offer",
            "name": "English Language Courses",
            "description": "Comprehensive English learning courses from beginner to advanced levels",
            "category": "Educational Services",
            "availability": "https://schema.org/InStock",
            "price": "350",
            "priceCurrency": "THB"
          },
          {
            "@type": "Offer",
            "name": "Coding & Programming Courses",
            "description": "Learn programming languages and computer science fundamentals",
            "category": "Technical Education",
            "availability": "https://schema.org/InStock",
            "price": "350",
            "priceCurrency": "THB"
          },
          {
            "@type": "Offer",
            "name": "Test Preparation Services",
            "description": "IELTS, TOEIC, and other English proficiency test preparation",
            "category": "Test Preparation",
            "availability": "https://schema.org/InStock",
            "price": "420",
            "priceCurrency": "THB"
          }
        ],
        "areaServed": "Global",
        "availableLanguage": ["English", "Thai"],
        "foundingDate": "2020",
        "slogan": "Transform Your English & Coding Skills",
        "educationalCredentialAwarded": "Certificate of Completion",
        "hasCredential": {
          "@type": "EducationalOccupationalCredential",
          "name": "English Proficiency Certificate",
          "credentialCategory": "Language Certification"
        },
        "audience": {
          "@type": "EducationalAudience",
          "educationalRole": "student"
        },
        "teaches": [
          "English as a Second Language",
          "IELTS Test Preparation",
          "TOEIC Test Preparation",
          "Business English",
          "Programming Languages",
          "Computer Science Basics",
          "Web Development",
          "Educational Gaming"
        ],
        "aggregateRating": {
          "@type": "AggregateRating",
          "ratingValue": "4.8",
          "reviewCount": "250",
          "bestRating": "5",
          "worstRating": "1"
        }
      }
    </script>

    <!-- Google tag (gtag.js) -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-9G9RD6BHLN"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
      gtag("config", "G-9G9RD6BHLN");
    </script>

    <!-- Font Awesome - Deferred loading for better LCP -->
    <link
      rel="preload"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      as="style"
      onload="
        this.onload = null;
        this.rel = 'stylesheet';
      "
    />
    <noscript
      ><link
        rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    /></noscript>
    <!-- Google Fonts - Optimized with font-display swap -->
    <link
      rel="preload"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Poppins:wght@600;700&display=swap"
      as="style"
      onload="
        this.onload = null;
        this.rel = 'stylesheet';
      "
    />
    <noscript
      ><link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Poppins:wght@600;700&display=swap"
        rel="stylesheet"
    /></noscript>

    <!-- Critical inline CSS for instant LCP -->
    <style>
      /* Critical above-the-fold styles for LCP optimization */
      :root {
        --primary-color: #46bbe5;
        --text-primary: #1f2937;
        --bg-primary: #fff;
      }
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      body {
        font-family:
          Inter,
          -apple-system,
          BlinkMacSystemFont,
          sans-serif;
        line-height: 1.6;
      }
      header {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        z-index: 1000;
        background: rgba(255, 255, 255, 0.98);
        backdrop-filter: blur(20px);
        height: 70px;
      }
      .navbar {
        display: flex;
        align-items: center;
        justify-content: space-between;
        height: 70px;
        padding: 0 1rem;
        max-width: 1400px;
        margin: 0 auto;
      }
      .logo-container {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        text-decoration: none;
      }
      .logo-image {
        width: 40px;
        height: 40px;
      }
      .logo-text {
        font-size: 1.25rem;
        font-weight: 700;
        color: var(--text-primary);
      }
      .nav-links {
        display: none;
      }
      .mobile-toggle {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 44px;
        height: 44px;
        border: none;
        background: var(--primary-color);
        color: #fff;
        border-radius: 8px;
        cursor: pointer;
      }
      .hero {
        background: linear-gradient(
          135deg,
          #46bbe5 0%,
          #2d9cdb 50%,
          #10b981 100%
        );
        padding: calc(70px + 1.5rem) 1rem 2rem;
        min-height: auto;
      }
      .hero-content {
        max-width: 800px;
        margin: 0 auto;
        text-align: center;
      }
      .hero-title {
        font-size: 1.75rem;
        color: #fff;
        font-weight: 700;
        line-height: 1.2;
        margin-bottom: 1rem;
      }
      .hero-subtitle {
        font-size: 1rem;
        color: rgba(255, 255, 255, 0.95);
        margin-bottom: 1.5rem;
      }
      @media (min-width: 769px) {
        .hero {
          padding: calc(70px + 3rem) 2rem 4rem;
        }
        .hero-title {
          font-size: 3rem;
        }
        .mobile-toggle {
          display: none;
        }
        .nav-links {
          display: flex;
          gap: 1rem;
        }
      }
    </style>
    <!-- Core Styles - Loaded async for better LCP -->
    <link
      rel="preload"
      href="css/main.css?v=1763019900"
      as="style"
      onload="
        this.onload = null;
        this.rel = 'stylesheet';
      "
    />
    <link
      rel="preload"
      href="css/header.css?v=1763019900"
      as="style"
      onload="
        this.onload = null;
        this.rel = 'stylesheet';
      "
    />
    <link
      rel="preload"
      href="css/hero-unified.css?v=1763019900"
      as="style"
      onload="
        this.onload = null;
        this.rel = 'stylesheet';
      "
    />
    <link
      rel="preload"
      href="css/index-page.css?v=1763019900"
      as="style"
      onload="
        this.onload = null;
        this.rel = 'stylesheet';
      "
    />
    <link
      rel="preload"
      href="css/modern-enhancements.css?v=1763019900"
      as="style"
      onload="
        this.onload = null;
        this.rel = 'stylesheet';
      "
    />
    <noscript>
      <link rel="stylesheet" href="css/main.css?v=1763019900" />
      <link rel="stylesheet" href="css/header.css?v=1763019900" />
      <link rel="stylesheet" href="css/hero-unified.css?v=1763019900" />
      <link rel="stylesheet" href="css/index-page.css?v=1763019900" />
      <link rel="stylesheet" href="css/modern-enhancements.css?v=1763019900" />
    </noscript>
    <!-- Mobile Optimizations -->
    <link
      rel="preload"
      href="css/mobile-optimized.css?v=1763019900"
      as="style"
      onload="
        this.onload = null;
        this.rel = 'stylesheet';
      "
    />
    <link
      rel="stylesheet"
      href="css/hero-mobile.css?v=1763019900"
      media="(max-width: 768px)"
    />
    <!-- Deferred non-critical styles -->
    <link
      rel="preload"
      href="css/index-page-improvements.css?v=1763019900"
      as="style"
      onload="
        this.onload = null;
        this.rel = 'stylesheet';
      "
    />
    <link
      rel="preload"
      href="css/learning-tips-redesign.css?v=1763019900"
      as="style"
      onload="
        this.onload = null;
        this.rel = 'stylesheet';
      "
    />
    <noscript>
      <link rel="stylesheet" href="css/mobile-optimized.css?v=1763019900" />
      <link
        rel="stylesheet"
        href="css/index-page-improvements.css?v=1763019900"
      />
      <link
        rel="stylesheet"
        href="css/learning-tips-redesign.css?v=1763019900"
      />
    </noscript>

    <!-- Script to show content once styles are loaded -->
    <script>
      // Show content immediately after head is parsed
      document.documentElement.classList.add("loaded");

      // Fallback: ensure content shows even if styles fail to load
      window.addEventListener("DOMContentLoaded", function () {
        document.documentElement.classList.add("loaded");
      });
    </script>
  </head>

  <body>
    <!-- Scroll Progress Indicator -->
    <div class="scroll-progress" id="scrollProgress"></div>
    <!-- Header & Navigation -->
    <header>
      <div class="container">
        <nav class="navbar">
          <a href="index.html" class="logo-container">
            <img
              src="images/1.png"
              alt="ESL Fun Online Logo"
              class="logo-image"
              width="40"
              height="40"
            />
            <span class="logo-text">ESL Fun Online</span>
          </a>

          <ul
            class="nav-links"
            id="navLinks"
            role="menubar"
            aria-label="Main navigation"
          >
            <li class="nav-item" role="none">
              <a href="index.html" class="nav-link" role="menuitem">
                <i class="fas fa-home"></i>
                Home
              </a>
            </li>
            <li class="nav-item" role="none">
              <a
                href="#"
                class="nav-link"
                role="menuitem"
                aria-haspopup="true"
                aria-expanded="false"
              >
                <i class="fas fa-book"></i>
                English
                <i class="fas fa-chevron-down"></i>
              </a>
              <div class="dropdown" role="menu" aria-label="English submenu">
                <a href="english/grammar.html" class="dropdown-item">
                  <i class="fas fa-spell-check"></i>
                  Grammar Guides
                </a>
                <a href="english/vocabguide.html" class="dropdown-item">
                  <i class="fas fa-book-open"></i>
                  Vocabulary Building
                </a>
                <a href="english/worksheets.html" class="dropdown-item">
                  <i class="fas fa-file-alt"></i>
                  Worksheets
                </a>
                <a href="english/writingf.html" class="dropdown-item">
                  <i class="fas fa-pen"></i>
                  Writing for Success
                </a>
                <a href="english/business.html" class="dropdown-item">
                  <i class="fas fa-briefcase"></i>
                  Business English
                </a>
                <a href="english/test.html" class="dropdown-item">
                  <i class="fas fa-graduation-cap"></i>
                  Test Preparation
                </a>
              </div>
            </li>
            <li class="nav-item">
              <a href="#" class="nav-link">
                <i class="fas fa-code"></i>
                Coding
                <i class="fas fa-chevron-down"></i>
              </a>
              <div class="dropdown">
                <a href="coding/computerbasics.html" class="dropdown-item">
                  <i class="fas fa-desktop"></i>
                  Computer Basics
                </a>
                <a href="coding/ai.html" class="dropdown-item">
                  <i class="fas fa-robot"></i>
                  AI Basics
                </a>
                <a href="coding/codingresources.html" class="dropdown-item">
                  <i class="fas fa-code"></i>
                  Coding Basics
                </a>
                <a href="coding/webdev.html" class="dropdown-item">
                  <i class="fas fa-globe"></i>
                  Web Development
                </a>
                <a href="coding/javascript.html" class="dropdown-item">
                  <i class="fab fa-js-square"></i>
                  JavaScript
                </a>
                <a href="coding/python.html" class="dropdown-item">
                  <i class="fab fa-python"></i>
                  Python
                </a>
              </div>
            </li>

            <li class="nav-item">
              <a href="games/games.html" class="nav-link">
                <i class="fas fa-dice"></i>
                Games
              </a>
            </li>
            <li class="nav-item">
              <a href="tools/tools.html" class="nav-link">
                <i class="fas fa-tools"></i>
                Toolkit
              </a>
            </li>
            <li class="nav-item">
              <a href="blog/blog.html" class="nav-link">
                <i class="fas fa-book-open"></i>
                Blog
              </a>
            </li>
          </ul>

          <div class="controls">
            <button
              class="control-btn theme-toggle"
              id="themeToggle"
              aria-label="Toggle dark mode"
            >
              <i class="fas fa-moon"></i>
            </button>
            <a
              class="control-btn admin-toggle"
              id="adminToggle"
              aria-label="Admin"
              href="login.html"
            >
              <i class="fas fa-user-shield"></i>
            </a>
          </div>
          <button
            class="control-btn mobile-toggle"
            id="mobileToggle"
            aria-label="Toggle mobile menu"
          >
            <i class="fas fa-bars"></i>
          </button>
        </nav>
      </div>
    </header>

    <!-- Optimized Mobile Menu Script - INP optimized with passive listeners -->
    <script>
      (function () {
        "use strict";
        var isMenuOpen = false,
          lastToggle = 0;

        function initMobileMenu() {
          var mobileToggle = document.getElementById("mobileToggle");
          var navLinks = document.getElementById("navLinks");
          if (!mobileToggle || !navLinks) return;

          function toggleMenu() {
            isMenuOpen = !isMenuOpen;
            var icon = mobileToggle.querySelector("i");
            if (isMenuOpen) {
              navLinks.classList.add("active");
              document.body.classList.add("mobile-menu-open");
              document.body.style.overflow = "hidden";
              if (icon) icon.className = "fas fa-times";
            } else {
              navLinks.classList.remove("active");
              document.body.classList.remove("mobile-menu-open");
              document.body.style.overflow = "";
              if (icon) icon.className = "fas fa-bars";
              // Use requestAnimationFrame for DOM updates (better INP)
              requestAnimationFrame(function () {
                document
                  .querySelectorAll(".nav-item.mobile-open")
                  .forEach(function (item) {
                    item.classList.remove(
                      "mobile-open",
                      "mobile-dropdown-open",
                    );
                  });
              });
            }
          }

          // Single touch handler only (prevents double-firing, better INP)
          mobileToggle.addEventListener(
            "click",
            function (e) {
              var now = Date.now();
              if (now - lastToggle < 250) return;
              lastToggle = now;
              e.preventDefault();
              toggleMenu();
            },
            { passive: false },
          );

          // Passive touch listeners for better scrolling performance
          navLinks.addEventListener("touchstart", function () {}, {
            passive: true,
          });

          // Dropdown handling - event delegation (single listener, better INP)
          navLinks.addEventListener(
            "click",
            function (e) {
              if (window.innerWidth > 768) return;
              var link = e.target.closest(".nav-link");
              if (!link || e.target.closest(".dropdown-item")) return;
              var item = link.closest(".nav-item");
              var dropdown = item && item.querySelector(".dropdown");
              if (!dropdown) return;

              e.preventDefault();
              var isOpen = item.classList.contains("mobile-open");
              // Close others first
              document
                .querySelectorAll(".nav-item.mobile-open")
                .forEach(function (other) {
                  if (other !== item)
                    other.classList.remove(
                      "mobile-open",
                      "mobile-dropdown-open",
                    );
                });
              item.classList.toggle("mobile-open", !isOpen);
              item.classList.toggle("mobile-dropdown-open", !isOpen);
            },
            { passive: false },
          );

          // Close menu on outside click - use capture for efficiency
          document.addEventListener(
            "click",
            function (e) {
              if (
                window.innerWidth <= 768 &&
                isMenuOpen &&
                !mobileToggle.contains(e.target) &&
                !navLinks.contains(e.target)
              ) {
                toggleMenu();
              }
            },
            { passive: true, capture: true },
          );

          // Resize handler with debounce for better performance
          var resizeTimer;
          window.addEventListener(
            "resize",
            function () {
              clearTimeout(resizeTimer);
              resizeTimer = setTimeout(function () {
                if (window.innerWidth > 768 && isMenuOpen) toggleMenu();
              }, 100);
            },
            { passive: true },
          );
        }

        // Initialize immediately
        if (document.readyState === "loading") {
          document.addEventListener("DOMContentLoaded", initMobileMenu);
        } else {
          initMobileMenu();
        }
      })();
    </script>

    <!-- Enhanced Hero Section -->
    <section class="hero" id="hero">
      <div class="floating-elements">
        <div class="floating-element">
          <i
            class="fas fa-book"
            style="font-size: 2rem; color: rgba(255, 255, 255, 0.3)"
          ></i>
        </div>
        <div class="floating-element">
          <i
            class="fas fa-code"
            style="font-size: 2rem; color: rgba(255, 255, 255, 0.3)"
          ></i>
        </div>
        <div class="floating-element">
          <i
            class="fas fa-graduation-cap"
            style="font-size: 2rem; color: rgba(255, 255, 255, 0.3)"
          ></i>
        </div>
      </div>

      <div class="hero-content">
        <span class="hero-badge">
          <i class="fas fa-star"></i> Free Learning Platform
        </span>
        <h1 class="hero-title">Fun ESL Games & Online English Learning</h1>
        <p class="hero-subtitle">
          ESL Fun Online offers free, interactive games and activities for
          English learners of all levels. Transform your skills with expert
          lessons and engaging content.
        </p>

        <div class="hero-stats" role="group" aria-label="Platform statistics">
          <div class="stat-item">
            <span
              class="stat-number"
              data-target="100+"
              aria-label="Over 100 learning resources"
              >100+</span
            >
            <span class="stat-label">Learning Resources</span>
          </div>
          <div class="stat-item">
            <span
              class="stat-number"
              data-target="95%"
              aria-label="95 percent user satisfaction"
              >95%</span
            >
            <span class="stat-label">User Satisfaction</span>
          </div>
          <div class="stat-item">
            <span
              class="stat-number"
              data-target="24/7"
              aria-label="24 hours 7 days platform access"
              >24/7</span
            >
            <span class="stat-label">Platform Access</span>
          </div>
        </div>

        <div class="hero-cta">
          <a href="lessons.html" class="cta-primary cta-featured">
            <i class="fas fa-chalkboard-teacher"></i>
            Browse Lessons
          </a>
          <a href="games/games.html" class="cta-primary">
            <i class="fas fa-gamepad"></i>
            Play Games
          </a>
        </div>

        <div class="hero-cta hero-cta-secondary">
          <a href="english/grammar.html" class="cta-secondary">
            <i class="fas fa-book"></i>
            Grammar
          </a>
          <a href="english/test.html" class="cta-secondary">
            <i class="fas fa-graduation-cap"></i>
            Test Prep
          </a>
          <a href="coding/codingresources.html" class="cta-secondary">
            <i class="fas fa-code"></i>
            Coding
          </a>
        </div>
      </div>

      <button
        class="scroll-indicator"
        onclick="scrollToSection('features')"
        aria-label="Scroll to explore more content"
      >
        <span class="scroll-text">Explore More</span>
        <i class="fas fa-chevron-down" aria-hidden="true"></i>
      </button>
    </section>

    <!-- Features Showcase Section -->
    <section class="features-showcase" id="features">
      <div class="container">
        <div class="section-header">
          <h2 class="section-title">Featured Resources</h2>
          <p class="section-subtitle">
            Essential learning materials and tools to accelerate your English
            learning journey.
          </p>
        </div>

        <div class="features-grid">
          <div class="feature-card">
            <div class="feature-icon">
              <i class="fas fa-comments"></i>
            </div>
            <h3 class="feature-title">50 Essential Idioms</h3>
            <p class="feature-description">
              Master the most commonly used English idioms with clear
              explanations, examples, and practice exercises to sound more
              natural.
            </p>
            <a href="english/idioms.html" class="feature-link">
              Learn Idioms <i class="fas fa-arrow-right"></i>
            </a>
          </div>

          <div class="feature-card">
            <div class="feature-icon">
              <i class="fas fa-puzzle-piece"></i>
            </div>
            <h3 class="feature-title">50 Essential Phrasal Verbs</h3>
            <p class="feature-description">
              Unlock the secrets of phrasal verbs with comprehensive guides
              covering the most important combinations for everyday English.
            </p>
            <a href="english/phrasal-verbs.html" class="feature-link">
              Study Phrasal Verbs <i class="fas fa-arrow-right"></i>
            </a>
          </div>

          <div class="feature-card">
            <div class="feature-icon">
              <i class="fas fa-clock"></i>
            </div>
            <h3 class="feature-title">Verb Tenses Mastery</h3>
            <p class="feature-description">
              Master all English verb tenses with detailed explanations,
              timeline charts, and practical exercises for perfect grammar.
            </p>
            <a href="english/verb-tenses.html" class="feature-link">
              Master Tenses <i class="fas fa-arrow-right"></i>
            </a>
          </div>
        </div>
      </div>
    </section>

    <!-- Explore Learning Paths Section -->
    <section class="learning-paths-section">
      <div class="container">
        <div class="section-header">
          <h2 class="section-title">ðŸš€ Your Learning Journey Starts Here</h2>
          <p class="section-subtitle">
            Choose your path and unlock your potential with interactive lessons
          </p>
        </div>

        <div class="paths-grid">
          <!-- Business English Card -->
          <div class="path-card business">
            <div class="path-card-icon">
              <i class="fas fa-briefcase"></i>
            </div>
            <h3>Business English</h3>
            <p>
              Professional communication, presentations, and workplace skills
            </p>
            <a href="english/business.html" class="path-card-cta">
              Start Now <i class="fas fa-arrow-right"></i>
            </a>
          </div>

          <!-- Grammar & Vocabulary Card -->
          <div class="path-card grammar">
            <div class="path-card-icon">
              <i class="fas fa-book"></i>
            </div>
            <h3>Grammar & Vocabulary</h3>
            <p>
              Build strong foundations with comprehensive grammar rules,
              vocabulary lessons, and practice exercises.
            </p>
            <a href="english/grammar.html" class="path-card-cta">
              Start Now <i class="fas fa-arrow-right"></i>
            </a>
          </div>

          <div class="feature-card">
            <div class="feature-icon">
              <i class="fas fa-graduation-cap"></i>
            </div>
            <h3 class="feature-title">Test Preparation</h3>
            <p class="feature-description">
              Prepare for IELTS, TOEIC, TOEFL, and other English proficiency
              exams with expert guidance.
            </p>
            <a href="english/test.html" class="feature-link">
              Explore Test Prep <i class="fas fa-arrow-right"></i>
            </a>
          </div>

          <div class="feature-card">
            <div class="feature-icon">
              <i class="fas fa-laptop-code"></i>
            </div>
            <h3 class="feature-title">Coding</h3>
            <p class="feature-description">
              Learn programming fundamentals, web development, and computer
              science skills from beginner to advanced.
            </p>
            <a href="coding/codingresources.html" class="feature-link">
              Start Coding Path <i class="fas fa-arrow-right"></i>
            </a>
          </div>
        </div>
      </div>
    </section>

    <!-- Ad Placement 1 -->
    <!-- Interactive Activity Section -->
    <section class="activity-section" id="activity">
      <div class="container">
        <div class="activity-container">
          <h2 class="activity-title">
            <span class="challenge-badge">âš¡ ULTIMATE TEST</span>
            Only 1% Can Pass This English Mastery Test!
          </h2>
          <p class="activity-subtitle">
            From everyday English to expert-level mastery. Start easy, but can
            you survive the final questions that stump even teachers?
          </p>

          <div class="vocabulary-game" id="vocabularyGame">
            <div class="word-card" id="wordCard">Loading...</div>
            <div class="options-grid" id="optionsGrid">
              <!-- Options will be populated by JavaScript -->
            </div>
            <div class="activity-score" id="gameScore">Score: 0/0</div>
          </div>

          <button onclick="resetGame()" class="reset-game-btn">
            <i class="fas fa-shuffle"></i> New Challenge
          </button>
        </div>
      </div>
    </section>

    <!-- Ad Placement 2 -->
    <!-- Latest Blog Posts Section -->
    <section class="blog-preview-section">
      <div class="container">
        <div class="section-header">
          <h2>Latest Learning Tips & Insights</h2>
          <p>
            Stay updated with proven English learning strategies and expert
            advice
          </p>
        </div>

        <div class="blog-posts-grid">
          <div
            class="blog-post-card learn-tip-card"
            onclick="window.location.href = 'blog/lesson-technology.html'"
          >
            <div class="blog-post-category">ESL Lessons</div>
            <h3>ðŸ’» Technology Lesson: Interactive ESL for 12-Year-Olds</h3>
            <p>
              Complete interactive lesson with 10 vocabulary words, bingo game,
              grammar focus, and random generators. Perfect for teaching
              technology vocabulary!
            </p>
            <div class="blog-post-meta">
              <span><i class="fas fa-calendar"></i> Just Now</span>
              <span><i class="fas fa-clock"></i> 45-60 min</span>
            </div>
          </div>

          <div
            class="blog-post-card learn-tip-card"
            onclick="window.location.href = 'blog/grammar-mistakes.html'"
          >
            <div class="blog-post-category">Grammar</div>
            <h3>5 Common Grammar Mistakes to Avoid</h3>
            <p>
              Learn about the most frequent grammar errors that even advanced
              English learners make and how to fix them...
            </p>
            <div class="blog-post-meta">
              <span><i class="fas fa-calendar"></i> 1 week ago</span>
              <span><i class="fas fa-clock"></i> 7 min read</span>
            </div>
          </div>
        </div>

        <div style="text-align: center; margin-top: 3rem">
          <a
            href="blog/blog.html"
            style="
              background: rgba(255, 255, 255, 0.2);
              color: white;
              padding: 1rem 2rem;
              border-radius: 50px;
              text-decoration: none;
              font-weight: 600;
              border: 2px solid rgba(255, 255, 255, 0.3);
              transition: all 0.3s ease;
              display: inline-flex;
              align-items: center;
              gap: 0.5rem;
              backdrop-filter: blur(10px);
            "
            onmouseover="this.style.background = 'rgba(255, 255, 255, 0.3)'"
            onmouseout="this.style.background = 'rgba(255, 255, 255, 0.2)'"
          >
            <i class="fas fa-book-open"></i>
            Read More Articles
          </a>
        </div>
      </div>
    </section>

    <!-- About Us Section -->
    <section class="about-section">
      <div class="container">
        <div class="about-content">
          <div class="about-text">
            <div class="section-header">
              <h2 class="section-title">About ESL Fun Online</h2>
              <p class="section-subtitle">
                Your trusted partner in language learning and skill development
              </p>
            </div>

            <div class="about-description">
              <p>
                Founded in 2020, ESL Fun Online has emerged as a leading
                educational platform dedicated to making English learning and
                coding education accessible, engaging, and effective for
                learners worldwide.
              </p>

              <p>
                Our mission is to break down language barriers and bridge the
                digital divide by providing high-quality, interactive learning
                experiences that empower students to achieve their personal and
                professional goals.
              </p>
            </div>

            <div class="about-features">
              <div class="feature-item">
                <div class="feature-icon-small">
                  <i class="fas fa-award"></i>
                </div>
                <div class="feature-content">
                  <h4>Certified Excellence</h4>
                  <p>
                    All our instructors are certified professionals with proven
                    teaching experience
                  </p>
                </div>
              </div>

              <div class="feature-item">
                <div class="feature-icon-small">
                  <i class="fas fa-globe"></i>
                </div>
                <div class="feature-content">
                  <h4>Global Reach</h4>
                  <p>
                    Serving students in over 50 countries with culturally
                    adapted content
                  </p>
                </div>
              </div>

              <div class="feature-item">
                <div class="feature-icon-small">
                  <i class="fas fa-rocket"></i>
                </div>
                <div class="feature-content">
                  <h4>Innovation Focus</h4>
                  <p>
                    Cutting-edge learning technology and interactive
                    methodologies
                  </p>
                </div>
              </div>
            </div>
          </div>

          <div class="about-visual">
            <div class="brand-showcase">
              <div class="logo-display">
                <img
                  src="images/1.png"
                  alt="ESL Fun Online Logo"
                  class="about-logo"
                />
                <h3>ESL Fun Online</h3>
                <p class="brand-tagline">Transform Your Future</p>
              </div>

              <div class="credentials">
                <div class="credential-item">
                  <i class="fas fa-certificate"></i>
                  <span>Accredited Learning Platform</span>
                </div>
                <div class="credential-item">
                  <i class="fas fa-shield-alt"></i>
                  <span>Secure & Trusted</span>
                </div>
                <div class="credential-item">
                  <i class="fas fa-book-open"></i>
                  <span>1000+ Learning Resources</span>
                </div>
                <div class="credential-item">
                  <i class="fas fa-star"></i>
                  <span>Quality Education Since 2020</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Featured Tools Section -->
    <section
      class="featured-tools-section"
      style="padding: 6rem 0; background: var(--bg-primary)"
    >
      <div class="container">
        <div class="section-header">
          <h2 class="section-title">Featured Tools</h2>
          <p class="section-subtitle">
            Powerful resources to enhance your English learning journey
          </p>
        </div>

        <div
          class="tools-grid"
          style="
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 2rem;
            margin-top: 3rem;
          "
        >
          <!-- Tool 1: Grammar Ladder -->
          <div
            class="tool-card"
            style="
              background: var(--bg-secondary);
              border: 2px solid var(--border-color);
              border-radius: var(--radius-xl);
              padding: 2rem;
              text-align: center;
              transition: all 0.3s ease;
              box-shadow: var(--shadow-md);
              cursor: pointer;
            "
            onclick="window.location.href = 'english/grammar.html'"
          >
            <div
              class="tool-icon"
              style="
                width: 60px;
                height: 60px;
                background: linear-gradient(45deg, #46bbe5, #2d9cdb);
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 1.5rem;
                color: white;
                margin: 0 auto 1rem;
              "
            >
              <i class="fas fa-chart-line"></i>
            </div>
            <h3
              style="
                font-size: 1.2rem;
                font-weight: 600;
                margin-bottom: 0.75rem;
                color: var(--text-primary);
              "
            >
              Grammar Ladder
            </h3>
            <p
              style="
                color: var(--text-secondary);
                font-size: 0.95rem;
                line-height: 1.5;
              "
            >
              Climb to grammar mastery with progressive difficulty levels
            </p>
          </div>

          <!-- Tool 2: Vocabulary Builder -->
          <div
            class="tool-card"
            style="
              background: var(--bg-secondary);
              border: 2px solid var(--border-color);
              border-radius: var(--radius-xl);
              padding: 2rem;
              text-align: center;
              transition: all 0.3s ease;
              box-shadow: var(--shadow-md);
              cursor: pointer;
            "
            onclick="window.location.href = 'english/vocabguide.html'"
          >
            <div
              class="tool-icon"
              style="
                width: 60px;
                height: 60px;
                background: linear-gradient(45deg, #10b981, #059669);
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 1.5rem;
                color: white;
                margin: 0 auto 1rem;
              "
            >
              <i class="fas fa-book"></i>
            </div>
            <h3
              style="
                font-size: 1.2rem;
                font-weight: 600;
                margin-bottom: 0.75rem;
                color: var(--text-primary);
              "
            >
              Vocab Builder
            </h3>
            <p
              style="
                color: var(--text-secondary);
                font-size: 0.95rem;
                line-height: 1.5;
              "
            >
              Expand your word bank with flashcards and quizzes
            </p>
          </div>

          <!-- Tool 3: Writing Wizard -->
          <div
            class="tool-card"
            style="
              background: var(--bg-secondary);
              border: 2px solid var(--border-color);
              border-radius: var(--radius-xl);
              padding: 2rem;
              text-align: center;
              transition: all 0.3s ease;
              box-shadow: var(--shadow-md);
              cursor: pointer;
            "
            onclick="window.location.href = 'english/writingf.html'"
          >
            <div
              class="tool-icon"
              style="
                width: 60px;
                height: 60px;
                background: linear-gradient(45deg, #8b5cf6, #6d28d9);
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 1.5rem;
                color: white;
                margin: 0 auto 1rem;
              "
            >
              <i class="fas fa-magic"></i>
            </div>
            <h3
              style="
                font-size: 1.2rem;
                font-weight: 600;
                margin-bottom: 0.75rem;
                color: var(--text-primary);
              "
            >
              Writing Wizard
            </h3>
            <p
              style="
                color: var(--text-secondary);
                font-size: 0.95rem;
                line-height: 1.5;
              "
            >
              Generate creative writing prompts and story ideas instantly
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- Ad Placement 3 -->

    <!-- Enhanced Professional Footer -->
    <footer>
      <div class="container">
        <div class="footer-content">
          <!-- Brand Section -->
          <div class="footer-section footer-brand">
            <div class="brand-header">
              <img
                src="images/1.png"
                alt="ESL Fun Online"
                class="footer-logo"
              />
              <h3>ESL Fun Online</h3>
            </div>
            <p>
              Transform your English and coding skills with our premium
              interactive resources.
            </p>
          </div>

          <!-- English Learning Section -->
          <div class="footer-section">
            <h3><i class="fas fa-graduation-cap"></i> English</h3>
            <ul>
              <li>
                <a href="english/grammar.html"
                  ><i class="fas fa-spell-check"></i><span>Grammar</span></a
                >
              </li>
              <li>
                <a href="english/vocabguide.html"
                  ><i class="fas fa-book-open"></i><span>Vocabulary</span></a
                >
              </li>
              <li>
                <a href="english/business.html"
                  ><i class="fas fa-handshake"></i><span>Business</span></a
                >
              </li>
            </ul>
          </div>

          <!-- Programming Section -->
          <div class="footer-section">
            <h3><i class="fas fa-code"></i> Coding</h3>
            <ul>
              <li>
                <a href="coding/computerbasics.html"
                  ><i class="fas fa-desktop"></i><span>Basics</span></a
                >
              </li>
              <li>
                <a href="coding/ai.html"
                  ><i class="fas fa-robot"></i><span>AI</span></a
                >
              </li>
              <li>
                <a href="coding/codingresources.html"
                  ><i class="fas fa-terminal"></i><span>Resources</span></a
                >
              </li>
            </ul>
          </div>

          <!-- Quick Links Section -->
          <div class="footer-section">
            <h3><i class="fas fa-link"></i> Quick Links</h3>
            <ul>
              <li>
                <a href="lessons.html"
                  ><i class="fas fa-chalkboard-teacher"></i
                  ><span>Lessons</span></a
                >
              </li>
              <li>
                <a href="games/games.html"
                  ><i class="fas fa-gamepad"></i><span>Games</span></a
                >
              </li>
              <li>
                <a href="tools/tools.html"
                  ><i class="fas fa-tools"></i><span>Tools</span></a
                >
              </li>
            </ul>
          </div>
        </div>

        <!-- Footer Bottom -->
        <div class="footer-bottom">
          <div class="footer-bottom-center">
            <div class="footer-links">
              <a href="privacy.html"
                ><i class="fas fa-shield-alt"></i>Privacy</a
              >
              <a href="terms.html"><i class="fas fa-file-contract"></i>Terms</a>
              <a href="cookies.html"
                ><i class="fas fa-cookie-bite"></i>Cookies</a
              >
              <a href="contact.html"><i class="fas fa-envelope"></i>Contact</a>
            </div>
          </div>

          <div class="footer-bottom-left">
            <p>
              &copy; 2025 <strong>ESL Fun Online</strong>. All rights reserved.
            </p>
            <p class="footer-subtitle">Empowering learners worldwide</p>
          </div>

          <div class="footer-bottom-right">
            <div class="footer-badges">
              <div class="badge">
                <i class="fas fa-award"></i><span>Certified</span>
              </div>
              <div class="badge">
                <i class="fas fa-lock"></i><span>Secure</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </footer>

    <!-- AI Bot Assistant -->
    <div class="ai-bot-container" id="aiBot">
      <button class="ai-bot-button" id="aiBotButton">
        <div class="ai-bot-pulse"></div>
        <i class="fas fa-robot ai-bot-icon"></i>
      </button>

      <div class="ai-bot-chat" id="aiBotChat">
        <div class="ai-bot-header">
          <div class="ai-bot-header-content">
            <div class="ai-bot-avatar">
              <i class="fas fa-robot"></i>
            </div>
            <div class="ai-bot-status">
              <span class="ai-bot-name">ESL Assistant</span>
              <span class="ai-bot-online">
                <span class="status-dot"></span>
                Online
              </span>
            </div>
          </div>
          <button class="ai-bot-close" id="aiBotClose">
            <i class="fas fa-times"></i>
          </button>
        </div>

        <div class="ai-bot-messages" id="aiBotMessages">
          <div class="bot-message">
            <div class="bot-message-avatar">
              <i class="fas fa-robot"></i>
            </div>
            <div class="bot-message-content">
              <p>
                ðŸ‘‹ Hi! I'm your ESL learning assistant. How can I help you
                today?
              </p>
              <div class="quick-actions">
                <button
                  class="quick-action-btn"
                  onclick="handleQuickAction('games')"
                >
                  <i class="fas fa-gamepad"></i> Games
                </button>
                <button
                  class="quick-action-btn"
                  onclick="handleQuickAction('lessons')"
                >
                  <i class="fas fa-book"></i> Lessons
                </button>
                <button
                  class="quick-action-btn"
                  onclick="handleQuickAction('tests')"
                >
                  <i class="fas fa-clipboard-check"></i> Tests
                </button>
                <button
                  class="quick-action-btn"
                  onclick="handleQuickAction('top')"
                >
                  <i class="fas fa-arrow-up"></i> Top
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Load scripts with cache busting -->
    <script src="js/utilities.js?v=202511261" defer></script>
    <script src="js/hero.js?v=202511261" defer></script>
    <script src="js/navigation.js?v=202511032145" defer></script>

    <!-- Final Cache Control Script (Invisible to Users) -->
    <script>
      // Update navigation.js cache busting and final cache control
      (function () {
        var timestamp = Date.now();
        var version = Math.floor(timestamp / 1000);

        // Update all script tags with cache busting
        var scriptTags = document.querySelectorAll('script[src*="?v="]');
        scriptTags.forEach(function (script) {
          var newSrc = script.src.replace(/\?v=\d*/, "?v=" + version);
          if (
            newSrc !== script.src &&
            script.src.indexOf("navigation.js") !== -1
          ) {
            // For navigation.js, create a new script element
            var newScript = document.createElement("script");
            newScript.src = newSrc;
            newScript.async = script.async;
            newScript.defer = script.defer;
            script.parentNode.replaceChild(newScript, script);
          }
        });

        // Add additional cache busting headers via fetch override
        var originalFetch = window.fetch;
        window.fetch = function () {
          var args = Array.prototype.slice.call(arguments);
          if (args[1]) {
            args[1].headers = args[1].headers || {};
            args[1].headers["Cache-Control"] =
              "no-cache, no-store, must-revalidate";
            args[1].headers["Pragma"] = "no-cache";
            args[1].headers["Expires"] = "0";
          } else {
            args[1] = {
              headers: {
                "Cache-Control": "no-cache, no-store, must-revalidate",
                Pragma: "no-cache",
                Expires: "0",
              },
            };
          }
          return originalFetch.apply(this, args);
        };

        // Force browser to revalidate on focus
        window.addEventListener("focus", function () {
          if (document.visibilityState === "visible") {
            // Subtle cache refresh on window focus
            setTimeout(function () {
              var metaRefresh = document.querySelector(
                'meta[http-equiv="refresh"]',
              );
              if (!metaRefresh) {
                metaRefresh = document.createElement("meta");
                metaRefresh.setAttribute("http-equiv", "refresh");
                metaRefresh.setAttribute("content", "86400"); // 24 hours
                document.head.appendChild(metaRefresh);
              }
            }, 100);
          }
        });
      })();
    </script>

    <!-- UX Enhancement Scripts -->
    <script>
      // ============================================
      // SMOOTH SCROLL REVEAL ANIMATIONS
      // ============================================
      (function () {
        const observerOptions = {
          threshold: 0.1,
          rootMargin: "0px 0px -50px 0px",
        };

        const observer = new IntersectionObserver((entries) => {
          entries.forEach((entry) => {
            if (entry.isIntersecting) {
              entry.target.classList.add("visible");
              // Stagger animations for cards
              if (
                entry.target.classList.contains("feature-card") ||
                entry.target.classList.contains("tool-card")
              ) {
                entry.target.style.transitionDelay = `${
                  entry.target.dataset.index * 0.1
                }s`;
              }
            }
          });
        }, observerOptions);

        // Observe sections
        document.addEventListener("DOMContentLoaded", () => {
          // Add fade-in-section class to major sections
          document.querySelectorAll("section").forEach((section) => {
            section.classList.add("fade-in-section");
            observer.observe(section);
          });

          // Add index to cards for stagger effect
          document
            .querySelectorAll(".feature-card, .tool-card")
            .forEach((card, index) => {
              card.dataset.index = index;
              observer.observe(card);
            });
        });
      })();

      // ============================================
      // SMOOTH SCROLLING FOR INTERNAL LINKS
      // ============================================
      document.addEventListener("DOMContentLoaded", () => {
        document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
          anchor.addEventListener("click", function (e) {
            const href = this.getAttribute("href");
            if (href !== "#" && href !== "#!") {
              e.preventDefault();
              const target = document.querySelector(href);
              if (target) {
                target.scrollIntoView({
                  behavior: "smooth",
                  block: "start",
                });
              }
            }
          });
        });
      });

      // ============================================
      // ENHANCED SCROLL PROGRESS BAR
      // ============================================
      (function () {
        const progressBar = document.getElementById("scrollProgress");
        if (progressBar) {
          window.addEventListener(
            "scroll",
            () => {
              const winScroll = document.documentElement.scrollTop;
              const height =
                document.documentElement.scrollHeight -
                document.documentElement.clientHeight;
              const scrolled = (winScroll / height) * 100;
              progressBar.style.width = scrolled + "%";
            },
            { passive: true },
          );
        }
      })();

      // ============================================
      // IMPROVE MOBILE TOUCH FEEDBACK (Passive for better INP)
      // ============================================
      (function () {
        if ("ontouchstart" in window) {
          document
            .querySelectorAll(
              ".cta-primary, .cta-secondary, .feature-card, .tool-card",
            )
            .forEach((el) => {
              el.addEventListener(
                "touchstart",
                function () {
                  this.style.transform = "scale(0.98)";
                },
                { passive: true },
              );
              el.addEventListener(
                "touchend",
                function () {
                  this.style.transform = "";
                },
                { passive: true },
              );
            });
        }
      })();

      // ============================================
      // LAZY LOAD IMAGES (Performance Enhancement)
      // ============================================
      (function () {
        if ("IntersectionObserver" in window) {
          const imageObserver = new IntersectionObserver((entries) => {
            entries.forEach((entry) => {
              if (entry.isIntersecting) {
                const img = entry.target;
                if (img.dataset.src) {
                  img.src = img.dataset.src;
                  img.removeAttribute("data-src");
                  imageObserver.unobserve(img);
                }
              }
            });
          });

          document.querySelectorAll("img[data-src]").forEach((img) => {
            imageObserver.observe(img);
          });
        }
      })();

      // ============================================
      // HERO STATS COUNTER ANIMATION
      // ============================================
      (function () {
        const animateValue = (element, start, end, duration) => {
          let startTimestamp = null;
          const step = (timestamp) => {
            if (!startTimestamp) startTimestamp = timestamp;
            const progress = Math.min(
              (timestamp - startTimestamp) / duration,
              1,
            );
            const value = Math.floor(progress * (end - start) + start);
            element.textContent =
              value + (end === 95 ? "%" : end === 24 ? "/7" : "+");
            if (progress < 1) {
              window.requestAnimationFrame(step);
            }
          };
          window.requestAnimationFrame(step);
        };

        document.addEventListener("DOMContentLoaded", () => {
          const stats = document.querySelectorAll(".stat-number");
          const observer = new IntersectionObserver(
            (entries) => {
              entries.forEach((entry) => {
                if (entry.isIntersecting) {
                  const target = entry.target.dataset.target;
                  if (target) {
                    let endValue = parseInt(target);
                    if (target.includes("%")) endValue = 95;
                    else if (target.includes("/")) endValue = 24;
                    else endValue = 100;

                    animateValue(entry.target, 0, endValue, 2000);
                    observer.unobserve(entry.target);
                  }
                }
              });
            },
            { threshold: 0.5 },
          );

          stats.forEach((stat) => observer.observe(stat));
        });
      })();

      // ============================================
      // ADD LOADING STATE TO EXTERNAL LINKS
      // ============================================
      document.addEventListener("DOMContentLoaded", () => {
        document.querySelectorAll('a[href*="://"]').forEach((link) => {
          if (!link.href.includes(window.location.hostname)) {
            link.setAttribute("target", "_blank");
            link.setAttribute("rel", "noopener noreferrer");
          }
        });
      });

      // ============================================
      // IMPROVE FORM ACCESSIBILITY
      // ============================================
      document.addEventListener("DOMContentLoaded", () => {
        // Add aria labels to buttons without text
        document.querySelectorAll("button:not([aria-label])").forEach((btn) => {
          if (btn.querySelector("i") && !btn.textContent.trim()) {
            const icon = btn.querySelector("i");
            const iconClass = icon.className;
            btn.setAttribute("aria-label", iconClass.split("-").pop());
          }
        });
      });
    </script>

    <!-- Enhanced JavaScript for Interactive Features -->
    <script>
      // Progressive English Mastery Test - 1% Pass Rate
      // Three different game sets for variety
      const gameSet1 = [
        {
          word: "Grammar Basics",
          context: "Choose the correct sentence:",
          options: [
            "Me and John went to the store",
            "John and I went to the store",
            "John and me went to the store",
            "I and John went to the store",
          ],
          correct: 1,
        },
        {
          word: "Common Usage",
          context: "Which sentence is correct?",
          options: [
            "I could care less about that movie",
            "I couldn't care less about that movie",
            "I should care less about that movie",
            "I would care less about that movie",
          ],
          correct: 1,
        },
        {
          word: "Word Choice",
          context: "The weather will _____ our picnic plans.",
          options: ["effect", "affect", "infect", "defect"],
          correct: 1,
        },
        {
          word: "Phrasal Verbs",
          context: "I need to _____ this information before the meeting.",
          options: ["look up", "look over", "look into", "look after"],
          correct: 1,
        },
        {
          word: "Subjunctive Mood",
          context: "If I _____ you, I would accept that job offer.",
          options: ["was", "were", "am", "will be"],
          correct: 1,
        },
        {
          word: "Advanced Grammar",
          context:
            "Neither the CEO nor the board members _____ aware of the issue.",
          options: ["was", "were", "is", "are"],
          correct: 1,
        },
        {
          word: "Sophisticated Vocabulary",
          context:
            "Her argument was so _____ that even experts found flaws in the logic.",
          options: ["obvious", "clear", "specious", "honest"],
          correct: 2,
        },
        {
          word: "Literary Device",
          context: "The phrase 'deafening silence' is an example of:",
          options: ["metaphor", "simile", "oxymoron", "alliteration"],
          correct: 2,
        },
        {
          word: "Etymology Expert",
          context:
            "Which word means 'characterized by excessive eagerness to please'?",
          options: ["obsequious", "querulous", "garrulous", "incredulous"],
          correct: 0,
        },
        {
          word: "Master Level",
          context:
            "In the sentence 'The data suggest a correlation,' the verb form is:",
          options: [
            "incorrect - should be 'suggests'",
            "correct - 'data' is plural",
            "informal but acceptable",
            "archaic usage",
          ],
          correct: 1,
        },
      ];

      const gameSet2 = [
        {
          word: "Basic Grammar",
          context: "Which is the correct plural form?",
          options: ["childs", "children", "childrens", "child's"],
          correct: 1,
        },
        {
          word: "Common Mistakes",
          context: "Choose the correct sentence:",
          options: [
            "Between you and I, this is wrong",
            "Between you and me, this is correct",
            "Between I and you, this works",
            "Between me and you, sounds good",
          ],
          correct: 1,
        },
        {
          word: "Verb Forms",
          context: "Yesterday, I _____ my homework.",
          options: ["done", "did", "do", "doing"],
          correct: 1,
        },
        {
          word: "Prepositions",
          context: "She arrived _____ the airport at midnight.",
          options: ["in", "on", "at", "to"],
          correct: 2,
        },
        {
          word: "Modal Verbs",
          context: "You _____ smoke in the hospital.",
          options: ["mustn't", "don't have to", "needn't", "won't"],
          correct: 0,
        },
        {
          word: "Complex Grammar",
          context: "Had I known earlier, I _____ differently.",
          options: ["would act", "would have acted", "will act", "had acted"],
          correct: 1,
        },
        {
          word: "Nuanced Meaning",
          context: "The politician's response was deliberately _____.",
          options: ["clear", "honest", "equivocal", "simple"],
          correct: 2,
        },
        {
          word: "Figurative Language",
          context: "'Time is money' is an example of:",
          options: ["hyperbole", "metaphor", "alliteration", "personification"],
          correct: 1,
        },
        {
          word: "Advanced Vocabulary",
          context: "Which word means 'a person who pretends to have virtues'?",
          options: ["hypocrite", "skeptic", "cynic", "pessimist"],
          correct: 0,
        },
        {
          word: "Expert Grammar",
          context: "The sentence 'Whom did you see?' is:",
          options: [
            "incorrect - should be 'who'",
            "formally correct but sounds outdated",
            "always preferred in writing",
            "grammatically impossible",
          ],
          correct: 1,
        },
      ];

      const gameSet3 = [
        {
          word: "Simple Tenses",
          context: "She _____ to work every day.",
          options: ["go", "goes", "going", "gone"],
          correct: 1,
        },
        {
          word: "Article Usage",
          context: "I saw _____ movie last night.",
          options: ["a", "an", "the", "no article needed"],
          correct: 0,
        },
        {
          word: "Comparative Forms",
          context: "This book is _____ than that one.",
          options: ["more better", "better", "more good", "gooder"],
          correct: 1,
        },
        {
          word: "Question Formation",
          context: "How to ask about someone's job?",
          options: [
            "What you do for work?",
            "What do you do for work?",
            "What are you do for work?",
            "What you are doing for work?",
          ],
          correct: 1,
        },
        {
          word: "Conditional Sentences",
          context: "If it rains tomorrow, we _____ inside.",
          options: ["stay", "will stay", "stayed", "staying"],
          correct: 1,
        },
        {
          word: "Perfect Tenses",
          context: "By next year, I _____ here for five years.",
          options: [
            "will work",
            "will be working",
            "will have worked",
            "will have been working",
          ],
          correct: 3,
        },
        {
          word: "Sophisticated Usage",
          context: "The solution was both elegant and _____.",
          options: ["simple", "complex", "parsimonious", "obvious"],
          correct: 2,
        },
        {
          word: "Literary Terms",
          context: "A story within a story is called:",
          options: ["metaphor", "allegory", "frame narrative", "symbolism"],
          correct: 2,
        },
        {
          word: "Rare Vocabulary",
          context: "Which word means 'existing in name only'?",
          options: ["nominal", "formal", "official", "temporary"],
          correct: 0,
        },
        {
          word: "Expert Level",
          context: "The correct use of 'lie' vs 'lay' in past tense:",
          options: [
            "Yesterday I laid down (correct)",
            "Yesterday I lay down (correct)",
            "Yesterday I lied down (correct)",
            "All forms are acceptable",
          ],
          correct: 1,
        },
      ];

      // Game sets collection
      const allGameSets = [gameSet1, gameSet2, gameSet3];
      let currentGameSet = 0;
      let vocabularyQuestions = allGameSets[currentGameSet];

      let currentQuestion = 0;
      let score = 0;
      let gameActive = true;

      // Initialize vocabulary game
      function initVocabularyGame() {
        // Randomly select a game set for variety
        currentGameSet = Math.floor(Math.random() * allGameSets.length);
        vocabularyQuestions = allGameSets[currentGameSet];

        currentQuestion = 0;
        score = 0;
        gameActive = true;

        loadQuestion();
      }

      function loadQuestion() {
        if (currentQuestion >= vocabularyQuestions.length) {
          endGame();
          return;
        }

        const question = vocabularyQuestions[currentQuestion];
        const wordCard = document.getElementById("wordCard");

        // Determine difficulty level for visual feedback
        let difficultyLevel = "";
        let difficultyClass = "";
        if (currentQuestion <= 2) {
          difficultyLevel = "EASY - Hook Questions";
          difficultyClass = "easy";
        } else if (currentQuestion <= 5) {
          difficultyLevel = "MEDIUM - Building Difficulty";
          difficultyClass = "medium";
        } else {
          difficultyLevel = "EXPERT - Only 1% Pass These";
          difficultyClass = "expert";
        }

        // Enhanced question display with context and difficulty
        const gameSetNames = [
          "Grammar Master",
          "Language Expert",
          "Word Wizard",
        ];
        const gameSetIcons = ["ðŸ“š", "ðŸ§ ", "âœ¨"];
        const currentSetName = gameSetNames[currentGameSet];
        const currentSetIcon = gameSetIcons[currentGameSet];

        wordCard.innerHTML = `
      <div class="question-header">
        <div class="game-set-indicator">
          ${currentSetIcon} ${currentSetName} Challenge
        </div>
        <div class="question-number">Question ${currentQuestion + 1} of ${
          vocabularyQuestions.length
        }</div>
        <div class="difficulty-badge ${difficultyClass}">${difficultyLevel}</div>
      </div>
      <div class="word-display">${question.word}</div>
      <div class="context-sentence">${question.context}</div>
      <div class="question-prompt">Choose the best answer:</div>
    `;

        const optionsGrid = document.getElementById("optionsGrid");
        optionsGrid.innerHTML = "";

        question.options.forEach((option, index) => {
          const button = document.createElement("button");
          button.className = "option-btn";
          button.innerHTML = `<span class="option-letter">${String.fromCharCode(
            65 + index,
          )}.</span> ${option}`;
          button.onclick = () => selectAnswer(index);
          optionsGrid.appendChild(button);
        });

        updateScore();
      }

      function selectAnswer(selectedIndex) {
        if (!gameActive) return;

        const question = vocabularyQuestions[currentQuestion];
        const buttons = document.querySelectorAll(".option-btn");
        const wordCard = document.getElementById("wordCard");

        buttons.forEach((btn, index) => {
          btn.disabled = true;
          if (index === question.correct) {
            btn.classList.add("correct");
          } else if (index === selectedIndex && index !== question.correct) {
            btn.classList.add("incorrect");
          }
        });

        // Visual feedback based on answer
        if (selectedIndex === question.correct) {
          score++;
          // Add success animation to word card
          wordCard.classList.add("success-pulse");
          // Show temporary success message
          const successMsg = document.createElement("div");
          successMsg.className = "feedback-message success";
          successMsg.innerHTML = "âœ… Correct! Well done!";
          wordCard.appendChild(successMsg);

          setTimeout(() => {
            successMsg.remove();
            wordCard.classList.remove("success-pulse");
          }, 1000);
        } else {
          // Add error animation
          wordCard.classList.add("error-shake");
          // Show temporary error message
          const errorMsg = document.createElement("div");
          errorMsg.className = "feedback-message error";
          errorMsg.innerHTML =
            "âŒ Incorrect. The right answer was highlighted.";
          wordCard.appendChild(errorMsg);

          setTimeout(() => {
            errorMsg.remove();
            wordCard.classList.remove("error-shake");
          }, 1000);
        }

        setTimeout(() => {
          currentQuestion++;
          loadQuestion();
        }, 1500);
      }

      function updateScore() {
        const scoreElement = document.getElementById("gameScore");
        const percentage =
          currentQuestion > 0 ? Math.round((score / currentQuestion) * 100) : 0;
        scoreElement.innerHTML = `
      <div class="score-container">
        <div class="current-score">Score: ${score}/${currentQuestion}</div>
        <div class="progress-bar">
          <div class="progress-fill" style="width: ${
            (currentQuestion / vocabularyQuestions.length) * 100
          }%"></div>
        </div>
        <div class="progress-text">Question ${currentQuestion}/${
          vocabularyQuestions.length
        }</div>
        ${
          currentQuestion > 0
            ? `<div class="accuracy">Accuracy: ${percentage}%</div>`
            : ""
        }
      </div>
    `;
      }

      function endGame() {
        gameActive = false;
        const percentage = Math.round(
          (score / vocabularyQuestions.length) * 100,
        );
        let resultMessage = "";
        let resultIcon = "";
        let resultClass = "";

        if (percentage >= 90) {
          resultMessage = "ðŸ† LEGENDARY! You're in the top 1%!";
          resultClass = "legendary";
        } else if (percentage >= 80) {
          resultMessage = "ðŸ”¥ EXCEPTIONAL! Almost perfect!";
          resultClass = "exceptional";
        } else if (percentage >= 70) {
          resultMessage = "â­ IMPRESSIVE! Above average intelligence!";
          resultClass = "impressive";
        } else if (percentage >= 60) {
          resultMessage = "ðŸ‘ DECENT! Room for improvement.";
          resultClass = "decent";
        } else {
          resultMessage = "ðŸ“š CHALLENGING! These words stump 99% of people.";
          resultClass = "challenging";
        }

        // Create motivational message based on game set
        const gameSetNames = [
          "Grammar Master",
          "Language Expert",
          "Word Wizard",
        ];
        const currentSetName = gameSetNames[currentGameSet];

        document.getElementById("wordCard").innerHTML = `
      <div class="game-results ${resultClass}">
        <div class="result-header">
          <h3>Challenge Complete!</h3>
          <div class="game-set-info">
            <span class="set-badge">Game Set: ${currentSetName}</span>
          </div>
          <div class="score-display">${score}/${
            vocabularyQuestions.length
          }</div>
          <div class="percentage">${percentage}%</div>
        </div>
        <div class="result-message">${resultMessage}</div>
        <div class="result-stats">
          <p><strong>Test Type:</strong> Progressive English Mastery</p>
          <p><strong>Average Score:</strong> 4.2/10 (42%)</p>
          <p><strong>Your Level:</strong> ${
            percentage >= 90
              ? "Native-Level Mastery"
              : percentage >= 80
                ? "Advanced Proficiency"
                : percentage >= 70
                  ? "Upper-Intermediate"
                  : percentage >= 60
                    ? "Intermediate"
                    : percentage >= 40
                      ? "Pre-Intermediate"
                      : "Elementary - Keep Practicing!"
          }</p>
          <p><strong>Progression:</strong> Easy (1-3) â†’ Medium (4-6) â†’ Expert (7-10)</p>
          ${
            percentage < 70
              ? '<p class="motivational"><strong>ðŸ’¡ Tip:</strong> Try different game sets to improve your English skills across various topics!</p>'
              : ""
          }
        </div>
        <div class="social-share">
          <p><strong>Share your score:</strong></p>
          <button onclick="shareScore()" class="share-btn">ðŸ“± Share Results</button>
        </div>
      </div>
    `;
        document.getElementById("optionsGrid").innerHTML = "";
      }

      // Share score function
      function shareScore() {
        const percentage = Math.round(
          (score / vocabularyQuestions.length) * 100,
        );
        const gameSetNames = [
          "Grammar Master",
          "Language Expert",
          "Word Wizard",
        ];
        const currentSetName = gameSetNames[currentGameSet];
        const shareText = `I just scored ${score}/${vocabularyQuestions.length} (${percentage}%) on the ${currentSetName} English Test! Only 1% can pass this challenge. Can you beat my score? Try it at ESLonline.com`;

        if (navigator.share) {
          navigator.share({
            title: "English Mastery Test Results",
            text: shareText,
            url: window.location.href,
          });
        } else {
          // Fallback for browsers without Web Share API
          navigator.clipboard
            .writeText(shareText)
            .then(() => {
              alert("Results copied to clipboard! Share with your friends.");
            })
            .catch(() => {
              // Final fallback
              const textarea = document.createElement("textarea");
              textarea.value = shareText;
              document.body.appendChild(textarea);
              textarea.select();
              document.execCommand("copy");
              document.body.removeChild(textarea);
              alert("Results copied to clipboard! Share with your friends.");
            });
        }
      }

      function resetGame() {
        initVocabularyGame();
      }

      // Enhanced Stats Counter Animation
      function initStatsCounter() {
        const statNumbers = document.querySelectorAll(".stat-number");
        const observer = new IntersectionObserver(
          (entries) => {
            entries.forEach((entry) => {
              if (entry.isIntersecting) {
                const target = entry.target;
                const targetValue = target.getAttribute("data-target");
                animateCounter(target, targetValue);
                observer.unobserve(target);
              }
            });
          },
          { threshold: 0.5 },
        );

        statNumbers.forEach((stat) => observer.observe(stat));
      }

      function animateCounter(element, targetValue) {
        const isPercentage = targetValue.includes("%");
        const hasPlus = targetValue.includes("+");
        const is247 = targetValue.includes("/");

        let numericValue;
        let suffix = "";

        if (is247) {
          element.textContent = targetValue;
          return;
        } else if (isPercentage) {
          numericValue = parseInt(targetValue);
          suffix = "%";
        } else if (hasPlus) {
          numericValue = parseInt(targetValue);
          suffix = "+";
        } else {
          numericValue = parseInt(targetValue) || 0;
        }

        const startTime = performance.now();
        const duration = 2000;

        function updateCounter(currentTime) {
          const elapsed = currentTime - startTime;
          const progress = Math.min(elapsed / duration, 1);
          const easeOutQuart = 1 - Math.pow(1 - progress, 4);
          const current = Math.floor(numericValue * easeOutQuart);

          element.textContent = current + suffix;

          if (progress < 1) {
            requestAnimationFrame(updateCounter);
          }
        }

        requestAnimationFrame(updateCounter);
      }

      // Enhanced smooth scroll function
      function scrollToSection(sectionId) {
        const element = document.getElementById(sectionId);
        if (element) {
          const headerOffset = 80;
          const elementPosition = element.getBoundingClientRect().top;
          const offsetPosition =
            elementPosition + window.pageYOffset - headerOffset;

          window.scrollTo({
            top: offsetPosition,
            behavior: "smooth",
          });
        }
      }

      // Scroll to top function
      function scrollToTop() {
        window.scrollTo({
          top: 0,
          behavior: "smooth",
        });
      }

      // AI Bot Assistant functionality
      function initAIBot() {
        const aiBotButton = document.getElementById("aiBotButton");
        const aiBotChat = document.getElementById("aiBotChat");
        const aiBotClose = document.getElementById("aiBotClose");
        const aiBotMessages = document.getElementById("aiBotMessages");

        if (!aiBotButton) return;

        // Show/hide bot button on scroll
        function toggleBotVisibility() {
          if (window.scrollY > 300) {
            aiBotButton.classList.add("show");
          } else {
            aiBotButton.classList.remove("show");
          }
        }

        // Toggle chat window
        aiBotButton.addEventListener("click", () => {
          aiBotChat.classList.toggle("active");
        });

        // Close chat window
        aiBotClose.addEventListener("click", (e) => {
          e.stopPropagation();
          aiBotChat.classList.remove("active");
        });

        // Close chat when clicking outside
        document.addEventListener("click", (e) => {
          if (
            !aiBotChat.contains(e.target) &&
            !aiBotButton.contains(e.target)
          ) {
            aiBotChat.classList.remove("active");
          }
        });

        // Throttled scroll handler
        let ticking = false;
        function requestTick() {
          if (!ticking) {
            requestAnimationFrame(toggleBotVisibility);
            ticking = true;
            setTimeout(() => {
              ticking = false;
            }, 100);
          }
        }

        window.addEventListener("scroll", requestTick, { passive: true });
        toggleBotVisibility();
      }

      // Handle quick action buttons
      function handleQuickAction(action) {
        const messagesContainer = document.getElementById("aiBotMessages");

        // Show typing indicator
        showTypingIndicator();

        setTimeout(() => {
          removeTypingIndicator();

          let response = "";
          let actionButtons = "";

          switch (action) {
            case "games":
              response =
                "ðŸŽ® Great choice! We have various ESL games to help you learn:";
              actionButtons = `
            <div class="quick-actions">
              <button class="quick-action-btn" onclick="window.location.href='games/games.html'">
                <i class="fas fa-play"></i> Browse Games
              </button>
              <button class="quick-action-btn" onclick="window.location.href='games/memory-match.html'">
                <i class="fas fa-spell-check"></i> Memory Match
              </button>
              <button class="quick-action-btn" onclick="window.location.href='games/quizchamp.html'">
                <i class="fas fa-trophy"></i> Quiz Champion
              </button>
            </div>
          `;
              break;

            case "lessons":
              response = "ðŸ“š Perfect! Here are our lesson categories:";
              actionButtons = `
            <div class="quick-actions">
              <button class="quick-action-btn" onclick="window.location.href='lessons.html'">
                <i class="fas fa-list"></i> All Lessons
              </button>
              <button class="quick-action-btn" onclick="window.location.href='english/grammar.html'">
                <i class="fas fa-language"></i> Grammar
              </button>
              <button class="quick-action-btn" onclick="window.location.href='blog/blog.html'">
                <i class="fas fa-newspaper"></i> Blog
              </button>
            </div>
          `;
              break;

            case "tests":
              response =
                "âœ… Ready to test your skills? Here are our test options:";
              actionButtons = `
            <div class="quick-actions">
              <button class="quick-action-btn" onclick="window.location.href='english/ielts.html'">
                <i class="fas fa-graduation-cap"></i> IELTS
              </button>
              <button class="quick-action-btn" onclick="window.location.href='english/toeic.html'">
                <i class="fas fa-certificate"></i> TOEIC
              </button>
              <button class="quick-action-btn" onclick="window.location.href='english/eiken.html'">
                <i class="fas fa-medal"></i> EIKEN
              </button>
            </div>
          `;
              break;

            case "top":
              scrollToTop();
              response = "â¬†ï¸ Taking you to the top!";
              actionButtons = `
            <div class="quick-actions">
              <button class="quick-action-btn" onclick="handleQuickAction('games')">
                <i class="fas fa-gamepad"></i> Games
              </button>
              <button class="quick-action-btn" onclick="handleQuickAction('lessons')">
                <i class="fas fa-book"></i> Lessons
              </button>
            </div>
          `;
              break;

            default:
              response = "ðŸ‘‹ How else can I help you?";
              actionButtons = `
            <div class="quick-actions">
              <button class="quick-action-btn" onclick="handleQuickAction('games')">
                <i class="fas fa-gamepad"></i> Games
              </button>
              <button class="quick-action-btn" onclick="handleQuickAction('lessons')">
                <i class="fas fa-book"></i> Lessons
              </button>
              <button class="quick-action-btn" onclick="handleQuickAction('tests')">
                <i class="fas fa-clipboard-check"></i> Tests
              </button>
            </div>
          `;
          }

          addBotMessage(response + actionButtons);
        }, 800);
      }

      // Show typing indicator
      function showTypingIndicator() {
        const messagesContainer = document.getElementById("aiBotMessages");
        const typingDiv = document.createElement("div");
        typingDiv.className = "bot-message typing-message";
        typingDiv.id = "typingIndicator";
        typingDiv.innerHTML = `
      <div class="bot-message-avatar">
        <i class="fas fa-robot"></i>
      </div>
      <div class="bot-message-content">
        <div class="typing-indicator">
          <div class="typing-dot"></div>
          <div class="typing-dot"></div>
          <div class="typing-dot"></div>
        </div>
      </div>
    `;
        messagesContainer.appendChild(typingDiv);
        messagesContainer.scrollTop = messagesContainer.scrollHeight;
      }

      // Remove typing indicator
      function removeTypingIndicator() {
        const typingIndicator = document.getElementById("typingIndicator");
        if (typingIndicator) {
          typingIndicator.remove();
        }
      }

      // Add bot message
      function addBotMessage(content) {
        const messagesContainer = document.getElementById("aiBotMessages");
        const messageDiv = document.createElement("div");
        messageDiv.className = "bot-message";
        messageDiv.innerHTML = `
      <div class="bot-message-avatar">
        <i class="fas fa-robot"></i>
      </div>
      <div class="bot-message-content">
        ${content}
      </div>
    `;
        messagesContainer.appendChild(messageDiv);
        messagesContainer.scrollTop = messagesContainer.scrollHeight;
      }

      // Notification system
      function showNotification(message, type = "info") {
        const notification = document.createElement("div");
        notification.className = `notification notification-${type}`;
        notification.innerHTML = `
      <div class="notification-content">
        <i class="fas fa-${getNotificationIcon(type)}"></i>
        <span>${message}</span>
        <button class="notification-close" onclick="this.parentElement.parentElement.remove()">
          <i class="fas fa-times"></i>
        </button>
      </div>
    `;

        // Add notification styles if not already added
        if (!document.querySelector("#notification-styles")) {
          const styles = document.createElement("style");
          styles.id = "notification-styles";
          styles.textContent = `
        .notification {
          position: fixed;
          top: 100px;
          right: 20px;
          z-index: 10000;
          max-width: 400px;
          padding: 1rem 1.5rem;
          border-radius: 12px;
          box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
          backdrop-filter: blur(10px);
          animation: slideInRight 0.3s ease-out;
          margin-bottom: 10px;
        }
        
        .notification-info {
          background: linear-gradient(135deg, #3b82f6, #1d4ed8);
          color: white;
        }
        
        .notification-success {
          background: linear-gradient(135deg, #10b981, #059669);
          color: white;
        }
        
        .notification-content {
          display: flex;
          align-items: center;
          gap: 12px;
        }
        
        .notification-close {
          background: none;
          border: none;
          color: currentColor;
          cursor: pointer;
          padding: 4px;
          border-radius: 4px;
          margin-left: auto;
          opacity: 0.8;
          transition: opacity 0.2s ease;
        }
        
        .notification-close:hover {
          opacity: 1;
          background: rgba(255, 255, 255, 0.1);
        }
        
        @keyframes slideInRight {
          from {
            transform: translateX(100%);
            opacity: 0;
          }
          to {
            transform: translateX(0);
            opacity: 1;
          }
        }
        
        @media (max-width: 480px) {
          .notification {
            left: 20px;
            right: 20px;
            max-width: none;
          }
        }
      `;
          document.head.appendChild(styles);
        }

        document.body.appendChild(notification);

        // Auto remove after 5 seconds
        setTimeout(() => {
          if (notification.parentElement) {
            notification.style.animation = "slideInRight 0.3s ease-in reverse";
            setTimeout(() => notification.remove(), 300);
          }
        }, 5000);
      }

      function getNotificationIcon(type) {
        switch (type) {
          case "success":
            return "check-circle";
          case "warning":
            return "exclamation-triangle";
          case "error":
            return "times-circle";
          default:
            return "info-circle";
        }
      }

      // Initialize all features when DOM is loaded
      document.addEventListener("DOMContentLoaded", function () {
        try {
          // Initialize scroll features
          initScrollProgress();
          initSmoothScrolling();

          // Initialize existing features
          initVocabularyGame();
          initStatsCounter();
          initAIBot();
          initLazyLoading();
          initPerformanceOptimizations();
          initScrollAnimations();

          // Mark page as loaded
          document.body.style.opacity = "1";
        } catch (error) {
          console.error("Error initializing page features:", error);
        }
      });

      // Scroll-triggered animations
      function initScrollAnimations() {
        const observerOptions = {
          threshold: 0.1,
          rootMargin: "0px 0px -50px 0px",
        };

        const observer = new IntersectionObserver((entries) => {
          entries.forEach((entry) => {
            if (entry.isIntersecting) {
              entry.target.style.opacity = "1";
              entry.target.style.transform = "translateY(0)";
            }
          });
        }, observerOptions);

        // Observe feature cards for staggered animation
        document
          .querySelectorAll(".feature-card, .stat-card, .credential-item")
          .forEach((el, index) => {
            el.style.opacity = "0";
            el.style.transform = "translateY(30px)";
            el.style.transition = `opacity 0.6s ease ${
              index * 0.1
            }s, transform 0.6s ease ${index * 0.1}s`;
            observer.observe(el);
          });
      }

      // Scroll progress indicator
      function initScrollProgress() {
        const progressBar = document.getElementById("scrollProgress");

        window.addEventListener(
          "scroll",
          () => {
            // Don't interfere with dropdown menus during scroll
            if (
              document.querySelector(".nav-links.mobile-menu-open") ||
              document.querySelector(".nav-item.desktop-open") ||
              document.querySelector(".nav-item.dropdown-protected") ||
              document.querySelector(".nav-item:hover")
            ) {
              return;
            }

            const winScroll =
              document.body.scrollTop || document.documentElement.scrollTop;
            const height =
              document.documentElement.scrollHeight -
              document.documentElement.clientHeight;
            const scrolled = (winScroll / height) * 100;
            progressBar.style.width = scrolled + "%";
          },
          { passive: true },
        );
      }

      // Enhanced smooth scrolling
      function initSmoothScrolling() {
        // Handle navbar links
        document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
          anchor.addEventListener("click", function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute("href"));
            if (target) {
              const headerOffset = 80;
              const elementPosition = target.getBoundingClientRect().top;
              const offsetPosition =
                elementPosition + window.pageYOffset - headerOffset;

              window.scrollTo({
                top: offsetPosition,
                behavior: "smooth",
              });
            }
          });
        });
      }

      // Lazy loading for images and content
      function initLazyLoading() {
        const imageObserver = new IntersectionObserver((entries, observer) => {
          entries.forEach((entry) => {
            if (entry.isIntersecting) {
              const img = entry.target;
              if (img.dataset.src) {
                img.src = img.dataset.src;
                img.classList.remove("lazy");
                observer.unobserve(img);
              }
            }
          });
        });

        document.querySelectorAll("img[data-src]").forEach((img) => {
          imageObserver.observe(img);
        });
      }

      // Performance optimizations
      function initPerformanceOptimizations() {
        // Debounce scroll events and avoid dropdown interference
        let scrollTimeout;
        const originalScrollHandler = window.onscroll;

        window.addEventListener(
          "scroll",
          () => {
            // Don't process scroll events if dropdowns are open
            if (
              document.querySelector(".nav-links.mobile-menu-open") ||
              document.querySelector(".nav-item.desktop-open") ||
              document.querySelector(".nav-item.dropdown-protected") ||
              document.querySelector(".nav-item:hover")
            ) {
              return;
            }

            if (scrollTimeout) {
              clearTimeout(scrollTimeout);
            }
            scrollTimeout = setTimeout(() => {
              if (originalScrollHandler) originalScrollHandler();
            }, 10);
          },
          { passive: true },
        );

        // Optimize animations for performance
        const prefersReducedMotion = window.matchMedia(
          "(prefers-reduced-motion: reduce)",
        );
        if (prefersReducedMotion.matches) {
          document.documentElement.style.setProperty(
            "--transition-normal",
            "none",
          );
        }

        // Add keyboard navigation for accessibility
        document.addEventListener("keydown", (e) => {
          // Press 'T' to go to top
          if (
            (e.key === "t" || e.key === "T") &&
            !e.target.matches("input, textarea")
          ) {
            e.preventDefault();
            scrollToTop();
          }
          // Press 'F' to go to features
          if (
            (e.key === "f" || e.key === "F") &&
            !e.target.matches("input, textarea")
          ) {
            e.preventDefault();
            scrollToSection("features");
          }
          // Press 'A' to go to activity
          if (
            (e.key === "a" || e.key === "A") &&
            !e.target.matches("input, textarea")
          ) {
            e.preventDefault();
            scrollToSection("activity");
          }
        });

        // Add visual feedback for reduced motion users
        if (prefersReducedMotion.matches) {
          document.body.classList.add("reduced-motion");
        }
      }

      // Hero Background Lazy Loading for Desktop Only
      function initHeroOptimization() {
        const hero = document.querySelector(".hero");
        const isMobile = window.innerWidth <= 768;

        if (!isMobile) {
          // Only load background image on desktop
          const img = new Image();
          img.onload = function () {
            hero.style.setProperty(
              "--hero-bg-loaded",
              'url("images/hero.webp")',
            );
            hero.classList.add("bg-loaded");
          };
          img.src = "images/hero.webp";
        } else {
          // On mobile, ensure background is just gradient
          hero.style.background =
            "linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%)";
        }

        // Optimize scroll indicator for mobile
        const scrollIndicator = document.querySelector(".scroll-indicator");
        if (scrollIndicator && isMobile) {
          scrollIndicator.style.display = "none"; // Hide on very small screens
        }
      }

      // Call hero optimization on load - use requestIdleCallback for non-critical
      if ("requestIdleCallback" in window) {
        requestIdleCallback(initHeroOptimization);
      } else {
        document.addEventListener("DOMContentLoaded", initHeroOptimization);
      }
    </script>

    <!-- Mobile Menu Script - deferred for better INP -->
    <script src="js/mobile-menu.js" defer></script>

    <!-- AdSense - Load after page is interactive for better Core Web Vitals -->
    <script>
      // Defer AdSense loading to after page becomes interactive
      if ("requestIdleCallback" in window) {
        requestIdleCallback(
          function () {
            var script = document.createElement("script");
            script.src =
              "https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2456627863532019";
            script.async = true;
            script.crossOrigin = "anonymous";
            document.head.appendChild(script);
          },
          { timeout: 3000 },
        );
      } else {
        window.addEventListener("load", function () {
          setTimeout(function () {
            var script = document.createElement("script");
            script.src =
              "https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2456627863532019";
            script.async = true;
            script.crossOrigin = "anonymous";
            document.head.appendChild(script);
          }, 2000);
        });
      }
    </script>
  </body>
</html>
