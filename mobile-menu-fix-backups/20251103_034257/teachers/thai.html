<!DOCTYPE html>
<html lang="en">
  <head>
    <script
      async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2456627863532019"
      crossorigin="anonymous"
    ></script>
    <meta name="google-adsense-account" content="ca-pub-2456627863532019" />
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="Master Thai vocabulary with interactive flashcards! Learn essential Thai words and phrases with pronunciation guides, spaced repetition, and difficulty levels. Perfect for beginners and advanced learners."
    />
    <meta
      name="keywords"
      content="Thai language learning, Thai flashcards, Thai vocabulary, learn Thai, Thai pronunciation, Thai phrasebook, Thai ESL, language learning tools"
    />
    <meta name="author" content="ESL Fun Online" />
    <meta name="robots" content="index, follow" />
    <meta
      property="og:title"
      content="Thai Language Flashcards - Learn Thai Vocabulary | ESL Fun Online"
    />
    <meta
      property="og:description"
      content="Interactive Thai flashcards with pronunciation guides and spaced repetition. Master Thai vocabulary from beginner to advanced levels."
    />
    <meta
      property="og:image"
      content="https://eslfunonline.com/images/thai-flag.jpg"
    />
    <meta
      property="og:url"
      content="https://eslfunonline.com/teachers/thai.html"
    />
    <meta property="og:type" content="website" />
    <meta name="twitter:card" content="summary_large_image" />

    <title>
      Thai Language Flashcards - Learn Thai Vocabulary | ESL Fun Online
    </title>
    <link rel="canonical" href="https://eslfunonline.com/teachers/thai.html" />
    <link rel="icon" type="image/png" sizes="32x32" href="../images/1.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="../images/1.png" />

    <!-- Preconnect to external domains -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="dns-prefetch" href="https://cdnjs.cloudflare.com" />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link
      rel="preload"
      href="../css/main.css"
      as="style"
      onload="this.onload=null;this.rel='stylesheet'"
    />
    <link
      rel="preload"
      href="../css/header.css"
      as="style"
      onload="this.onload=null;this.rel='stylesheet'"
    />
    <link rel="stylesheet" href="../css/mobile-optimized.css" />

    <!-- Fallback for CSS -->
    <noscript>
      <link rel="stylesheet" href="../css/main.css" />
      <link rel="stylesheet" href="../css/header.css" />
    </noscript>

    <!-- Structured Data for SEO -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Thai Language Flashcards",
        "alternateName": "Thai Vocabulary Learning Tool",
        "description": "Interactive Thai flashcards with spaced repetition, authentic pronunciation, and progressive difficulty levels. Master Thai vocabulary from beginner to advanced levels.",
        "url": "https://eslfunonline.com/teachers/thai.html",
        "applicationCategory": "EducationalApplication",
        "operatingSystem": "Web Browser",
        "creator": {
          "@type": "Organization",
          "name": "ESL Fun Online",
          "url": "https://eslfunonline.com"
        },
        "offers": {
          "@type": "Offer",
          "price": "0",
          "priceCurrency": "USD",
          "availability": "https://schema.org/InStock"
        },
        "featureList": [
          "Interactive flashcards",
          "Spaced repetition algorithm",
          "Thai pronunciation audio",
          "Progress tracking",
          "Multiple difficulty levels",
          "Category-based learning"
        ],
        "educationalLevel": "beginner, intermediate, advanced",
        "learningResourceType": "Interactive Resource",
        "inLanguage": ["en", "th"],
        "about": {
          "@type": "Language",
          "name": "Thai Language",
          "alternateName": "ภาษาไทย"
        },
        "teaches": [
          "Thai vocabulary",
          "Thai pronunciation",
          "Thai language basics",
          "Thai culture and customs"
        ]
      }
    </script>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      :root {
        /* Match ESL Fun Online design system */
        --primary: #46bbe5;
        --primary-dark: #05425c;
        --primary-hover: #0d4f66;
        --primary-light: rgba(70, 187, 229, 0.1);
        --secondary: #10b981;
        --secondary-hover: #059669;
        --secondary-light: rgba(16, 185, 129, 0.1);
        --accent: #f59e0b;
        --accent-light: #fbbf24;
        --accent-hover: #d97706;
        --accent-dark: #d97706;
        --light: #f9fafb;
        --dark: #1f2937;
        --success: #10b981;
        --danger: #ef4444;
        --warning: #f59e0b;
        --info: #3b82f6;
        --info-light: rgba(59, 130, 246, 0.1);
        --gray: #6b7280;
        --text-primary: #1f2937;
        --text-secondary: #6b7280;
        --text-muted: #9ca3af;
        --text-inverse: #ffffff;
        --bg-primary: #ffffff;
        --bg-secondary: #f9fafb;
        --bg-tertiary: #f3f4f6;
        --border-color: #e5e7eb;
        --border-radius: 12px;
        --box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1),
          0 2px 4px -2px rgb(0 0 0 / 0.1);
        --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1),
          0 4px 6px -4px rgb(0 0 0 / 0.1);
        --transition: all 0.3s ease;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        line-height: 1.6;
        color: #333;
        background: linear-gradient(
          135deg,
          var(--primary) 0%,
          var(--secondary) 100%
        );
        min-height: 100vh;
        padding-bottom: 2rem;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 1rem;
      }

      /* Header & Navigation - Matching main site */
      header {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        position: sticky;
        top: 0;
        z-index: 1000;
        border-bottom: 1px solid var(--border-color);
      }

      .navbar {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 1rem 0;
        position: relative;
      }

      .logo-container {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        text-decoration: none;
        color: var(--text-primary);
        font-weight: 700;
        font-size: 1.25rem;
        transition: var(--transition);
      }

      .logo-image {
        width: 40px;
        height: 40px;
        border-radius: 8px;
      }

      .nav-links {
        display: flex;
        align-items: center;
        gap: 2rem;
        list-style: none;
        margin: 0;
        padding: 0;
      }

      .nav-item {
        position: relative;
      }

      .nav-link {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        text-decoration: none;
        color: var(--text-secondary);
        font-weight: 500;
        padding: 0.75rem 1rem;
        border-radius: var(--border-radius);
        transition: var(--transition);
        font-size: 0.95rem;
      }

      .nav-link:hover,
      .nav-link.active {
        color: var(--primary);
        background: var(--primary-light);
      }

      .nav-link i {
        font-size: 0.9rem;
      }

      .dropdown {
        position: absolute;
        top: 100%;
        left: 0;
        background: var(--bg-primary);
        border: 1px solid var(--border-color);
        border-radius: var(--border-radius);
        box-shadow: var(--shadow-lg);
        min-width: 220px;
        opacity: 0;
        visibility: hidden;
        transform: translateY(-10px);
        transition: all 0.3s ease;
        z-index: 100;
      }

      .nav-item:hover .dropdown {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
      }

      .dropdown-item {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        padding: 0.75rem 1rem;
        text-decoration: none;
        color: var(--text-secondary);
        font-size: 0.9rem;
        border-bottom: 1px solid var(--border-color);
        transition: var(--transition);
      }

      .dropdown-item:last-child {
        border-bottom: none;
      }

      .dropdown-item:hover,
      .dropdown-item.active {
        background: var(--primary-light);
        color: var(--primary);
      }

      .controls {
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .control-btn {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 40px;
        height: 40px;
        border: none;
        background: var(--bg-secondary);
        color: var(--text-secondary);
        border-radius: var(--border-radius);
        cursor: pointer;
        transition: var(--transition);
        text-decoration: none;
      }

      .control-btn:hover {
        background: var(--primary-light);
        color: var(--primary);
      }

      .mobile-toggle {
        display: none;
      }

      /* Breadcrumb Navigation */
      .breadcrumb-nav {
        padding: 0.75rem 0;
        background: var(--bg-secondary);
        border-bottom: 1px solid var(--border-color);
      }

      .breadcrumb-list {
        display: flex;
        align-items: center;
        list-style: none;
        margin: 0;
        padding: 0;
        font-size: 0.875rem;
        gap: 0.5rem;
      }

      .breadcrumb-list li {
        display: flex;
        align-items: center;
      }

      .breadcrumb-list li:not(:last-child)::after {
        content: "/";
        margin-left: 0.5rem;
        color: var(--text-muted);
      }

      .breadcrumb-list a {
        color: var(--text-secondary);
        text-decoration: none;
        transition: var(--transition);
      }

      .breadcrumb-list a:hover {
        color: var(--primary);
      }

      .breadcrumb-list li:last-child span {
        color: var(--text-primary);
        font-weight: 500;
      }

      /* Hero Section */
      .hero {
        text-align: center;
        padding: 4rem 2rem;
        background: linear-gradient(
          135deg,
          var(--primary) 0%,
          var(--secondary) 50%,
          var(--accent) 100%
        );
        color: white;
        box-shadow: var(--shadow-lg);
        border-radius: 0 0 var(--border-radius) var(--border-radius);
        margin-bottom: 3rem;
        position: relative;
        overflow: hidden;
      }

      .hero h1 {
        font-size: 3rem;
        margin-bottom: 1rem;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
      }

      .hero p {
        font-size: 1.2rem;
        margin-bottom: 2rem;
        max-width: 600px;
        margin-left: auto;
        margin-right: auto;
        line-height: 1.6;
        opacity: 0.95;
      }

      .hero-buttons {
        display: flex;
        gap: 1rem;
        justify-content: center;
        flex-wrap: wrap;
        margin-top: 2rem;
      }

      .btn {
        padding: 0.8rem 1.8rem;
        border: none;
        border-radius: 50px;
        font-weight: 600;
        font-size: 1rem;
        cursor: pointer;
        transition: all 0.3s ease;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        text-decoration: none;
        min-width: 140px;
        justify-content: center;
      }

      .btn-primary {
        background: linear-gradient(
          135deg,
          var(--primary),
          var(--primary-dark)
        );
        color: white;
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
      }

      .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
      }

      .btn-outline {
        background: transparent;
        color: white;
        border: 2px solid rgba(255, 255, 255, 0.3);
        backdrop-filter: blur(10px);
      }

      .btn-outline:hover {
        background: rgba(255, 255, 255, 0.1);
        border-color: rgba(255, 255, 255, 0.5);
        transform: translateY(-2px);
      }

      .btn-success {
        background: linear-gradient(135deg, var(--success), #20c997);
        color: white;
      }

      .btn-warning {
        background: linear-gradient(135deg, var(--warning), #f39c12);
        color: white;
      }

      .btn-danger {
        background: linear-gradient(135deg, var(--danger), #e74c3c);
        color: white;
      }

      .btn-sm {
        padding: 0.6rem 1.2rem;
        font-size: 0.9rem;
        min-width: 100px;
      }

      .hero::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: url("data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><circle cx='20' cy='20' r='2' fill='rgba(255,255,255,0.1)'/><circle cx='80' cy='40' r='1' fill='rgba(255,255,255,0.1)'/><circle cx='40' cy='80' r='1.5' fill='rgba(255,255,255,0.1)'/></svg>");
        animation: float 20s ease-in-out infinite;
      }

      @keyframes float {
        0%,
        100% {
          transform: translateY(0px);
        }
        50% {
          transform: translateY(-20px);
        }
      }

      /* Mode selector */
      .mode-selector {
        display: flex;
        justify-content: center;
        margin: 2rem 0;
        background: white;
        border-radius: 50px;
        padding: 0.5rem;
        box-shadow: var(--box-shadow);
        max-width: 500px;
        margin-left: auto;
        margin-right: auto;
      }

      .mode-btn {
        flex: 1;
        padding: 0.8rem 1.5rem;
        border: none;
        background: transparent;
        color: var(--gray);
        border-radius: 50px;
        cursor: pointer;
        transition: var(--transition);
        font-weight: 600;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
      }

      .mode-btn.active {
        background: var(--primary);
        color: white;
        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
      }

      .difficulty-indicator {
        position: absolute;
        top: 1rem;
        right: 1rem;
        background: rgba(255, 255, 255, 0.2);
        padding: 0.3rem 0.8rem;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: 600;
      }

      /* Enhanced progress section */
      .progress-section {
        background: linear-gradient(135deg, #ffffff 0%, #f8f9ff 100%);
        border: 1px solid rgba(102, 126, 234, 0.1);
        border-radius: var(--border-radius);
        padding: 1.5rem;
        margin-bottom: 2rem;
        box-shadow: var(--box-shadow);
        opacity: 0;
        animation: slideInUp 0.6s ease forwards;
        animation-delay: 0.2s;
      }

      .progress-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1rem;
      }

      .progress-header h2 {
        color: var(--primary);
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .progress-stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1rem;
        margin-bottom: 1.5rem;
      }

      .stat-card {
        background: linear-gradient(135deg, var(--light) 0%, #ffffff 100%);
        border: 1px solid rgba(102, 126, 234, 0.1);
        border-radius: var(--border-radius);
        padding: 1.5rem;
        text-align: center;
        transition: var(--transition);
        position: relative;
        overflow: hidden;
      }

      .stat-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(102, 126, 234, 0.1),
          transparent
        );
        transition: left 0.5s ease;
      }

      .stat-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(102, 126, 234, 0.15);
      }

      .stat-card:hover::before {
        left: 100%;
      }

      .stat-number {
        font-size: 2.5rem;
        font-weight: 700;
        color: var(--primary);
        margin-bottom: 0.5rem;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
      }

      .stat-label {
        color: var(--gray);
        font-size: 0.9rem;
        font-weight: 500;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .progress-bar {
        height: 12px;
        background: var(--light);
        border-radius: 6px;
        overflow: hidden;
        margin: 1rem 0;
        position: relative;
        box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      .progress-fill {
        height: 100%;
        background: linear-gradient(
          90deg,
          var(--accent),
          var(--accent-light),
          var(--primary)
        );
        border-radius: 6px;
        width: 65%;
        transition: width 0.8s ease;
        position: relative;
        overflow: hidden;
      }

      .progress-fill::after {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.4),
          transparent
        );
        animation: shimmer 2s infinite;
      }

      @keyframes shimmer {
        0% {
          left: -100%;
        }
        100% {
          left: 100%;
        }
      }

      /* Flashcard Carousel */
      #flashcard-carousel {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin-top: 2rem;
        background: white;
        border-radius: var(--border-radius);
        padding: 2rem;
        box-shadow: var(--box-shadow);
        position: relative;
        overflow: visible;
        min-height: 400px;
        z-index: 5;
      }

      #flashcard-carousel::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(
          45deg,
          rgba(102, 126, 234, 0.02) 0%,
          rgba(118, 75, 162, 0.02) 50%,
          rgba(255, 107, 107, 0.02) 100%
        );
        pointer-events: none;
      }

      .flashcard-progress {
        font-size: 1.2rem;
        color: var(--primary);
        font-weight: 600;
        margin-bottom: 2rem;
        display: flex;
        align-items: center;
        gap: 1rem;
        position: relative;
        z-index: 1;
      }

      .study-stats {
        display: flex;
        justify-content: center;
        gap: 2rem;
        margin-bottom: 2rem;
        flex-wrap: wrap;
      }

      .study-stat {
        text-align: center;
        background: linear-gradient(135deg, var(--light), white);
        padding: 1rem 1.5rem;
        border-radius: var(--border-radius);
        border: 1px solid rgba(102, 126, 234, 0.1);
        min-width: 80px;
        transition: var(--transition);
      }

      .study-stat:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.1);
      }

      .study-stat-number {
        font-size: 1.8rem;
        font-weight: 700;
        color: var(--primary);
        margin-bottom: 0.3rem;
      }

      .study-stat-label {
        font-size: 0.8rem;
        color: var(--gray);
        text-transform: uppercase;
        letter-spacing: 0.5px;
        font-weight: 600;
      }

      /* Enhanced flashcard design - Fixed visibility */
      .flashcard {
        perspective: 1000px;
        width: 100%;
        max-width: 420px;
        height: 300px;
        margin: 2rem auto;
        cursor: pointer;
        position: relative;
        z-index: 10;
        display: block !important;
        visibility: visible !important;
      }

      .flashcard-inner {
        position: relative;
        width: 100%;
        height: 100%;
        transition: transform 0.6s ease;
        transform-style: preserve-3d;
      }

      .flashcard.flipped .flashcard-inner {
        transform: rotateY(180deg);
      }

      .flashcard-front,
      .flashcard-back {
        position: absolute;
        width: 100%;
        height: 100%;
        backface-visibility: hidden;
        border-radius: 20px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        padding: 2rem;
        box-shadow: 0 12px 40px rgba(102, 126, 234, 0.2);
        border: 3px solid rgba(255, 255, 255, 0.2);
        transition: all 0.3s ease;
      }

      .flashcard-front {
        background: linear-gradient(
          135deg,
          var(--primary) 0%,
          var(--secondary) 50%,
          #8b5fbf 100%
        );
        color: white;
        position: relative;
        overflow: hidden;
        opacity: 1 !important;
        visibility: visible !important;
      }

      .flashcard-front::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: radial-gradient(
          circle at 30% 20%,
          rgba(255, 255, 255, 0.2) 0%,
          transparent 50%
        );
        border-radius: 20px;
      }

      .flashcard-back {
        background: linear-gradient(135deg, #ffffff 0%, #f8f9ff 100%);
        color: var(--dark);
        transform: rotateY(180deg);
        border: 3px solid var(--accent-light);
        opacity: 1 !important;
        visibility: visible !important;
      }

      .flashcard:hover .flashcard-front,
      .flashcard:hover .flashcard-back {
        box-shadow: 0 16px 48px rgba(102, 126, 234, 0.25);
      }

      .thai-text {
        font-size: 3rem;
        color: white !important;
        font-weight: 700;
        margin: 1rem 0;
        text-align: center;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        line-height: 1.2;
        position: relative;
        z-index: 2;
        display: block !important;
        visibility: visible !important;
      }

      .phonetic {
        font-style: italic;
        color: rgba(255, 255, 255, 0.9);
        font-size: 1.3rem;
        margin: 1rem 0;
        text-align: center;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
        position: relative;
        z-index: 2;
      }

      .flashcard-back .phonetic {
        color: var(--text-secondary);
        text-shadow: none;
      }

      .answer {
        font-size: 2rem;
        font-weight: 700;
        color: var(--primary);
        text-align: center;
        margin: 1rem 0;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
        position: relative;
        z-index: 2;
      }

      .action-buttons {
        display: flex;
        gap: 1rem;
        justify-content: center;
        margin-top: 2rem;
        flex-wrap: wrap;
      }

      .action-buttons button {
        min-width: 120px;
      }

      /* Quiz Mode Enhancements */
      .quiz-mode {
        display: none;
        background: white;
        border-radius: var(--border-radius);
        padding: 2rem;
        box-shadow: var(--box-shadow);
        margin-top: 2rem;
        position: relative;
        overflow: hidden;
      }

      .quiz-mode::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(
          45deg,
          rgba(255, 107, 107, 0.02) 0%,
          rgba(254, 202, 87, 0.02) 50%,
          rgba(102, 126, 234, 0.02) 100%
        );
        pointer-events: none;
      }

      .quiz-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 2rem;
        position: relative;
        z-index: 1;
      }

      .quiz-header h2 {
        color: var(--primary);
        margin: 0;
      }

      .quiz-progress {
        background: var(--light);
        padding: 0.5rem 1rem;
        border-radius: 50px;
        font-weight: 600;
        color: var(--primary);
      }

      .quiz-question {
        text-align: center;
        margin-bottom: 2rem;
        padding: 2rem;
        background: linear-gradient(135deg, var(--light), white);
        border-radius: var(--border-radius);
        border: 2px solid rgba(102, 126, 234, 0.1);
        position: relative;
        z-index: 1;
      }

      .quiz-question .question {
        font-size: 1.3rem;
        color: var(--dark);
        margin-bottom: 1rem;
        font-weight: 600;
      }

      .quiz-options {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 1rem;
        margin-bottom: 2rem;
        position: relative;
        z-index: 1;
      }

      .quiz-option {
        padding: 1.2rem;
        background: linear-gradient(135deg, white, var(--light));
        border: 2px solid rgba(102, 126, 234, 0.1);
        border-radius: var(--border-radius);
        cursor: pointer;
        transition: all 0.3s ease;
        text-align: center;
        font-weight: 500;
        position: relative;
        overflow: hidden;
      }

      .quiz-option::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(102, 126, 234, 0.1),
          transparent
        );
        transition: left 0.3s ease;
      }

      .quiz-option:hover {
        transform: translateY(-2px);
        border-color: var(--primary);
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.2);
      }

      .quiz-option:hover::before {
        left: 100%;
      }

      .quiz-option.selected {
        background: linear-gradient(
          135deg,
          var(--primary),
          var(--primary-dark)
        );
        color: white;
        border-color: var(--primary);
        transform: translateY(-2px);
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
      }

      .quiz-option.correct {
        background: linear-gradient(135deg, var(--success), #20c997);
        color: white;
        border-color: var(--success);
        animation: pulse-success 0.6s ease;
      }

      .quiz-option.incorrect {
        background: linear-gradient(135deg, var(--danger), #e74c3c);
        color: white;
        border-color: var(--danger);
        animation: shake 0.5s ease;
      }

      @keyframes pulse-success {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.05);
        }
      }

      @keyframes shake {
        0%,
        100% {
          transform: translateX(0);
        }
        25% {
          transform: translateX(-5px);
        }
        75% {
          transform: translateX(5px);
        }
      }

      /* Settings Panel Enhancement */
      .settings-toggle {
        position: fixed;
        top: 50%;
        right: 20px;
        transform: translateY(-50%);
        background: linear-gradient(
          135deg,
          var(--primary),
          var(--primary-dark)
        );
        color: white;
        border: none;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        cursor: pointer;
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        transition: all 0.3s ease;
        z-index: 1000;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.2rem;
      }

      .settings-toggle:hover {
        transform: translateY(-50%) scale(1.1);
        box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
      }

      .settings-panel {
        position: fixed;
        top: 0;
        right: -300px;
        width: 300px;
        height: 100vh;
        background: linear-gradient(135deg, white 0%, #f8f9ff 100%);
        box-shadow: -4px 0 20px rgba(0, 0, 0, 0.1);
        transition: right 0.3s ease;
        z-index: 999;
        padding: 2rem;
        overflow-y: auto;
        border-left: 3px solid var(--primary);
      }

      .settings-panel.open {
        right: 0;
      }

      .settings-panel h3 {
        color: var(--primary);
        margin-bottom: 1.5rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 1.4rem;
      }

      .settings-panel label {
        display: block;
        margin-bottom: 0.5rem;
        font-weight: 600;
        color: var(--dark);
      }

      .settings-panel input,
      .settings-panel select {
        width: 100%;
        padding: 0.8rem;
        border: 2px solid rgba(102, 126, 234, 0.2);
        border-radius: var(--border-radius);
        font-size: 1rem;
        transition: all 0.3s ease;
        margin-bottom: 1rem;
      }

      .settings-panel input:focus,
      .settings-panel select:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
      }

      .settings-panel input[type="checkbox"] {
        width: auto;
        margin-right: 0.5rem;
        transform: scale(1.2);
      }

      /* Dark mode toggle */
      .dark-mode-toggle {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 1rem;
        background: var(--light);
        border-radius: var(--border-radius);
        margin: 1rem 0;
        border: 2px solid rgba(102, 126, 234, 0.1);
      }

      /* Audio controls */
      .audio-controls {
        background: var(--light);
        padding: 1rem;
        border-radius: var(--border-radius);
        margin: 1rem 0;
        border: 2px solid rgba(102, 126, 234, 0.1);
      }

      .volume-control {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        margin-top: 0.5rem;
      }

      .volume-slider {
        flex: 1;
        height: 4px;
        background: rgba(102, 126, 234, 0.2);
        border-radius: 2px;
        outline: none;
        -webkit-appearance: none;
        appearance: none;
      }

      .volume-slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 16px;
        height: 16px;
        background: var(--primary);
        border-radius: 50%;
        cursor: pointer;
      }

      /* Footer */
      footer {
        text-align: center;
        padding: 2rem;
        margin-top: 3rem;
        color: white;
      }

      /* Animations */
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(-10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @keyframes slideInUp {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .fade-in {
        animation: fadeIn 0.5s ease;
      }

      .slide-in-up {
        animation: slideInUp 0.5s ease;
      }

      /* Enhanced responsive design */
      @media (max-width: 1024px) {
        .nav-links {
          gap: 1rem;
        }

        .container {
          padding: 0 1.5rem;
        }
      }

      @media (max-width: 768px) {
        .mobile-toggle {
          display: flex;
        }

        .nav-links {
          position: fixed;
          top: 100%;
          left: 0;
          width: 100%;
          background: var(--bg-primary);
          border-top: 1px solid var(--border-color);
          box-shadow: var(--shadow-lg);
          flex-direction: column;
          align-items: stretch;
          gap: 0;
          opacity: 0;
          visibility: hidden;
          transform: translateY(-20px);
          transition: all 0.3s ease;
          z-index: 999;
          padding: 1rem 0;
        }

        .nav-links.active {
          opacity: 1;
          visibility: visible;
          transform: translateY(0);
        }

        .nav-item {
          width: 100%;
        }

        .nav-link {
          justify-content: flex-start;
          padding: 1rem 1.5rem;
          border-radius: 0;
        }

        .dropdown {
          position: static;
          opacity: 1;
          visibility: visible;
          transform: none;
          box-shadow: none;
          border: none;
          border-top: 1px solid var(--border-color);
          border-radius: 0;
          background: var(--bg-secondary);
        }

        .dropdown-item {
          padding: 0.75rem 2rem;
        }

        .hero {
          padding: 3rem 1.5rem;
        }

        .hero h1 {
          font-size: 2.5rem;
        }

        .hero-buttons {
          flex-direction: column;
          align-items: center;
          gap: 0.75rem;
        }

        .hero-buttons .btn {
          width: 100%;
          max-width: 280px;
        }

        .progress-stats {
          grid-template-columns: 1fr;
          gap: 1rem;
        }

        .flashcard {
          max-width: 340px;
          height: 260px;
        }

        .thai-text {
          font-size: 2.2rem;
        }

        .answer {
          font-size: 1.6rem;
        }

        .action-buttons {
          flex-direction: column;
          align-items: center;
          gap: 0.75rem;
        }

        .action-buttons button {
          width: 100%;
          max-width: 200px;
        }

        .mode-selector {
          flex-direction: column;
          gap: 0.5rem;
          padding: 1rem;
        }

        .mode-btn {
          border-radius: var(--border-radius);
        }

        .settings-panel {
          width: 100%;
          right: -100%;
          border-radius: 0;
        }

        .settings-toggle {
          right: 1rem;
        }

        .quiz-options {
          grid-template-columns: 1fr;
          gap: 0.75rem;
        }

        .study-stats {
          gap: 1rem;
        }

        .study-stat {
          min-width: 70px;
          padding: 0.75rem 1rem;
        }

        /* Cultural context mobile styles */
        #cultural-context {
          margin-top: 2rem !important;
          padding: 1.5rem !important;
        }

        #cultural-context div[style*="grid-template-columns"] {
          grid-template-columns: 1fr !important;
          gap: 1rem !important;
        }
      }

      @media (max-width: 480px) {
        .container {
          padding: 0 1rem;
        }

        .hero {
          padding: 2rem 1rem;
        }

        .hero h1 {
          font-size: 2rem;
        }

        .hero p {
          font-size: 1rem;
        }

        .flashcard {
          max-width: 300px;
          height: 220px;
        }

        .thai-text {
          font-size: 1.8rem;
        }

        .answer {
          font-size: 1.4rem;
        }

        .study-stats {
          flex-direction: column;
          gap: 0.75rem;
        }

        .study-stat {
          width: 100%;
        }

        .settings-toggle {
          width: 45px;
          height: 45px;
          right: 0.5rem;
        }
      }

      /* Loading animation */
      .loading {
        display: inline-block;
        width: 20px;
        height: 20px;
        border: 3px solid rgba(255, 255, 255, 0.3);
        border-radius: 50%;
        border-top-color: #fff;
        animation: spin 1s ease-in-out infinite;
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      @keyframes bounce {
        0%,
        20%,
        60%,
        100% {
          transform: translate(-50%, -50%) translateY(0);
        }
        40% {
          transform: translate(-50%, -50%) translateY(-30px);
        }
        80% {
          transform: translate(-50%, -50%) translateY(-15px);
        }
      }

      /* Notification styles */
      .notification {
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 1rem 1.5rem;
        border-radius: var(--border-radius);
        color: white;
        font-weight: 600;
        z-index: 2000;
        animation: slideInRight 0.3s ease;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        display: flex;
        align-items: center;
        gap: 0.5rem;
        max-width: 300px;
      }

      @keyframes slideInRight {
        from {
          transform: translateX(100%);
          opacity: 0;
        }
        to {
          transform: translateX(0);
          opacity: 1;
        }
      }

      /* Theme enhancements */
      .theme-dark {
        filter: invert(1) hue-rotate(180deg);
      }

      .theme-dark img,
      .theme-dark video {
        filter: invert(1) hue-rotate(180deg);
      }

      /* New Mode Styles */
      .writing-mode, .conversation-mode {
        opacity: 0;
        animation: slideInUp 0.6s ease forwards;
      }

      #writing-canvas {
        touch-action: none;
        border: 2px dashed var(--border-color);
        transition: border-color 0.3s ease;
      }

      #writing-canvas:hover {
        border-color: var(--primary);
      }

      .conversation-option:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      }

      .cultural-option:hover {
        background: var(--primary-light) !important;
        border-color: var(--primary) !important;
        transform: translateY(-2px);
      }

      .category-filter:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      }

      .category-filter.active {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      }

      /* Enhanced mobile styles for new features */
      @media (max-width: 768px) {
        .mode-selector {
          grid-template-columns: repeat(2, 1fr);
          gap: 0.5rem;
        }

        .mode-btn {
          font-size: 0.9rem;
          padding: 0.7rem 1rem;
        }

        #writing-canvas {
          width: 100%;
          height: 150px;
        }

        .conversation-line {
          flex-direction: column !important;
          text-align: center !important;
        }

        .conversation-line > div:last-child {
          text-align: center !important;
        }

        .cultural-option, .conversation-option {
          font-size: 0.9rem;
          padding: 0.8rem;
        }

        .category-filter {
          font-size: 0.8rem;
          padding: 0.5rem 1rem;
        }

        #vocabulary-grid {
          grid-template-columns: 1fr;
        }
      }

      @media (max-width: 480px) {
        .mode-selector {
          grid-template-columns: 1fr;
        }

        .hero-buttons {
          grid-template-columns: 1fr;
        }

        .hero-buttons .btn {
          width: 100%;
          margin: 0.25rem 0;
        }
      }

      /* Animation keyframes for new features */
      @keyframes slideInLeft {
        from {
          opacity: 0;
          transform: translateX(-30px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      @keyframes slideInRight {
        from {
          opacity: 0;
          transform: translateX(30px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      .conversation-line:nth-child(odd) {
        animation: slideInLeft 0.6s ease forwards;
      }

      .conversation-line:nth-child(even) {
        animation: slideInRight 0.6s ease forwards;
      }

      /* Success/error states */
      .success-light {
        background: rgba(16, 185, 129, 0.1) !important;
      }

      .error-light {
        background: rgba(239, 68, 68, 0.1) !important;
      }

      /* Print styles */
      @media print {
        .settings-toggle,
        .settings-panel,
        .action-buttons,
        .mode-selector,
        .hero-buttons {
          display: none !important;
        }

        .flashcard {
          box-shadow: none !important;
          border: 2px solid #333 !important;
        }

        #writing-mode,
        #conversation-mode,
        #cultural-quiz {
          display: none !important;
        }
      }
    </style>
  </head>
  <body>
    <header>
      <div class="container">
        <nav class="navbar">
          <a href="../index.html" class="logo-container">
            <img
              src="../images/1.png"
              alt="ESL Fun Online Logo"
              class="logo-image"
            />
            <span class="logo-text">ESL Fun Online</span>
          </a>

          <ul
            class="nav-links"
            id="navLinks"
            role="menubar"
            aria-label="Main navigation"
          >
            <li class="nav-item" role="none">
              <a href="../index.html" class="nav-link" role="menuitem">
                <i class="fas fa-home"></i>
                Home
              </a>
            </li>
            <li class="nav-item" role="none">
              <a
                href="../index.html"
                class="nav-link"
                role="menuitem"
                aria-haspopup="true"
                aria-expanded="false"
              >
                <i class="fas fa-book"></i>
                English
                <i class="fas fa-chevron-down"></i>
              </a>
              <div class="dropdown" role="menu" aria-label="English submenu">
                <a href="../english/grammar.html" class="dropdown-item">
                  <i class="fas fa-spell-check"></i>
                  Grammar Guides
                </a>
                <a href="../english/vocabguide.html" class="dropdown-item">
                  <i class="fas fa-book-open"></i>
                  Vocabulary Building
                </a>
                <a href="../english/worksheets.html" class="dropdown-item">
                  <i class="fas fa-file-alt"></i>
                  Worksheets
                </a>
                <a href="../english/writingf.html" class="dropdown-item">
                  <i class="fas fa-pen"></i>
                  Writing for Success
                </a>
                <a href="../english/business.html" class="dropdown-item">
                  <i class="fas fa-briefcase"></i>
                  Business English
                </a>
                <a href="../english/test.html" class="dropdown-item">
                  <i class="fas fa-graduation-cap"></i>
                  Test Preparation
                </a>
              </div>
            </li>
            <li class="nav-item">
              <a href="../index.html" class="nav-link">
                <i class="fas fa-users"></i>
                Teachers
                <i class="fas fa-chevron-down"></i>
              </a>
              <div class="dropdown">
                <a href="thai.html" class="dropdown-item active">
                  <i class="fas fa-flag"></i>
                  Thai Language
                </a>
                <a href="#" class="dropdown-item">
                  <i class="fas fa-chalkboard-teacher"></i>
                  Teaching Resources
                </a>
              </div>
            </li>
            <li class="nav-item">
              <a href="../games/games.html" class="nav-link">
                <i class="fas fa-dice"></i>
                Games
              </a>
            </li>
            <li class="nav-item">
              <a href="../tools/tools.html" class="nav-link">
                <i class="fas fa-tools"></i>
                Toolkit
              </a>
            </li>
            <li class="nav-item">
              <a href="../blog/blog.html" class="nav-link">
                <i class="fas fa-book-open"></i>
                Blog
              </a>
            </li>
          </ul>

          <div class="controls">
            <button
              class="control-btn theme-toggle"
              id="themeToggle"
              aria-label="Toggle dark mode"
            >
              <i class="fas fa-moon"></i>
            </button>
            <a
              class="control-btn admin-toggle"
              id="adminToggle"
              aria-label="Admin"
              href="../login.html"
            >
              <i class="fas fa-user-shield"></i>
            </a>
          </div>
          <button
            class="control-btn mobile-toggle"
            id="mobileToggle"
            aria-label="Toggle mobile menu"
          >
            <i class="fas fa-bars"></i>
          </button>
        </nav>
      </div>
    </header>

    <!-- Immediate Mobile Menu Script - Inline for guaranteed execution -->
    <script>
      (function () {
        "use strict";

        function initMobileMenu() {
          const mobileToggle = document.getElementById("mobileToggle");
          const navLinks = document.getElementById("navLinks");
          const body = document.body;

          if (!mobileToggle || !navLinks) {
            console.warn("Mobile menu elements not found");
            return;
          }

          console.log("Immediate mobile menu initialized");

          let isMenuOpen = false;

          function toggleMenu(e) {
            if (e && e.preventDefault) e.preventDefault();
            if (e && e.stopPropagation) e.stopPropagation();

            isMenuOpen = !isMenuOpen;
            const icon = mobileToggle.querySelector("i");

            if (isMenuOpen) {
              navLinks.classList.add("active");
              body.classList.add("mobile-menu-open");
              body.style.overflow = "hidden";
              if (icon) icon.className = "fas fa-times";
              console.log("Menu opened");
            } else {
              navLinks.classList.remove("active");
              body.classList.remove("mobile-menu-open");
              body.style.overflow = "";
              if (icon) icon.className = "fas fa-bars";
              console.log("Menu closed");

              // Close all dropdowns
              document.querySelectorAll(".nav-item").forEach((item) => {
                item.classList.remove("mobile-open", "mobile-dropdown-open");
                const chevron = item.querySelector(".fa-chevron-down");
                if (chevron) chevron.style.transform = "rotate(0deg)";
              });
            }
          }

          // Simple unified handler - works for both touch and click
          let lastToggleTime = 0;
          
          function handleToggleClick(e) {
            const now = Date.now();
            // Prevent double-firing within 300ms
            if (now - lastToggleTime < 300) {
              console.log("Toggle ignored - too fast");
              return;
            }
            lastToggleTime = now;
            
            e.preventDefault();
            e.stopPropagation();
            console.log("Hamburger clicked/tapped");
            toggleMenu(e);
          }

          mobileToggle.addEventListener("click", handleToggleClick);
          mobileToggle.addEventListener("touchend", handleToggleClick);

          // Handle dropdown toggles on mobile
          document.querySelectorAll(".nav-item").forEach((item) => {
            const link = item.querySelector(".nav-link");
            const dropdown = item.querySelector(".dropdown");
            const chevron = link?.querySelector(".fa-chevron-down");

            // Only add special handling for links WITH dropdowns
            if (link && dropdown && chevron) {
              // Simple unified dropdown handler
              let lastDropdownToggle = 0;
              
              function handleDropdownClick(e) {
                if (window.innerWidth > 768) return; // Only on mobile
                
                const now = Date.now();
                // Prevent double-firing within 300ms
                if (now - lastDropdownToggle < 300) {
                  console.log("Dropdown toggle ignored - too fast");
                  return;
                }
                lastDropdownToggle = now;
                
                e.preventDefault();
                e.stopPropagation();

                const isOpen = item.classList.contains("mobile-open");
                console.log("Dropdown clicked:", isOpen ? "closing" : "opening");

                // Close other dropdowns
                document.querySelectorAll(".nav-item").forEach((otherItem) => {
                  if (otherItem !== item) {
                    otherItem.classList.remove("mobile-open", "mobile-dropdown-open");
                    const otherChevron = otherItem.querySelector(".fa-chevron-down");
                    if (otherChevron) otherChevron.style.transform = "rotate(0deg)";
                  }
                });

                // Toggle current dropdown
                if (isOpen) {
                  item.classList.remove("mobile-open", "mobile-dropdown-open");
                  chevron.style.transform = "rotate(0deg)";
                  link.setAttribute("aria-expanded", "false");
                } else {
                  item.classList.add("mobile-open", "mobile-dropdown-open");
                  chevron.style.transform = "rotate(180deg)";
                  link.setAttribute("aria-expanded", "true");
                }
              }

              // Remove href="#" behavior on mobile
              if (link.getAttribute("href") === "#") {
                link.style.cursor = "pointer";
              }

              // Attach handlers for both click and touch
              link.addEventListener("click", handleDropdownClick);
              link.addEventListener("touchend", handleDropdownClick);
            }
          });

          // Close menu when clicking outside
          document.addEventListener("click", function (e) {
            if (window.innerWidth <= 768 && isMenuOpen) {
              if (
                !mobileToggle.contains(e.target) &&
                !navLinks.contains(e.target)
              ) {
                toggleMenu(null);
              }
            }
          });

          // Close menu on escape key
          document.addEventListener("keydown", function (e) {
            if (e.key === "Escape" && isMenuOpen) {
              toggleMenu(null);
              mobileToggle.focus();
            }
          });

          // Close menu on window resize to desktop
          window.addEventListener("resize", function () {
            if (window.innerWidth > 768 && isMenuOpen) {
              toggleMenu(null);
            }
          });

          // Close menu after dropdown link click
          document.querySelectorAll(".dropdown a").forEach((link) => {
            link.addEventListener("click", function () {
              if (window.innerWidth <= 768 && isMenuOpen) {
                setTimeout(() => {
                  toggleMenu(null);
                }, 100);
              }
            });
          });
        }

        // Initialize immediately if DOM is ready, otherwise wait
        if (document.readyState === "loading") {
          document.addEventListener("DOMContentLoaded", initMobileMenu);
        } else {
          initMobileMenu();
        }
      })();
    </script>

    <!-- Additional Mobile Dropdown Fixes -->
    <style>
      /* Ensure mobile dropdowns work properly */
      @media (max-width: 768px) {
        /* FORCE mobile menu to display full width */
        .nav-links,
        #navLinks,
        ul.nav-links {
          display: flex !important;
          position: fixed !important;
          top: 70px !important;
          left: 0 !important;
          right: 0 !important;
          bottom: 0 !important;
          width: 100vw !important;
          height: auto !important;
          min-height: calc(100vh - 70px) !important;
        }

        .nav-links.active,
        #navLinks.active,
        ul.nav-links.active {
          display: flex !important;
          max-height: calc(100vh - 70px) !important;
          height: auto !important;
        }

        /* Make sure nav links with dropdowns are clearly tappable */
        .nav-item .nav-link {
          position: relative;
          user-select: none;
          -webkit-user-select: none;
          -webkit-tap-highlight-color: rgba(70, 187, 229, 0.2);
          cursor: pointer;
        }

        /* Ensure chevron is visible and clickable */
        .nav-link .fa-chevron-down {
          transition: transform 0.3s ease !important;
          opacity: 1 !important;
          pointer-events: none; /* Let clicks go through to parent link */
        }

        /* Visual feedback when dropdown is open */
        .nav-item.mobile-open > .nav-link,
        .nav-item.mobile-dropdown-open > .nav-link {
          background: rgba(70, 187, 229, 0.15) !important;
          border-color: var(--primary-color, #46bbe5) !important;
        }

        /* Make dropdowns smoother */
        .dropdown {
          transition: max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1),
            padding 0.4s cubic-bezier(0.4, 0, 0.2, 1) !important;
        }

        /* Ensure dropdown items are visible when parent is open */
        .nav-item.mobile-open .dropdown,
        .nav-item.mobile-dropdown-open .dropdown {
          display: block !important;
          visibility: visible !important;
          opacity: 1 !important;
        }

        /* Override any conflicting hover states */
        .nav-item:hover .dropdown {
          max-height: 0 !important;
          padding: 0 !important;
        }

        .nav-item.mobile-open:hover .dropdown,
        .nav-item.mobile-dropdown-open:hover .dropdown {
          max-height: 600px !important;
          padding: 0.75rem 0.5rem !important;
        }
      }
    </style>

    <!-- Breadcrumb Navigation -->
    <nav aria-label="Breadcrumb" class="breadcrumb-nav">
      <div class="container">
        <ol
          itemscope
          itemtype="https://schema.org/BreadcrumbList"
          class="breadcrumb-list"
        >
          <li
            itemprop="itemListElement"
            itemscope
            itemtype="https://schema.org/ListItem"
          >
            <a itemprop="item" href="../index.html">
              <span itemprop="name">Home</span>
            </a>
            <meta itemprop="position" content="1" />
          </li>
          <li
            itemprop="itemListElement"
            itemscope
            itemtype="https://schema.org/ListItem"
          >
            <a itemprop="item" href="#">
              <span itemprop="name">Teachers</span>
            </a>
            <meta itemprop="position" content="2" />
          </li>
          <li
            itemprop="itemListElement"
            itemscope
            itemtype="https://schema.org/ListItem"
          >
            <span itemprop="name">Thai Language</span>
            <meta itemprop="position" content="3" />
          </li>
        </ol>
      </div>
    </nav>

    <div class="container">
      <div class="hero">
        <h1>🇹🇭 Thai Language Mastery</h1>
        <p>
          Master Thai vocabulary with our intelligent flashcard system featuring
          spaced repetition, authentic pronunciation, and progressive difficulty
          levels. From basic greetings to advanced concepts - your journey to
          Thai fluency starts here!
        </p>
        <div class="hero-buttons">
          <button class="btn btn-primary" onclick="startFlashcards()">
            <i class="fas fa-play"></i> Start Learning
          </button>
          <button
            class="btn btn-outline"
            onclick="document.getElementById('progress-section').scrollIntoView({behavior: 'smooth'})"
          >
            <i class="fas fa-chart-line"></i> View Progress
          </button>
          <button class="btn btn-outline" onclick="switchMode('quiz', event)">
            <i class="fas fa-brain"></i> Take Quiz
          </button>
          <button class="btn btn-outline" onclick="switchMode('writing', event)">
            <i class="fas fa-pen"></i> Writing Practice
          </button>
          <button
            class="btn btn-outline"
            onclick="document.getElementById('cultural-context').scrollIntoView({behavior: 'smooth'})"
          >
            <i class="fas fa-temple"></i> Learn Culture
          </button>
          <button
            class="btn btn-outline"
            onclick="document.getElementById('grammar-guide').scrollIntoView({behavior: 'smooth'})"
          >
            <i class="fas fa-book"></i> Grammar Guide
          </button>
        </div>

        <!-- Quick Start Guide -->
        <div
          style="
            max-width: 600px;
            margin: 2rem auto 0;
            padding: 1.5rem;
            background: rgba(255, 255, 255, 0.15);
            border-radius: var(--border-radius);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
          "
        >
          <h3
            style="
              color: white;
              text-align: center;
              margin-bottom: 1rem;
              display: flex;
              align-items: center;
              justify-content: center;
              gap: 0.5rem;
            "
          >
            <i class="fas fa-rocket"></i> Quick Start Guide
          </h3>
          <div
            style="
              display: grid;
              grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
              gap: 1rem;
              text-align: center;
            "
          >
            <div
              style="
                padding: 1rem;
                border-radius: var(--border-radius);
                background: rgba(255, 255, 255, 0.1);
              "
            >
              <div style="font-size: 2rem; margin-bottom: 0.5rem">🎴</div>
              <strong style="display: block; margin-bottom: 0.5rem"
                >Study Flashcards</strong
              >
              <small style="opacity: 0.9"
                >Click cards to flip & learn Thai words</small
              >
            </div>
            <div
              style="
                padding: 1rem;
                border-radius: var(--border-radius);
                background: rgba(255, 255, 255, 0.1);
              "
            >
              <div style="font-size: 2rem; margin-bottom: 0.5rem">🔊</div>
              <strong style="display: block; margin-bottom: 0.5rem"
                >Listen & Repeat</strong
              >
              <small style="opacity: 0.9"
                >Audio pronunciation helps with tones</small
              >
            </div>
            <div
              style="
                padding: 1rem;
                border-radius: var(--border-radius);
                background: rgba(255, 255, 255, 0.1);
              "
            >
              <div style="font-size: 2rem; margin-bottom: 0.5rem">⚡</div>
              <strong style="display: block; margin-bottom: 0.5rem"
                >Mark Difficulty</strong
              >
              <small style="opacity: 0.9"
                >Easy, Good, or Hard - we'll remember!</small
              >
            </div>
            <div
              style="
                padding: 1rem;
                border-radius: var(--border-radius);
                background: rgba(255, 255, 255, 0.1);
              "
            >
              <div style="font-size: 2rem; margin-bottom: 0.5rem">🏆</div>
              <strong style="display: block; margin-bottom: 0.5rem"
                >Track Progress</strong
              >
              <small style="opacity: 0.9">See your improvement over time</small>
            </div>
          </div>
        </div>
      </div>

      <!-- Mode Selector -->
      <div class="mode-selector">
        <button
          class="mode-btn active"
          onclick="switchMode('flashcards', event)"
        >
          <i class="fas fa-layer-group"></i>
          Flashcards
        </button>
        <button class="mode-btn" onclick="switchMode('quiz', event)">
          <i class="fas fa-question-circle"></i>
          Quiz
        </button>
        <button class="mode-btn" onclick="switchMode('writing', event)">
          <i class="fas fa-pen"></i>
          Writing
        </button>
        <button class="mode-btn" onclick="switchMode('conversation', event)">
          <i class="fas fa-comments"></i>
          Conversation
        </button>
        <button class="mode-btn" onclick="switchMode('study', event)">
          <i class="fas fa-book-open"></i>
          Study
        </button>
      </div>

      <!-- User Progress Section -->
      <section class="progress-section" id="progress-section">
        <div class="progress-header">
          <h2>Your Learning Progress</h2>
          <button class="btn btn-primary btn-sm" onclick="updateProgress()">
            <i class="fas fa-sync-alt"></i> Update
          </button>
        </div>

        <div class="progress-stats">
          <div class="stat-card">
            <div class="stat-number" id="words-mastered">0</div>
            <div class="stat-label">Words Mastered</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="cards-practiced">0</div>
            <div class="stat-label">Cards Practiced</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="accuracy">0%</div>
            <div class="stat-label">Accuracy</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="cards-due">0</div>
            <div class="stat-label">Due for Review</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="daily-goal-progress">0/10</div>
            <div class="stat-label">Daily Goal</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="study-streak">0</div>
            <div class="stat-label">Day Streak</div>
          </div>
        </div>

        <div>
          <div class="progress-header">
            <span>Overall Progress</span>
            <span id="overall-progress">65%</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" id="progress-fill"></div>
          </div>
        </div>
      </section>

      <!-- Simplified Flashcard Section -->
      <section id="flashcard-mode" style="display: block; padding: 2rem; margin: 2rem 0;">
        <div style="text-align: center; margin-bottom: 2rem;">
          <h2 style="color: var(--primary); margin-bottom: 1rem;">Thai Flashcards</h2>
          <p>Card <span id="flashcard-current">1</span> of <span id="flashcard-total">20</span></p>
        </div>

        <div style="text-align: center; margin-bottom: 2rem;">
          <span style="background: var(--primary-light); padding: 0.5rem 1rem; border-radius: 20px; color: var(--primary);">
            Correct: <span id="session-correct">0</span> | 
            Wrong: <span id="session-incorrect">0</span> | 
            Streak: <span id="session-streak">0</span>
          </span>
        </div>

        <!-- Simple Visible Flashcard -->
        <div style="max-width: 400px; margin: 2rem auto; text-align: center;">
          <div 
            id="simple-flashcard" 
            onclick="flipSimpleCard()" 
            style="
              background: linear-gradient(135deg, #46bbe5, #10b981);
              color: white;
              padding: 3rem 2rem;
              border-radius: 20px;
              box-shadow: 0 8px 32px rgba(0,0,0,0.2);
              cursor: pointer;
              min-height: 250px;
              display: flex;
              flex-direction: column;
              justify-content: center;
              align-items: center;
              position: relative;
            "
          >
            <button 
              onclick="event.stopPropagation(); speakThai(document.getElementById('flashcard-thai').textContent)"
              style="
                position: absolute;
                top: 1rem;
                right: 1rem;
                background: rgba(255,255,255,0.3);
                border: none;
                color: white;
                padding: 0.8rem;
                border-radius: 50%;
                cursor: pointer;
                font-size: 1.1rem;
              "
            >
              🔊
            </button>
            
            <div id="flashcard-content">
              <div id="flashcard-thai" style="font-size: 3rem; font-weight: bold; margin-bottom: 1rem;">สวัสดี</div>
              <div id="flashcard-phonetic" style="font-size: 1.2rem; font-style: italic; margin-bottom: 1rem;">sà-wàt-dii</div>
              <div id="flashcard-hint" style="font-size: 0.9rem; opacity: 0.8;">Click to see meaning</div>
              <div id="flashcard-answer" style="font-size: 2rem; font-weight: bold; display: none;">Hello/Goodbye</div>
            </div>
          </div>
        </div>
                <div
                  style="
                    position: absolute;
                    bottom: 1rem;
                    left: 50%;
                    transform: translateX(-50%);
                    z-index: 3;
                  "
                >
                  <small
                    style="
                      color: var(--text-muted);
                      display: flex;
                      align-items: center;
                      gap: 0.5rem;
                      background: rgba(255, 255, 255, 0.8);
                      padding: 0.5rem 1rem;
                      border-radius: 20px;
                      backdrop-filter: blur(5px);
                    "
                  >
                    <i class="fas fa-undo"></i> Click to flip back
                    <span style="margin: 0 0.5rem">•</span>
                    <i class="fas fa-keyboard"></i> Press Space
                  </small>
                </div>
              </div>
            </div>
          </div>

          <div class="action-buttons">
            <button
              class="btn btn-danger btn-sm"
              onclick="markCard(false)"
              title="Difficult - Show again soon (Press 1)"
            >
              <i class="fas fa-times"></i> Hard
              <small style="display: block; font-size: 0.7rem; opacity: 0.8"
                >Key: 1</small
              >
            </button>
            <button
              class="btn btn-warning btn-sm"
              onclick="markCard('medium')"
              title="Good - Show again in a few days (Press 2)"
            >
              <i class="fas fa-minus"></i> Good
              <small style="display: block; font-size: 0.7rem; opacity: 0.8"
                >Key: 2</small
              >
            </button>
            <button
              class="btn btn-success btn-sm"
              onclick="markCard(true)"
              title="Easy - Show again later (Press 3)"
            >
              <i class="fas fa-check"></i> Easy
              <small style="display: block; font-size: 0.7rem; opacity: 0.8"
                >Key: 3</small
              >
            </button>
          </div>

          <!-- Enhanced Keyboard Shortcuts -->
          <div
            style="
              margin-top: 2rem;
              padding: 1rem;
              background: rgba(102, 126, 234, 0.05);
              border-radius: var(--border-radius);
              border: 1px solid rgba(102, 126, 234, 0.1);
            "
          >
            <div style="text-align: center; margin-bottom: 1rem">
              <h4
                style="
                  color: var(--primary);
                  margin-bottom: 0.5rem;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  gap: 0.5rem;
                "
              >
                <i class="fas fa-keyboard"></i> Keyboard Shortcuts
              </h4>
            </div>
            <div
              style="
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                gap: 0.5rem;
                font-size: 0.9rem;
              "
            >
              <div
                style="
                  display: flex;
                  align-items: center;
                  gap: 0.5rem;
                  color: var(--text-secondary);
                "
              >
                <kbd
                  style="
                    background: var(--primary-light);
                    padding: 0.2rem 0.5rem;
                    border-radius: 4px;
                    color: var(--primary);
                    font-weight: bold;
                  "
                  >Space</kbd
                >
                <span>Flip card</span>
              </div>
              <div
                style="
                  display: flex;
                  align-items: center;
                  gap: 0.5rem;
                  color: var(--text-secondary);
                "
              >
                <kbd
                  style="
                    background: var(--danger);
                    color: white;
                    padding: 0.2rem 0.5rem;
                    border-radius: 4px;
                    font-weight: bold;
                  "
                  >1</kbd
                >
                <span>Mark Hard</span>
              </div>
              <div
                style="
                  display: flex;
                  align-items: center;
                  gap: 0.5rem;
                  color: var(--text-secondary);
                "
              >
                <kbd
                  style="
                    background: var(--warning);
                    color: white;
                    padding: 0.2rem 0.5rem;
                    border-radius: 4px;
                    font-weight: bold;
                  "
                  >2</kbd
                >
                <span>Mark Good</span>
              </div>
              <div
                style="
                  display: flex;
                  align-items: center;
                  gap: 0.5rem;
                  color: var(--text-secondary);
                "
              >
                <kbd
                  style="
                    background: var(--success);
                    color: white;
                    padding: 0.2rem 0.5rem;
                    border-radius: 4px;
                    font-weight: bold;
                  "
                  >3</kbd
                >
                <span>Mark Easy</span>
              </div>
              <div
                style="
                  display: flex;
                  align-items: center;
                  gap: 0.5rem;
                  color: var(--text-secondary);
                "
              >
                <kbd
                  style="
                    background: var(--primary-light);
                    padding: 0.2rem 0.5rem;
                    border-radius: 4px;
                    color: var(--primary);
                    font-weight: bold;
                  "
                  >→</kbd
                >
                <span>Next card</span>
              </div>
              <div
                style="
                  display: flex;
                  align-items: center;
                  gap: 0.5rem;
                  color: var(--text-secondary);
                "
              >
                <kbd
                  style="
                    background: var(--primary-light);
                    padding: 0.2rem 0.5rem;
                    border-radius: 4px;
                    color: var(--primary);
                    font-weight: bold;
                  "
                  >P</kbd
                >
                <span>Play audio</span>
              </div>
              <div
                style="
                  display: flex;
                  align-items: center;
                  gap: 0.5rem;
                  color: var(--text-secondary);
                "
              >
                <kbd
                  style="
                    background: var(--primary-light);
                    padding: 0.2rem 0.5rem;
                    border-radius: 4px;
                    color: var(--primary);
                    font-weight: bold;
                  "
                  >S</kbd
                >
                <span>Settings</span>
              </div>
              <div
                style="
                  display: flex;
                  align-items: center;
                  gap: 0.5rem;
                  color: var(--text-secondary);
                "
              >
                <kbd
                  style="
                    background: var(--text-muted);
                    color: white;
                    padding: 0.2rem 0.5rem;
                    border-radius: 4px;
                    font-weight: bold;
                  "
                  >Esc</kbd
                >
                <span>Close settings</span>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Quiz Mode -->
      <section id="quiz-mode" class="quiz-mode">
        <div class="quiz-header">
          <h2><i class="fas fa-brain"></i> Thai Vocabulary Quiz</h2>
          <div class="quiz-progress">
            Question <span id="quiz-current">1</span> of
            <span id="quiz-total">5</span>
          </div>
        </div>

        <div class="quiz-question">
          <div class="question" id="quiz-question">
            What does this word mean?
          </div>
          <div class="thai-text" id="quiz-thai">สวัสดี</div>
          <div class="phonetic" id="quiz-phonetic">sà-wàt-dii</div>
        </div>

        <div class="quiz-options" id="quiz-options">
          <!-- Options will be generated dynamically -->
        </div>

        <div class="action-buttons">
          <button
            class="btn btn-primary"
            id="quiz-submit"
            onclick="submitQuizAnswer()"
          >
            <i class="fas fa-check"></i> Submit Answer
          </button>
          <button
            class="btn btn-primary"
            id="quiz-next"
            onclick="nextQuizQuestion()"
            style="display: none"
          >
            <i class="fas fa-arrow-right"></i> Next Question
          </button>
        </div>
      </section>

      <!-- Writing Practice Mode -->
      <section id="writing-mode" class="quiz-mode" style="display: none;">
        <div class="quiz-header">
          <h2><i class="fas fa-pen"></i> Thai Writing Practice</h2>
          <div class="quiz-progress">
            Exercise <span id="writing-current">1</span> of
            <span id="writing-total">10</span>
          </div>
        </div>

        <div style="background: linear-gradient(135deg, #ffffff 0%, #f8f9ff 100%); border-radius: var(--border-radius); padding: 2rem; margin-bottom: 2rem; border: 2px solid rgba(102, 126, 234, 0.1);">
          <div style="text-align: center; margin-bottom: 2rem;">
            <h3 style="color: var(--primary); margin-bottom: 1rem;">Write the Thai Script</h3>
            <div style="background: var(--primary-light); padding: 1.5rem; border-radius: var(--border-radius); margin-bottom: 1rem;">
              <div style="font-size: 1.3rem; color: var(--text-primary); margin-bottom: 0.5rem;" id="writing-english">Hello</div>
              <div style="font-size: 1rem; color: var(--text-secondary); font-style: italic;" id="writing-phonetic">sà-wàt-dii</div>
            </div>
          </div>

          <div style="text-align: center; margin-bottom: 2rem;">
            <canvas id="writing-canvas" width="600" height="200" style="border: 2px solid var(--border-color); border-radius: var(--border-radius); background: white; cursor: crosshair; max-width: 100%;"></canvas>
            <div style="margin-top: 1rem; display: flex; justify-content: center; gap: 1rem; flex-wrap: wrap;">
              <button class="btn btn-warning btn-sm" onclick="clearCanvas()">
                <i class="fas fa-eraser"></i> Clear
              </button>
              <button class="btn btn-info btn-sm" onclick="showWritingHint()">
                <i class="fas fa-lightbulb"></i> Show Answer
              </button>
              <button class="btn btn-success btn-sm" onclick="nextWritingExercise()">
                <i class="fas fa-check"></i> Check & Next
              </button>
            </div>
          </div>

          <div id="writing-hint" style="display: none; text-align: center; padding: 1rem; background: var(--success-light); border-radius: var(--border-radius); border: 1px solid rgba(16, 185, 129, 0.2);">
            <div style="font-size: 2.5rem; color: var(--success); margin-bottom: 0.5rem;" id="writing-answer">สวัสดี</div>
            <small style="color: var(--text-secondary);">Practice writing this Thai script above</small>
          </div>
        </div>

        <div style="background: rgba(102, 126, 234, 0.05); padding: 1.5rem; border-radius: var(--border-radius); margin-bottom: 2rem;">
          <h4 style="color: var(--primary); margin-bottom: 1rem; text-align: center;">
            <i class="fas fa-info-circle"></i> Thai Writing Tips
          </h4>
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
            <div style="background: white; padding: 1rem; border-radius: var(--border-radius); box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
              <strong style="color: var(--primary);">📝 Stroke Order:</strong>
              <p style="margin-top: 0.5rem; font-size: 0.9rem; color: var(--text-secondary);">Thai letters have specific stroke orders. Start from top-left and move clockwise.</p>
            </div>
            <div style="background: white; padding: 1rem; border-radius: var(--border-radius); box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
              <strong style="color: var(--secondary);">🔄 Continuous Practice:</strong>
              <p style="margin-top: 0.5rem; font-size: 0.9rem; color: var(--text-secondary);">Regular writing practice helps with muscle memory and character recognition.</p>
            </div>
            <div style="background: white; padding: 1rem; border-radius: var(--border-radius); box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
              <strong style="color: var(--accent);">👁️ Visual Learning:</strong>
              <p style="margin-top: 0.5rem; font-size: 0.9rem; color: var(--text-secondary);">Compare your writing with the correct form to improve accuracy.</p>
            </div>
          </div>
        </div>
      </section>

      <!-- Conversation Practice Mode -->
      <section id="conversation-mode" class="quiz-mode" style="display: none;">
        <div class="quiz-header">
          <h2><i class="fas fa-comments"></i> Thai Conversation Practice</h2>
          <div class="quiz-progress">
            Scenario <span id="conversation-current">1</span> of
            <span id="conversation-total">5</span>
          </div>
        </div>

        <div style="background: linear-gradient(135deg, #ffffff 0%, #f8f9ff 100%); border-radius: var(--border-radius); padding: 2rem; margin-bottom: 2rem; border: 2px solid rgba(102, 126, 234, 0.1);">
          <div id="conversation-scenario" style="text-align: center; margin-bottom: 2rem;">
            <h3 style="color: var(--primary); margin-bottom: 1rem;">🏪 At the Market</h3>
            <p style="color: var(--text-secondary); font-size: 1.1rem; line-height: 1.6;">You want to buy some fruit at a local Thai market. Practice this conversation:</p>
          </div>

          <div id="conversation-dialogue" style="background: white; border-radius: var(--border-radius); padding: 2rem; margin-bottom: 2rem; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
            <div class="conversation-line" style="margin-bottom: 1.5rem; display: flex; align-items: center; gap: 1rem;">
              <div style="width: 40px; height: 40px; background: var(--primary); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                <i class="fas fa-user"></i>
              </div>
              <div style="flex: 1;">
                <div style="background: var(--primary-light); padding: 1rem; border-radius: var(--border-radius); margin-bottom: 0.5rem;">
                  <div style="font-size: 1.3rem; color: var(--primary); margin-bottom: 0.5rem;">ส้มราคาเท่าไหร่ครับ?</div>
                  <div style="font-style: italic; color: var(--text-secondary);">sôm raa-kaa tâo-rài kráp?</div>
                </div>
                <small style="color: var(--text-muted);">How much are the oranges?</small>
                <button onclick="speakThai('ส้มราคาเท่าไหร่ครับ')" style="margin-left: 1rem; background: none; border: none; color: var(--primary); cursor: pointer; font-size: 1.1rem;">
                  <i class="fas fa-volume-up"></i>
                </button>
              </div>
            </div>

            <div class="conversation-line" style="margin-bottom: 1.5rem; display: flex; align-items: center; gap: 1rem; flex-direction: row-reverse;">
              <div style="width: 40px; height: 40px; background: var(--secondary); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                <i class="fas fa-store"></i>
              </div>
              <div style="flex: 1; text-align: right;">
                <div style="background: var(--secondary-light); padding: 1rem; border-radius: var(--border-radius); margin-bottom: 0.5rem;">
                  <div style="font-size: 1.3rem; color: var(--secondary); margin-bottom: 0.5rem;">ใบละสิบบาทค่ะ</div>
                  <div style="font-style: italic; color: var(--text-secondary);">bai lá sìp baat kâ</div>
                </div>
                <small style="color: var(--text-muted);">Ten baht each.</small>
                <button onclick="speakThai('ใบละสิบบาทค่ะ')" style="margin-right: 1rem; background: none; border: none; color: var(--secondary); cursor: pointer; font-size: 1.1rem;">
                  <i class="fas fa-volume-up"></i>
                </button>
              </div>
            </div>
          </div>

          <div style="text-align: center; margin-bottom: 2rem;">
            <h4 style="color: var(--primary); margin-bottom: 1rem;">Your Response:</h4>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
              <button class="conversation-option" onclick="selectConversationOption(this, true)" style="padding: 1rem; background: white; border: 2px solid var(--border-color); border-radius: var(--border-radius); cursor: pointer; transition: all 0.3s ease;">
                <div style="font-size: 1.2rem; color: var(--primary); margin-bottom: 0.5rem;">เอาสามใบครับ</div>
                <div style="font-style: italic; color: var(--text-secondary); margin-bottom: 0.5rem;">ao sǎam bai kráp</div>
                <small style="color: var(--text-muted);">I'll take three.</small>
              </button>
              <button class="conversation-option" onclick="selectConversationOption(this, false)" style="padding: 1rem; background: white; border: 2px solid var(--border-color); border-radius: var(--border-radius); cursor: pointer; transition: all 0.3s ease;">
                <div style="font-size: 1.2rem; color: var(--primary); margin-bottom: 0.5rem;">แพงเกินไปครับ</div>
                <div style="font-style: italic; color: var(--text-secondary); margin-bottom: 0.5rem;">paeng gəən bpai kráp</div>
                <small style="color: var(--text-muted);">Too expensive.</small>
              </button>
            </div>
          </div>

          <div class="action-buttons">
            <button class="btn btn-info btn-sm" onclick="showConversationHint()">
              <i class="fas fa-lightbulb"></i> Cultural Tip
            </button>
            <button class="btn btn-primary" onclick="nextConversationScenario()">
              <i class="fas fa-arrow-right"></i> Next Scenario
            </button>
          </div>
        </div>

        <div id="conversation-hint" style="display: none; background: var(--info-light); padding: 1.5rem; border-radius: var(--border-radius); border: 1px solid rgba(59, 130, 246, 0.2); margin-top: 1rem;">
          <h4 style="color: var(--info); margin-bottom: 1rem;">
            <i class="fas fa-info-circle"></i> Cultural Context
          </h4>
          <p style="color: var(--text-secondary); line-height: 1.6;">
            In Thai markets, bargaining is common and expected. Vendors often start with higher prices, and polite negotiation is part of the cultural experience. Using "ครับ/ค่ะ" shows respect and often leads to better prices!
          </p>
        </div>
      </section>

      <!-- Thai Grammar Guide Section -->
      <section
        id="grammar-guide"
        style="
          margin-top: 3rem;
          padding: 2rem;
          background: linear-gradient(135deg, #ffffff 0%, #f8f9ff 100%);
          border-radius: var(--border-radius);
          box-shadow: var(--box-shadow);
        "
      >
        <h2
          style="
            color: var(--primary);
            text-align: center;
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
          "
        >
          <i class="fas fa-book"></i>
          Essential Thai Grammar
        </h2>

        <div
          style="
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
          "
        >
          <div
            style="
              padding: 1.5rem;
              background: var(--primary-light);
              border-radius: var(--border-radius);
              border-left: 4px solid var(--primary);
            "
          >
            <h3
              style="
                color: var(--primary);
                margin-bottom: 1rem;
                display: flex;
                align-items: center;
                gap: 0.5rem;
              "
            >
              <i class="fas fa-sort-alpha-down"></i>
              Word Order
            </h3>
            <p
              style="
                color: var(--text-secondary);
                line-height: 1.6;
                margin-bottom: 1rem;
              "
            >
              Thai follows <strong>Subject-Verb-Object</strong> order, similar to English.
            </p>
            <div style="background: white; padding: 1rem; border-radius: var(--border-radius); margin-bottom: 1rem;">
              <div style="color: var(--primary); font-weight: bold; margin-bottom: 0.5rem;">Example:</div>
              <div style="font-size: 1.2rem; color: var(--text-primary); margin-bottom: 0.3rem;">ฉัน กิน ข้าว</div>
              <div style="font-style: italic; color: var(--text-secondary); margin-bottom: 0.3rem;">chǎn gin kâao</div>
              <div style="color: var(--text-muted); font-size: 0.9rem;">I eat rice</div>
            </div>
            <ul
              style="
                color: var(--text-secondary);
                line-height: 1.6;
                margin-left: 1rem;
              "
            >
              <li><strong>ฉัน (chǎn)</strong> - Subject (I)</li>
              <li><strong>กิน (gin)</strong> - Verb (eat)</li>
              <li><strong>ข้าว (kâao)</strong> - Object (rice)</li>
            </ul>
          </div>

          <div
            style="
              padding: 1.5rem;
              background: var(--secondary-light);
              border-radius: var(--border-radius);
              border-left: 4px solid var(--secondary);
            "
          >
            <h3
              style="
                color: var(--secondary);
                margin-bottom: 1rem;
                display: flex;
                align-items: center;
                gap: 0.5rem;
              "
            >
              <i class="fas fa-clock"></i>
              Tenses
            </h3>
            <p
              style="
                color: var(--text-secondary);
                line-height: 1.6;
                margin-bottom: 1rem;
              "
            >
              Thai verbs don't change form! Time is shown with time markers.
            </p>
            <div style="display: grid; gap: 0.5rem;">
              <div style="background: white; padding: 0.8rem; border-radius: var(--border-radius);">
                <strong style="color: var(--text-primary);">Past:</strong> 
                <span style="color: var(--secondary);">แล้ว (láew)</span>
                <div style="font-size: 0.9rem; color: var(--text-muted); margin-top: 0.3rem;">กินแล้ว (gin láew) - already ate</div>
              </div>
              <div style="background: white; padding: 0.8rem; border-radius: var(--border-radius);">
                <strong style="color: var(--text-primary);">Present:</strong> 
                <span style="color: var(--secondary);">กำลัง (gam-laŋ)</span>
                <div style="font-size: 0.9rem; color: var(--text-muted); margin-top: 0.3rem;">กำลังกิน (gam-laŋ gin) - eating now</div>
              </div>
              <div style="background: white; padding: 0.8rem; border-radius: var(--border-radius);">
                <strong style="color: var(--text-primary);">Future:</strong> 
                <span style="color: var(--secondary);">จะ (jà)</span>
                <div style="font-size: 0.9rem; color: var(--text-muted); margin-top: 0.3rem;">จะกิน (jà gin) - will eat</div>
              </div>
            </div>
          </div>

          <div
            style="
              padding: 1.5rem;
              background: var(--accent-light);
              border-radius: var(--border-radius);
              border-left: 4px solid var(--accent);
            "
          >
            <h3
              style="
                color: var(--accent-dark);
                margin-bottom: 1rem;
                display: flex;
                align-items: center;
                gap: 0.5rem;
              "
            >
              <i class="fas fa-question"></i>
              Questions
            </h3>
            <p
              style="
                color: var(--text-secondary);
                line-height: 1.6;
                margin-bottom: 1rem;
              "
            >
              Form questions by adding question words or particles.
            </p>
            <div style="display: grid; gap: 0.5rem;">
              <div style="background: white; padding: 0.8rem; border-radius: var(--border-radius);">
                <strong style="color: var(--text-primary);">Yes/No:</strong> 
                <span style="color: var(--accent);">...ไหม (mái)</span>
                <div style="font-size: 0.9rem; color: var(--text-muted); margin-top: 0.3rem;">กินไหม (gin mái) - Do you eat?</div>
              </div>
              <div style="background: white; padding: 0.8rem; border-radius: var(--border-radius);">
                <strong style="color: var(--text-primary);">What:</strong> 
                <span style="color: var(--accent);">อะไร (à-rai)</span>
                <div style="font-size: 0.9rem; color: var(--text-muted); margin-top: 0.3rem;">กินอะไร (gin à-rai) - What do you eat?</div>
              </div>
              <div style="background: white; padding: 0.8rem; border-radius: var(--border-radius);">
                <strong style="color: var(--text-primary);">Where:</strong> 
                <span style="color: var(--accent);">ที่ไหน (tîi-nǎi)</span>
                <div style="font-size: 0.9rem; color: var(--text-muted); margin-top: 0.3rem;">กินที่ไหน (gin tîi-nǎi) - Where do you eat?</div>
              </div>
            </div>
          </div>

          <div
            style="
              padding: 1.5rem;
              background: var(--info-light);
              border-radius: var(--border-radius);
              border-left: 4px solid var(--info);
            "
          >
            <h3
              style="
                color: var(--info);
                margin-bottom: 1rem;
                display: flex;
                align-items: center;
                gap: 0.5rem;
              "
            >
              <i class="fas fa-users"></i>
              Classifiers
            </h3>
            <p
              style="
                color: var(--text-secondary);
                line-height: 1.6;
                margin-bottom: 1rem;
              "
            >
              Thai uses classifiers when counting. Pattern: <strong>Number + Classifier + Noun</strong>
            </p>
            <div style="display: grid; gap: 0.5rem;">
              <div style="background: white; padding: 0.8rem; border-radius: var(--border-radius);">
                <strong style="color: var(--text-primary);">People:</strong> 
                <span style="color: var(--info);">คน (kon)</span>
                <div style="font-size: 0.9rem; color: var(--text-muted); margin-top: 0.3rem;">สามคน (sǎam kon) - 3 people</div>
              </div>
              <div style="background: white; padding: 0.8rem; border-radius: var(--border-radius);">
                <strong style="color: var(--text-primary);">Animals:</strong> 
                <span style="color: var(--info);">ตัว (tua)</span>
                <div style="font-size: 0.9rem; color: var(--text-muted); margin-top: 0.3rem;">สองตัว (sɔ̌ɔŋ tua) - 2 animals</div>
              </div>
              <div style="background: white; padding: 0.8rem; border-radius: var(--border-radius);">
                <strong style="color: var(--text-primary);">Objects:</strong> 
                <span style="color: var(--info);">อัน (an)</span>
                <div style="font-size: 0.9rem; color: var(--text-muted); margin-top: 0.3rem;">หนึ่งอัน (nɯ̀ŋ an) - 1 thing</div>
              </div>
            </div>
          </div>
        </div>

        <div
          style="
            background: rgba(102, 126, 234, 0.05);
            padding: 2rem;
            border-radius: var(--border-radius);
            text-align: center;
          "
        >
          <h3 style="color: var(--primary); margin-bottom: 1.5rem;">
            <i class="fas fa-lightbulb"></i> Grammar Practice Tips
          </h3>
          <div
            style="
              display: grid;
              grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
              gap: 1rem;
            "
          >
            <div
              style="
                background: white;
                padding: 1.5rem;
                border-radius: var(--border-radius);
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
              "
            >
              <div style="font-size: 2rem; margin-bottom: 0.5rem;">📚</div>
              <strong style="color: var(--primary);">Start Simple</strong>
              <p
                style="
                  color: var(--text-secondary);
                  margin-top: 0.5rem;
                  font-size: 0.9rem;
                "
              >
                Begin with basic Subject-Verb-Object sentences
              </p>
            </div>
            <div
              style="
                background: white;
                padding: 1.5rem;
                border-radius: var(--border-radius);
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
              "
            >
              <div style="font-size: 2rem; margin-bottom: 0.5rem;">🎯</div>
              <strong style="color: var(--secondary);">Focus on Context</strong>
              <p
                style="
                  color: var(--text-secondary);
                  margin-top: 0.5rem;
                  font-size: 0.9rem;
                "
              >
                Thai grammar is heavily context-dependent
              </p>
            </div>
            <div
              style="
                background: white;
                padding: 1.5rem;
                border-radius: var(--border-radius);
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
              "
            >
              <div style="font-size: 2rem; margin-bottom: 0.5rem;">🔄</div>
              <strong style="color: var(--accent);">Practice Patterns</strong>
              <p
                style="
                  color: var(--text-secondary);
                  margin-top: 0.5rem;
                  font-size: 0.9rem;
                "
              >
                Repeat sentence patterns with different vocabulary
              </p>
            </div>
            <div
              style="
                background: white;
                padding: 1.5rem;
                border-radius: var(--border-radius);
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
              "
            >
              <div style="font-size: 2rem; margin-bottom: 0.5rem;">💬</div>
              <strong style="color: var(--success);">Use in Context</strong>
              <p
                style="
                  color: var(--text-secondary);
                  margin-top: 0.5rem;
                  font-size: 0.9rem;
                "
              >
                Apply grammar rules in real conversations
              </p>
            </div>
          </div>
        </div>
      </section>

      <!-- Vocabulary Categories Section -->
      <section
        id="vocabulary-categories"
        style="
          margin-top: 3rem;
          padding: 2rem;
          background: linear-gradient(135deg, #ffffff 0%, #f8f9ff 100%);
          border-radius: var(--border-radius);
          box-shadow: var(--box-shadow);
        "
      >
        <h2
          style="
            color: var(--primary);
            text-align: center;
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
          "
        >
          <i class="fas fa-tags"></i>
          Vocabulary by Category
        </h2>

        <div
          style="
            display: flex;
            justify-content: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            gap: 0.5rem;
          "
        >
          <button class="category-filter active" onclick="filterVocabulary('all')" style="padding: 0.6rem 1.2rem; border: 2px solid var(--primary); background: var(--primary); color: white; border-radius: 25px; cursor: pointer; transition: all 0.3s ease; font-weight: 600;">
            All Categories
          </button>
          <button class="category-filter" onclick="filterVocabulary('greetings')" style="padding: 0.6rem 1.2rem; border: 2px solid var(--primary); background: transparent; color: var(--primary); border-radius: 25px; cursor: pointer; transition: all 0.3s ease; font-weight: 600;">
            Greetings
          </button>
          <button class="category-filter" onclick="filterVocabulary('food')" style="padding: 0.6rem 1.2rem; border: 2px solid var(--secondary); background: transparent; color: var(--secondary); border-radius: 25px; cursor: pointer; transition: all 0.3s ease; font-weight: 600;">
            Food
          </button>
          <button class="category-filter" onclick="filterVocabulary('family')" style="padding: 0.6rem 1.2rem; border: 2px solid var(--accent); background: transparent; color: var(--accent); border-radius: 25px; cursor: pointer; transition: all 0.3s ease; font-weight: 600;">
            Family
          </button>
          <button class="category-filter" onclick="filterVocabulary('colors')" style="padding: 0.6rem 1.2rem; border: 2px solid var(--success); background: transparent; color: var(--success); border-radius: 25px; cursor: pointer; transition: all 0.3s ease; font-weight: 600;">
            Colors
          </button>
          <button class="category-filter" onclick="filterVocabulary('numbers')" style="padding: 0.6rem 1.2rem; border: 2px solid var(--info); background: transparent; color: var(--info); border-radius: 25px; cursor: pointer; transition: all 0.3s ease; font-weight: 600;">
            Numbers
          </button>
        </div>

        <div id="vocabulary-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1rem;">
          <!-- Vocabulary cards will be populated by JavaScript -->
        </div>

        <div style="text-align: center; margin-top: 2rem;">
          <button class="btn btn-primary" onclick="studyCategoryFlashcards()" id="study-category-btn">
            <i class="fas fa-play"></i> Study Selected Category
          </button>
        </div>
      </section>

      <!-- Cultural Context Section -->
      <section
        id="cultural-context"
        style="
          margin-top: 3rem;
          padding: 2rem;
          background: linear-gradient(135deg, #ffffff 0%, #f8f9ff 100%);
          border-radius: var(--border-radius);
          box-shadow: var(--box-shadow);
        "
      >
        <h2
          style="
            color: var(--primary);
            text-align: center;
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
          "
        >
          <i class="fas fa-temple"></i>
          Thai Culture & Language Tips
        </h2>

        <div
          style="
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
          "
        >
          <div
            style="
              padding: 1.5rem;
              background: var(--primary-light);
              border-radius: var(--border-radius);
              border-left: 4px solid var(--primary);
            "
          >
            <h3
              style="
                color: var(--primary);
                margin-bottom: 1rem;
                display: flex;
                align-items: center;
                gap: 0.5rem;
              "
            >
              <i class="fas fa-hands"></i>
              Thai Greetings (การไหว้)
            </h3>
            <p
              style="
                color: var(--text-secondary);
                line-height: 1.6;
                margin-bottom: 1rem;
              "
            >
              The traditional Thai greeting involves pressing your palms
              together and bowing slightly. The higher you hold your hands, the
              more respect you show.
            </p>
            <ul
              style="
                color: var(--text-secondary);
                line-height: 1.6;
                margin-left: 1rem;
              "
            >
              <li>
                <strong>สวัสดี (sà-wàt-dii)</strong> - Used for both hello and
                goodbye
              </li>
              <li>
                <strong>สวัสดีครับ/ค่ะ</strong> - Polite form (ครับ for men, ค่ะ
                for women)
              </li>
              <li>
                <strong>หวัดดี (wàt-dii)</strong> - Casual form among friends
              </li>
            </ul>
          </div>

          <div
            style="
              padding: 1.5rem;
              background: var(--secondary-light);
              border-radius: var(--border-radius);
              border-left: 4px solid var(--secondary);
            "
          >
            <h3
              style="
                color: var(--secondary);
                margin-bottom: 1rem;
                display: flex;
                align-items: center;
                gap: 0.5rem;
              "
            >
              <i class="fas fa-utensils"></i>
              Food Culture
            </h3>
            <p
              style="
                color: var(--text-secondary);
                line-height: 1.6;
                margin-bottom: 1rem;
              "
            >
              Thai cuisine is known for its balance of sweet, sour, salty, and
              spicy flavors. Rice is a staple food.
            </p>
            <ul
              style="
                color: var(--text-secondary);
                line-height: 1.6;
                margin-left: 1rem;
              "
            >
              <li>
                <strong>ข้าว (kâao)</strong> - Can mean both rice and food in
                general
              </li>
              <li>
                <strong>กินข้าวแล้วหรือยัง?</strong> - "Have you eaten?" (common
                greeting)
              </li>
              <li>
                <strong>อร่อย (à-ròoi)</strong> - Delicious (important
                compliment!)
              </li>
            </ul>
          </div>

          <div
            style="
              padding: 1.5rem;
              background: var(--accent-light);
              border-radius: var(--border-radius);
              border-left: 4px solid var(--accent);
            "
          >
            <h3
              style="
                color: var(--accent-dark);
                margin-bottom: 1rem;
                display: flex;
                align-items: center;
                gap: 0.5rem;
              "
            >
              <i class="fas fa-volume-up"></i>
              Tone Tips
            </h3>
            <p
              style="
                color: var(--text-secondary);
                line-height: 1.6;
                margin-bottom: 1rem;
              "
            >
              Thai has 5 tones that change word meanings. Listen carefully to
              the audio pronunciation!
            </p>
            <ul
              style="
                color: var(--text-secondary);
                line-height: 1.6;
                margin-left: 1rem;
              "
            >
              <li><strong>Mid tone:</strong> Neutral (maa = come)</li>
              <li><strong>Low tone:</strong> Down then up (mâa = dog)</li>
              <li><strong>Falling tone:</strong> High to low (mâa = horse)</li>
              <li><strong>High tone:</strong> Higher pitch (máa = new)</li>
              <li><strong>Rising tone:</strong> Low to high (mǎa = hand)</li>
            </ul>
          </div>

          <div
            style="
              padding: 1.5rem;
              background: var(--info-light);
              border-radius: var(--border-radius);
              border-left: 4px solid var(--info);
            "
          >
            <h3
              style="
                color: var(--info);
                margin-bottom: 1rem;
                display: flex;
                align-items: center;
                gap: 0.5rem;
              "
            >
              <i class="fas fa-crown"></i>
              Politeness Levels
            </h3>
            <p
              style="
                color: var(--text-secondary);
                line-height: 1.6;
                margin-bottom: 1rem;
              "
            >
              Thai has different levels of politeness. Always use polite
              particles when speaking to strangers or elders.
            </p>
            <ul
              style="
                color: var(--text-secondary);
                line-height: 1.6;
                margin-left: 1rem;
              "
            >
              <li><strong>ครับ (kráp)</strong> - Polite particle for males</li>
              <li>
                <strong>ค่ะ/คะ (kâ/ká)</strong> - Polite particle for females
              </li>
              <li>
                <strong>เจ้า, มึง, กู</strong> - Informal (use only with close
                friends)
              </li>
            </ul>
          </div>
        </div>

        <!-- Interactive Cultural Learning -->
        <div
          style="
            background: rgba(102, 126, 234, 0.05);
            padding: 2rem;
            border-radius: var(--border-radius);
            margin-top: 2rem;
          "
        >
          <h3 style="color: var(--primary); text-align: center; margin-bottom: 2rem;">
            <i class="fas fa-gamepad"></i> Interactive Cultural Quiz
          </h3>
          
          <div id="cultural-quiz" style="text-align: center;">
            <div style="background: white; padding: 2rem; border-radius: var(--border-radius); margin-bottom: 2rem; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">
              <h4 style="color: var(--primary); margin-bottom: 1rem;" id="cultural-question">
                What should you do when entering a Thai temple?
              </h4>
              <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 1.5rem;">
                <button class="cultural-option" onclick="selectCulturalAnswer(this, false)" style="padding: 1rem; background: var(--bg-secondary); border: 2px solid var(--border-color); border-radius: var(--border-radius); cursor: pointer; transition: all 0.3s ease;">
                  Keep your shoes on
                </button>
                <button class="cultural-option" onclick="selectCulturalAnswer(this, true)" style="padding: 1rem; background: var(--bg-secondary); border: 2px solid var(--border-color); border-radius: var(--border-radius); cursor: pointer; transition: all 0.3s ease;">
                  Remove your shoes
                </button>
                <button class="cultural-option" onclick="selectCulturalAnswer(this, false)" style="padding: 1rem; background: var(--bg-secondary); border: 2px solid var(--border-color); border-radius: var(--border-radius); cursor: pointer; transition: all 0.3s ease;">
                  Wear a hat
                </button>
                <button class="cultural-option" onclick="selectCulturalAnswer(this, false)" style="padding: 1rem; background: var(--bg-secondary); border: 2px solid var(--border-color); border-radius: var(--border-radius); cursor: pointer; transition: all 0.3s ease;">
                  Speak loudly
                </button>
              </div>
              <button class="btn btn-primary btn-sm" onclick="nextCulturalQuestion()" id="cultural-next" style="display: none;">
                <i class="fas fa-arrow-right"></i> Next Question
              </button>
            </div>
            
            <div id="cultural-explanation" style="background: var(--success-light); padding: 1.5rem; border-radius: var(--border-radius); border: 1px solid rgba(16, 185, 129, 0.2); display: none;">
              <h4 style="color: var(--success); margin-bottom: 1rem;">
                <i class="fas fa-check-circle"></i> Explanation
              </h4>
              <p style="color: var(--text-secondary); line-height: 1.6;" id="cultural-explanation-text">
                In Thai culture, shoes are considered unclean and must be removed before entering temples, homes, and some shops. This shows respect for sacred spaces.
              </p>
            </div>
          </div>
        </div>

        <div
          style="
            text-align: center;
            margin-top: 2rem;
            padding: 1.5rem;
            background: rgba(102, 126, 234, 0.05);
            border-radius: var(--border-radius);
          "
        >
          <h4 style="color: var(--primary); margin-bottom: 1rem">
            🎌 Study Tips for Success
          </h4>
          <div
            style="
              display: grid;
              grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
              gap: 1rem;
              text-align: left;
            "
          >
            <div
              style="
                padding: 1rem;
                background: white;
                border-radius: var(--border-radius);
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
              "
            >
              <strong style="color: var(--primary)">🎧 Listen Daily:</strong>
              <p
                style="
                  color: var(--text-secondary);
                  margin-top: 0.5rem;
                  font-size: 0.9rem;
                "
              >
                Practice with audio every day to master the tones
              </p>
            </div>
            <div
              style="
                padding: 1rem;
                background: white;
                border-radius: var(--border-radius);
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
              "
            >
              <strong style="color: var(--secondary)"
                >📝 Write Practice:</strong
              >
              <p
                style="
                  color: var(--text-secondary);
                  margin-top: 0.5rem;
                  font-size: 0.9rem;
                "
              >
                Practice writing Thai script alongside learning vocabulary
              </p>
            </div>
            <div
              style="
                padding: 1rem;
                background: white;
                border-radius: var(--border-radius);
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
              "
            >
              <strong style="color: var(--accent)">💬 Speak Often:</strong>
              <p
                style="
                  color: var(--text-secondary);
                  margin-top: 0.5rem;
                  font-size: 0.9rem;
                "
              >
                Find Thai speakers online or in your community to practice
              </p>
            </div>
            <div
              style="
                padding: 1rem;
                background: white;
                border-radius: var(--border-radius);
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
              "
            >
              <strong style="color: var(--success)">🎯 Set Goals:</strong>
              <p
                style="
                  color: var(--text-secondary);
                  margin-top: 0.5rem;
                  font-size: 0.9rem;
                "
              >
                Aim for 10-15 new words per day with our flashcard system
              </p>
            </div>
            <div
              style="
                padding: 1rem;
                background: white;
                border-radius: var(--border-radius);
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
              "
            >
              <strong style="color: var(--info)">🌍 Cultural Context:</strong>
              <p
                style="
                  color: var(--text-secondary);
                  margin-top: 0.5rem;
                  font-size: 0.9rem;
                "
              >
                Understanding culture helps you use language appropriately
              </p>
            </div>
            <div
              style="
                padding: 1rem;
                background: white;
                border-radius: var(--border-radius);
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
              "
            >
              <strong style="color: var(--warning)">📱 Use Technology:</strong>
              <p
                style="
                  color: var(--text-secondary);
                  margin-top: 0.5rem;
                  font-size: 0.9rem;
                "
              >
                Combine traditional learning with modern tools like this app
              </p>
            </div>
          </div>
        </div>
      </section>
    </div>

    <!-- Enhanced Settings Panel -->
    <button class="settings-toggle" onclick="toggleSettings()">
      <i class="fas fa-cog"></i>
    </button>

    <div class="settings-panel" id="settings-panel">
      <h3><i class="fas fa-sliders-h"></i> Learning Settings</h3>

      <div class="dark-mode-toggle">
        <label for="auto-advance">Auto-advance cards</label>
        <input type="checkbox" id="auto-advance" checked />
      </div>

      <div class="dark-mode-toggle">
        <label for="show-phonetics">Show phonetics</label>
        <input type="checkbox" id="show-phonetics" checked />
      </div>

      <div style="margin-top: 1rem">
        <label for="difficulty-level">Difficulty Level</label>
        <select id="difficulty-level" onchange="changeDifficulty()">
          <option value="beginner">Beginner (Basic words)</option>
          <option value="intermediate">
            Intermediate (Daily conversation)
          </option>
          <option value="advanced">Advanced (Complex concepts)</option>
        </select>
      </div>

      <div class="audio-controls">
        <h4><i class="fas fa-volume-up"></i> Audio Settings</h4>
        <div class="dark-mode-toggle">
          <label for="audio-enabled">Thai pronunciation</label>
          <input
            type="checkbox"
            id="audio-enabled"
            checked
            onchange="toggleAudio()"
          />
        </div>
        <div class="volume-control">
          <i class="fas fa-volume-down"></i>
          <input
            type="range"
            class="volume-slider"
            id="volume-slider"
            min="0"
            max="1"
            step="0.1"
            value="0.8"
            onchange="adjustVolume()"
          />
          <i class="fas fa-volume-up"></i>
        </div>
      </div>

      <div style="margin-top: 1.5rem">
        <h4><i class="fas fa-chart-line"></i> Study Analytics</h4>
        <div class="stat-card">
          <div class="stat-number" id="session-duration">0:00</div>
          <div class="stat-label">Session Time</div>
        </div>
        <div class="stat-card">
          <div class="stat-number" id="streak-record">0</div>
          <div class="stat-label">Best Streak</div>
        </div>
      </div>

      <button
        class="btn btn-warning btn-sm"
        style="margin-top: 1rem; width: 100%"
        onclick="exportProgress()"
      >
        <i class="fas fa-download"></i> Export Progress
      </button>

      <button
        class="btn btn-success btn-sm"
        style="margin-top: 1rem; width: 100%"
        onclick="shareProgress()"
      >
        <i class="fas fa-share-alt"></i> Share Progress
      </button>

      <button
        class="btn btn-info btn-sm"
        style="margin-top: 0.5rem; width: 100%"
        onclick="showAchievements()"
      >
        <i class="fas fa-trophy"></i> View Achievements
      </button>

      <button
        class="btn btn-danger btn-sm"
        style="margin-top: 0.5rem; width: 100%"
        onclick="resetProgress()"
      >
        <i class="fas fa-refresh"></i> Reset All Progress
      </button>
    </div>

    <!-- Footer matching main site -->
    <footer
      style="
        background: var(--dark);
        color: var(--text-inverse);
        padding: 3rem 0 2rem;
        margin-top: 4rem;
      "
    >
      <div class="container">
        <div
          style="
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
          "
        >
          <div>
            <h3
              style="
                color: var(--primary);
                margin-bottom: 1rem;
                display: flex;
                align-items: center;
                gap: 0.5rem;
              "
            >
              <img
                src="../images/1.png"
                alt="ESL Fun Online"
                style="width: 30px; height: 30px; border-radius: 6px"
              />
              ESL Fun Online
            </h3>
            <p
              style="
                color: var(--text-muted);
                line-height: 1.6;
                margin-bottom: 1rem;
              "
            >
              Master Thai language with our advanced spaced repetition flashcard
              system. Join thousands of learners improving their Thai vocabulary
              daily.
            </p>
            <div style="display: flex; gap: 1rem">
              <a
                href="#"
                style="
                  color: var(--primary);
                  font-size: 1.2rem;
                  transition: var(--transition);
                "
              >
                <i class="fab fa-facebook"></i>
              </a>
              <a
                href="#"
                style="
                  color: var(--primary);
                  font-size: 1.2rem;
                  transition: var(--transition);
                "
              >
                <i class="fab fa-twitter"></i>
              </a>
              <a
                href="#"
                style="
                  color: var(--primary);
                  font-size: 1.2rem;
                  transition: var(--transition);
                "
              >
                <i class="fab fa-instagram"></i>
              </a>
            </div>
          </div>

          <div>
            <h4 style="color: var(--text-inverse); margin-bottom: 1rem">
              Quick Links
            </h4>
            <ul style="list-style: none; padding: 0; margin: 0">
              <li style="margin-bottom: 0.5rem">
                <a
                  href="../index.html"
                  style="
                    color: var(--text-muted);
                    text-decoration: none;
                    transition: var(--transition);
                  "
                  >Home</a
                >
              </li>
              <li style="margin-bottom: 0.5rem">
                <a
                  href="../english/grammar.html"
                  style="
                    color: var(--text-muted);
                    text-decoration: none;
                    transition: var(--transition);
                  "
                  >Grammar Guides</a
                >
              </li>
              <li style="margin-bottom: 0.5rem">
                <a
                  href="../english/vocabguide.html"
                  style="
                    color: var(--text-muted);
                    text-decoration: none;
                    transition: var(--transition);
                  "
                  >Vocabulary Building</a
                >
              </li>
              <li style="margin-bottom: 0.5rem">
                <a
                  href="../games/games.html"
                  style="
                    color: var(--text-muted);
                    text-decoration: none;
                    transition: var(--transition);
                  "
                  >Educational Games</a
                >
              </li>
            </ul>
          </div>

          <div>
            <h4 style="color: var(--text-inverse); margin-bottom: 1rem">
              Learning Tools
            </h4>
            <ul style="list-style: none; padding: 0; margin: 0">
              <li style="margin-bottom: 0.5rem">
                <a
                  href="#"
                  onclick="switchMode('flashcards', event)"
                  style="
                    color: var(--text-muted);
                    text-decoration: none;
                    transition: var(--transition);
                  "
                  >Flashcards</a
                >
              </li>
              <li style="margin-bottom: 0.5rem">
                <a
                  href="#"
                  onclick="switchMode('quiz', event)"
                  style="
                    color: var(--text-muted);
                    text-decoration: none;
                    transition: var(--transition);
                  "
                  >Quiz Mode</a
                >
              </li>
              <li style="margin-bottom: 0.5rem">
                <a
                  href="#progress-section"
                  style="
                    color: var(--text-muted);
                    text-decoration: none;
                    transition: var(--transition);
                  "
                  >Progress Tracking</a
                >
              </li>
              <li style="margin-bottom: 0.5rem">
                <a
                  href="#"
                  onclick="toggleSettings()"
                  style="
                    color: var(--text-muted);
                    text-decoration: none;
                    transition: var(--transition);
                  "
                  >Settings</a
                >
              </li>
            </ul>
          </div>
        </div>

        <div
          style="
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding-top: 2rem;
            text-align: center;
          "
        >
          <p style="color: var(--text-muted); margin: 0">
            Made with ❤️ for Thai language learners | © 2024 ESL Fun Online |
            <a
              href="../privacy.html"
              style="color: var(--primary); text-decoration: none"
              >Privacy Policy</a
            >
            |
            <a
              href="../terms.html"
              style="color: var(--primary); text-decoration: none"
              >Terms of Service</a
            >
          </p>
          <p
            style="
              color: var(--text-muted);
              margin: 0.5rem 0 0 0;
              font-size: 0.9rem;
            "
          >
            🇹🇭 Supporting Thai language learners worldwide since 2024
          </p>
        </div>
      </div>
    </footer>

    <script>
      // Enhanced flashcard data with difficulty levels and audio
      const flashcardData = {
        beginner: [
          {
            thai: "สวัสดี",
            phonetic: "sà-wàt-dii",
            answer: "Hello/Goodbye",
            category: "greetings",
          },
          {
            thai: "ขอบคุณ",
            phonetic: "kòp-kun",
            answer: "Thank you",
            category: "greetings",
          },
          {
            thai: "ขอโทษ",
            phonetic: "kǒr-tôot",
            answer: "Sorry/Excuse me",
            category: "greetings",
          },
          {
            thai: "ไม่เป็นไร",
            phonetic: "mâi bpen rai",
            answer: "It's okay/No problem",
            category: "greetings",
          },
          { thai: "น้ำ", phonetic: "náam", answer: "Water", category: "food" },
          {
            thai: "ข้าว",
            phonetic: "kâao",
            answer: "Rice/Food",
            category: "food",
          },
          { thai: "กิน", phonetic: "gin", answer: "To eat", category: "food" },
          {
            thai: "ดื่ม",
            phonetic: "dùum",
            answer: "To drink",
            category: "food",
          },
          { thai: "ใช่", phonetic: "châi", answer: "Yes", category: "basic" },
          { thai: "ไม่", phonetic: "mâi", answer: "No", category: "basic" },
          {
            thai: "บ้าน",
            phonetic: "bâan",
            answer: "House/Home",
            category: "places",
          },
          { thai: "คน", phonetic: "kon", answer: "Person", category: "people" },
          {
            thai: "เงิน",
            phonetic: "ngən",
            answer: "Money",
            category: "basic",
          },
          {
            thai: "เวลา",
            phonetic: "wee-laa",
            answer: "Time",
            category: "basic",
          },
          {
            thai: "ดี",
            phonetic: "dii",
            answer: "Good",
            category: "adjectives",
          },
          {
            thai: "ไม่ดี",
            phonetic: "mâi dii",
            answer: "Bad/Not good",
            category: "adjectives",
          },
          {
            thai: "ใหญ่",
            phonetic: "yài",
            answer: "Big",
            category: "adjectives",
          },
          {
            thai: "เล็ก",
            phonetic: "lék",
            answer: "Small",
            category: "adjectives",
          },
          { thai: "มา", phonetic: "maa", answer: "To come", category: "verbs" },
          { thai: "ไป", phonetic: "bpai", answer: "To go", category: "verbs" },
          {
            thai: "อยู่",
            phonetic: "yùu",
            answer: "To be/stay",
            category: "verbs",
          },
          {
            thai: "ทำ",
            phonetic: "tam",
            answer: "To do/make",
            category: "verbs",
          },
          {
            thai: "ดู",
            phonetic: "duu",
            answer: "To look/watch",
            category: "verbs",
          },
          {
            thai: "พูด",
            phonetic: "pûut",
            answer: "To speak",
            category: "verbs",
          },
          {
            thai: "รัก",
            phonetic: "rák",
            answer: "To love",
            category: "emotions",
          },
          {
            thai: "ชอบ",
            phonetic: "chɔ̂ɔp",
            answer: "To like",
            category: "emotions",
          },
          {
            thai: "สุข",
            phonetic: "sùk",
            answer: "Happy",
            category: "emotions",
          },
          {
            thai: "เศร้า",
            phonetic: "sàw",
            answer: "Sad",
            category: "emotions",
          },
          {
            thai: "แม่",
            phonetic: "mɛ̂ɛ",
            answer: "Mother",
            category: "family",
          },
          {
            thai: "พ่อ",
            phonetic: "pɔ̂ɔ",
            answer: "Father",
            category: "family",
          },
          {
            thai: "ลูก",
            phonetic: "lûuk",
            answer: "Child",
            category: "family",
          },
          {
            thai: "พี่",
            phonetic: "pîi",
            answer: "Older sibling",
            category: "family",
          },
          {
            thai: "น้อง",
            phonetic: "nɔ́ɔŋ",
            answer: "Younger sibling",
            category: "family",
          },
          {
            thai: "ปู่",
            phonetic: "bpùu",
            answer: "Grandfather (paternal)",
            category: "family",
          },
          {
            thai: "ย่า",
            phonetic: "yâa",
            answer: "Grandmother (paternal)",
            category: "family",
          },
          { thai: "วัน", phonetic: "wan", answer: "Day", category: "time" },
          {
            thai: "เดือน",
            phonetic: "dɯan",
            answer: "Month",
            category: "time",
          },
          { thai: "ปี", phonetic: "bpii", answer: "Year", category: "time" },
          {
            thai: "เช้า",
            phonetic: "cháw",
            answer: "Morning",
            category: "time",
          },
          {
            thai: "เที่ยง",
            phonetic: "tîaŋ",
            answer: "Noon",
            category: "time",
          },
          {
            thai: "เย็น",
            phonetic: "yen",
            answer: "Evening",
            category: "time",
          },
          { thai: "คืน", phonetic: "kɯɯn", answer: "Night", category: "time" },
          {
            thai: "หนึ่ง",
            phonetic: "nɯ̀ŋ",
            answer: "One",
            category: "numbers",
          },
          { thai: "สอง", phonetic: "sɔ̌ɔŋ", answer: "Two", category: "numbers" },
          {
            thai: "สาม",
            phonetic: "sǎam",
            answer: "Three",
            category: "numbers",
          },
          { thai: "สี่", phonetic: "sìi", answer: "Four", category: "numbers" },
          { thai: "ห้า", phonetic: "hâa", answer: "Five", category: "numbers" },
          { thai: "หก", phonetic: "hòk", answer: "Six", category: "numbers" },
          {
            thai: "เจ็ด",
            phonetic: "jèt",
            answer: "Seven",
            category: "numbers",
          },
          {
            thai: "แปด",
            phonetic: "bpàet",
            answer: "Eight",
            category: "numbers",
          },
          {
            thai: "เก้า",
            phonetic: "gâw",
            answer: "Nine",
            category: "numbers",
          },
          { thai: "สิบ", phonetic: "sìp", answer: "Ten", category: "numbers" },
          { thai: "แดง", phonetic: "dɛɛŋ", answer: "Red", category: "colors" },
          {
            thai: "เขียว",
            phonetic: "kǐaw",
            answer: "Green",
            category: "colors",
          },
          {
            thai: "น้ำเงิน",
            phonetic: "náam-ŋəən",
            answer: "Blue",
            category: "colors",
          },
          {
            thai: "เหลือง",
            phonetic: "lɯ̌aŋ",
            answer: "Yellow",
            category: "colors",
          },
          {
            thai: "ส้ม",
            phonetic: "sôm",
            answer: "Orange",
            category: "colors",
          },
          {
            thai: "ม่วง",
            phonetic: "mûaŋ",
            answer: "Purple",
            category: "colors",
          },
          {
            thai: "ขาว",
            phonetic: "kǎaw",
            answer: "White",
            category: "colors",
          },
          { thai: "ดำ", phonetic: "dam", answer: "Black", category: "colors" },
          {
            thai: "ชมพู",
            phonetic: "chom-puu",
            answer: "Pink",
            category: "colors",
          },
          {
            thai: "น้ำตาล",
            phonetic: "náam-dtaan",
            answer: "Brown",
            category: "colors",
          },
        ],
        intermediate: [
          // Travel & Tourism
          {
            thai: "เที่ยว",
            phonetic: "tîao",
            answer: "To travel/visit",
            category: "travel",
          },
          {
            thai: "โรงแรม",
            phonetic: "roong-raem",
            answer: "Hotel",
            category: "travel",
          },
          {
            thai: "สนามบิน",
            phonetic: "sà-nǎam-bin",
            answer: "Airport",
            category: "travel",
          },
          {
            thai: "ตั้งแคมป์",
            phonetic: "dtâng-kaem",
            answer: "To camp",
            category: "travel",
          },
          {
            thai: "ชายหาด",
            phonetic: "chaai-hàat",
            answer: "Beach",
            category: "travel",
          },
          {
            thai: "เกาะ",
            phonetic: "gòr",
            answer: "Island",
            category: "travel",
          },
          {
            thai: "วัด",
            phonetic: "wát",
            answer: "Temple",
            category: "travel",
          },
          {
            thai: "พระราชวัง",
            phonetic: "prá-râat-cha-wang",
            answer: "Palace",
            category: "travel",
          },

          // People & Relationships
          {
            thai: "คนไทย",
            phonetic: "kon tai",
            answer: "Thai person",
            category: "people",
          },
          {
            thai: "นักเรียน",
            phonetic: "nák-rian",
            answer: "Student",
            category: "people",
          },
          {
            thai: "ครอบครัว",
            phonetic: "krɔ̂ɔp-kruaa",
            answer: "Family",
            category: "people",
          },
          {
            thai: "เพื่อน",
            phonetic: "pɯ̂an",
            answer: "Friend",
            category: "people",
          },
          {
            thai: "คู่รัก",
            phonetic: "kûu-rák",
            answer: "Couple/lover",
            category: "people",
          },
          {
            thai: "เพื่อนบ้าน",
            phonetic: "pɯ̂an-bâan",
            answer: "Neighbor",
            category: "people",
          },

          // Weather & Nature
          {
            thai: "ร้อน",
            phonetic: "róon",
            answer: "Hot",
            category: "weather",
          },
          {
            thai: "เย็น",
            phonetic: "yen",
            answer: "Cold",
            category: "weather",
          },
          {
            thai: "ฝน",
            phonetic: "fǒn",
            answer: "Rain",
            category: "weather",
          },
          {
            thai: "แดด",
            phonetic: "dàet",
            answer: "Sun/Sunshine",
            category: "weather",
          },
          {
            thai: "ลม",
            phonetic: "lom",
            answer: "Wind",
            category: "weather",
          },
          {
            thai: "เมฆ",
            phonetic: "mêek",
            answer: "Cloud",
            category: "weather",
          },
          {
            thai: "ดาว",
            phonetic: "daao",
            answer: "Star",
            category: "nature",
          },
          {
            thai: "ดวงจันทร์",
            phonetic: "duaŋ-jan",
            answer: "Moon",
            category: "nature",
          },

          // Food & Dining
          {
            thai: "อร่อย",
            phonetic: "à-ròoi",
            answer: "Delicious",
            category: "food",
          },
          {
            thai: "เผ็ด",
            phonetic: "pèt",
            answer: "Spicy",
            category: "food",
          },
          {
            thai: "หวาน",
            phonetic: "wǎan",
            answer: "Sweet",
            category: "food",
          },
          {
            thai: "เปรี้ยว",
            phonetic: "bprîao",
            answer: "Sour",
            category: "food",
          },
          {
            thai: "เค็ม",
            phonetic: "kem",
            answer: "Salty",
            category: "food",
          },
          {
            thai: "ขม",
            phonetic: "kǒm",
            answer: "Bitter",
            category: "food",
          },
          {
            thai: "ผัดไท",
            phonetic: "pàt-tai",
            answer: "Pad Thai",
            category: "food",
          },
          {
            thai: "ต้มยำ",
            phonetic: "dtôm-yam",
            answer: "Tom Yum (soup)",
            category: "food",
          },

          // Places & Locations
          {
            thai: "ตลาด",
            phonetic: "dtà-làat",
            answer: "Market",
            category: "places",
          },
          {
            thai: "โรงเรียน",
            phonetic: "roong-rian",
            answer: "School",
            category: "places",
          },
          {
            thai: "โรงพยาบาล",
            phonetic: "roong-pá-yaa-baan",
            answer: "Hospital",
            category: "places",
          },
          {
            thai: "ธนาคาร",
            phonetic: "tá-naa-kaan",
            answer: "Bank",
            category: "places",
          },
          {
            thai: "ห้างสรรพสินค้า",
            phonetic: "hâaŋ-sàp-pá-sǐn-káa",
            answer: "Shopping mall",
            category: "places",
          },
          {
            thai: "สถานีรถไฟ",
            phonetic: "sà-tǎa-nii-rót-fai",
            answer: "Train station",
            category: "places",
          },

          // Jobs & Professions
          {
            thai: "หมอ",
            phonetic: "mǒr",
            answer: "Doctor",
            category: "jobs",
          },
          {
            thai: "ครู",
            phonetic: "kruu",
            answer: "Teacher",
            category: "jobs",
          },
          {
            thai: "ตำรวจ",
            phonetic: "dtam-rùat",
            answer: "Police",
            category: "jobs",
          },
          {
            thai: "พยาบาล",
            phonetic: "pá-yaa-baan",
            answer: "Nurse",
            category: "jobs",
          },
          {
            thai: "วิศวกร",
            phonetic: "wí-sǎ-wá-gɔɔn",
            answer: "Engineer",
            category: "jobs",
          },
          {
            thai: "ทนายความ",
            phonetic: "tá-naai-kwaam",
            answer: "Lawyer",
            category: "jobs",
          },

          // Transportation
          {
            thai: "รถยนต์",
            phonetic: "rót-yon",
            answer: "Car",
            category: "transport",
          },
          {
            thai: "รถไฟ",
            phonetic: "rót-fai",
            answer: "Train",
            category: "transport",
          },
          {
            thai: "เครื่องบิน",
            phonetic: "krɯ̂aŋ-bin",
            answer: "Airplane",
            category: "transport",
          },
          {
            thai: "รถบัส",
            phonetic: "rót-bàt",
            answer: "Bus",
            category: "transport",
          },
          {
            thai: "เรือ",
            phonetic: "rɯa",
            answer: "Boat",
            category: "transport",
          },
          {
            thai: "จักรยาน",
            phonetic: "jàk-grà-yaan",
            answer: "Bicycle",
            category: "transport",
          },

          // Daily Activities & Common Phrases
          {
            thai: "อาบน้ำ",
            phonetic: "àap-náam",
            answer: "To shower/bathe",
            category: "daily",
          },
          {
            thai: "แปรงฟัน",
            phonetic: "bprɛɛŋ-fan",
            answer: "To brush teeth",
            category: "daily",
          },
          {
            thai: "นอน",
            phonetic: "nɔɔn",
            answer: "To sleep",
            category: "daily",
          },
          {
            thai: "ตื่น",
            phonetic: "dtɯ̀ɯn",
            answer: "To wake up",
            category: "daily",
          },
          {
            thai: "ทำงาน",
            phonetic: "tam-ŋaan",
            answer: "To work",
            category: "daily",
          },
          {
            thai: "เรียน",
            phonetic: "rian",
            answer: "To study",
            category: "daily",
          },
          {
            thai: "ช้อปปิ้ง",
            phonetic: "chɔ́ɔp-bpîŋ",
            answer: "Shopping",
            category: "daily",
          },
          {
            thai: "ออกกำลังกาย",
            phonetic: "ɔ̀ɔk-gam-laŋ-gaai",
            answer: "To exercise",
            category: "daily",
          },

          // Emotions & Feelings
          {
            thai: "โกรธ",
            phonetic: "gròot",
            answer: "Angry",
            category: "emotions",
          },
          {
            thai: "เหนื่อย",
            phonetic: "nɯ̀ai",
            answer: "Tired",
            category: "emotions",
          },
          {
            thai: "ตื่นเต้น",
            phonetic: "dtɯ̀ɯn-dtên",
            answer: "Excited",
            category: "emotions",
          },
          {
            thai: "เบื่อ",
            phonetic: "bɯ̀a",
            answer: "Bored",
            category: "emotions",
          },
          {
            thai: "กลัว",
            phonetic: "gluaa",
            answer: "Afraid/scared",
            category: "emotions",
          },
          {
            thai: "ประหลาดใจ",
            phonetic: "bprà-làat-jai",
            answer: "Surprised",
            category: "emotions",
          },

          // Thai Festivals & Culture
          {
            thai: "เทศกาล",
            phonetic: "têet-sà-gaan",
            answer: "Festival",
            category: "culture",
          },
          {
            thai: "บุญ",
            phonetic: "bun",
            answer: "Merit/good deed",
            category: "culture",
          },
          {
            thai: "ทำบุญ",
            phonetic: "tam-bun",
            answer: "To make merit",
            category: "culture",
          },
          {
            thai: "พระ",
            phonetic: "prá",
            answer: "Monk/Buddha image",
            category: "culture",
          },
        ],
        advanced: [
          // Business & Economics
          {
            thai: "ธุรกิจ",
            phonetic: "tú-rá-gìt",
            answer: "Business",
            category: "business",
          },
          {
            thai: "การลงทุน",
            phonetic: "gaan-loŋ-tun",
            answer: "Investment",
            category: "business",
          },
          {
            thai: "กำไร",
            phonetic: "gam-rai",
            answer: "Profit",
            category: "business",
          },
          {
            thai: "การตลาด",
            phonetic: "gaan-dtà-làat",
            answer: "Marketing",
            category: "business",
          },
          {
            thai: "ผู้บริโภค",
            phonetic: "pûu-bɔɔ-rí-poːk",
            answer: "Consumer",
            category: "business",
          },
          {
            thai: "เศรษฐกิจ",
            phonetic: "sèet-tà-gìt",
            answer: "Economy",
            category: "business",
          },
          {
            thai: "การค้า",
            phonetic: "gaan-káa",
            answer: "Trade/Commerce",
            category: "business",
          },
          {
            thai: "บริษัท",
            phonetic: "bɔɔ-rí-sàt",
            answer: "Company",
            category: "business",
          },

          // Culture & Society
          {
            thai: "วัฒนธรรม",
            phonetic: "wát-tá-ná-tam",
            answer: "Culture",
            category: "culture",
          },
          {
            thai: "ประเพณี",
            phonetic: "bprà-pee-nii",
            answer: "Tradition",
            category: "culture",
          },
          {
            thai: "สงกรานต์",
            phonetic: "sǒŋ-graan",
            answer: "Songkran (Thai New Year)",
            category: "culture",
          },
          {
            thai: "ลอยกระทง",
            phonetic: "lɔɔi-grà-toŋ",
            answer: "Loy Krathong Festival",
            category: "culture",
          },
          {
            thai: "การไหว้",
            phonetic: "gaan-wâi",
            answer: "Thai greeting gesture",
            category: "culture",
          },
          {
            thai: "พระพุทธศาสนา",
            phonetic: "prá-pút-tá-sàat-sà-nǎa",
            answer: "Buddhism",
            category: "culture",
          },
          {
            thai: "ศิลปะ",
            phonetic: "sǐn-là-bpà",
            answer: "Art",
            category: "culture",
          },
          {
            thai: "ดนตรี",
            phonetic: "don-dtrii",
            answer: "Music",
            category: "culture",
          },

          // Politics & Governance
          {
            thai: "ประชาธิปไตย",
            phonetic: "bprà-chaa-típ-bpai",
            answer: "Democracy",
            category: "politics",
          },
          {
            thai: "การเมือง",
            phonetic: "gaan-mɯaŋ",
            answer: "Politics",
            category: "politics",
          },
          {
            thai: "รัฐสภา",
            phonetic: "rát-tà-sà-paa",
            answer: "Parliament",
            category: "politics",
          },
          {
            thai: "นายกรัฐมนตรี",
            phonetic: "naai-gòk-rát-tà-mon-dtrii",
            answer: "Prime Minister",
            category: "politics",
          },
          {
            thai: "การเลือกตั้ง",
            phonetic: "gaan-lɯ̂ak-dtâŋ",
            answer: "Election",
            category: "politics",
          },
          {
            thai: "รัฐธรรมนูญ",
            phonetic: "rát-tà-tam-ma-nuun",
            answer: "Constitution",
            category: "politics",
          },

          // Education & Academics
          {
            thai: "การศึกษา",
            phonetic: "gaan-sʉ̀k-sǎa",
            answer: "Education",
            category: "academics",
          },
          {
            thai: "มหาวิทยาลัย",
            phonetic: "má-hǎa-wít-tá-yaa-lai",
            answer: "University",
            category: "academics",
          },
          {
            thai: "วิทยาศาสตร์",
            phonetic: "wít-tá-yaa-sàat",
            answer: "Science",
            category: "academics",
          },
          {
            thai: "คณิตศาสตร์",
            phonetic: "ká-nít-sàat",
            answer: "Mathematics",
            category: "academics",
          },
          {
            thai: "ประวัติศาสตร์",
            phonetic: "bprà-wàt-sàat",
            answer: "History",
            category: "academics",
          },
          {
            thai: "ภูมิศาสตร์",
            phonetic: "puum-sàat",
            answer: "Geography",
            category: "academics",
          },
          {
            thai: "จิตวิทยา",
            phonetic: "jìt-wít-tá-yaa",
            answer: "Psychology",
            category: "academics",
          },
          {
            thai: "ปรัชญา",
            phonetic: "bpràt-yaa",
            answer: "Philosophy",
            category: "academics",
          },

          // Technology & Environment
          {
            thai: "เทคโนโลยี",
            phonetic: "ték-noo-loo-yii",
            answer: "Technology",
            category: "technology",
          },
          {
            thai: "คอมพิวเตอร์",
            phonetic: "kɔm-piw-dtəə",
            answer: "Computer",
            category: "technology",
          },
          {
            thai: "อินเทอร์เน็ต",
            phonetic: "in-təə-nét",
            answer: "Internet",
            category: "technology",
          },
          {
            thai: "สิ่งแวดล้อม",
            phonetic: "sìng-wàet-lóm",
            answer: "Environment",
            category: "environment",
          },
          {
            thai: "มลพิษ",
            phonetic: "mon-lá-pít",
            answer: "Pollution",
            category: "environment",
          },
          {
            thai: "การอนุรักษ์",
            phonetic: "gaan-à-nu-rák",
            answer: "Conservation",
            category: "environment",
          },

          // Abstract Concepts
          {
            thai: "การพัฒนา",
            phonetic: "gaan-pát-tá-naa",
            answer: "Development",
            category: "concepts",
          },
          {
            thai: "ความยุติธรรม",
            phonetic: "kwaam-yút-dtì-tam",
            answer: "Justice",
            category: "concepts",
          },
          {
            thai: "สังคม",
            phonetic: "sǎŋ-kom",
            answer: "Society",
            category: "concepts",
          },
          {
            thai: "ความเท่าเทียม",
            phonetic: "kwaam-tâo-tiiam",
            answer: "Equality",
            category: "concepts",
          },
          {
            thai: "ความรับผิดชอบ",
            phonetic: "kwaam-ráp-pìt-chɔ̂ɔp",
            answer: "Responsibility",
            category: "concepts",
          },
        ],
      };

      let currentDifficulty = "beginner";
      let flashcards = flashcardData[currentDifficulty];
      let flashcardIndex = 0;
      let sessionStats = {
        correct: 0,
        incorrect: 0,
        streak: 0,
        totalTime: 0,
        startTime: Date.now(),
        cardTimes: [],
      };
      let currentMode = "flashcards";

      // Enhanced user progress with spaced repetition data
      let userProgress = JSON.parse(
        localStorage.getItem("thaiFlashcardProgress")
      ) || {
        wordsLearned: [],
        totalCardsStudied: 0,
        streakRecord: 0,
        studySessions: 0,
        cardProgress: {}, // For spaced repetition tracking
        categoryProgress: {}, // Track progress by category
        lastStudyDate: null,
        totalStudyTime: 0,
        dailyStreak: 0,
        longestStreak: 0,
        studyGoal: 10, // cards per day
      };

      // Spaced repetition system
      const spacedRepetitionIntervals = [1, 3, 7, 14, 30]; // Days between reviews

      // Card difficulty/ease factor system
      const cardEaseFactors = {
        hard: 1.3, // Review sooner
        good: 2.5, // Standard interval
        easy: 3.0, // Longer interval
      };

      // Initialize card progress if not exists
      function initializeCardProgress(cardId) {
        if (!userProgress.cardProgress[cardId]) {
          userProgress.cardProgress[cardId] = {
            level: 0,
            easeFactor: 2.5,
            lastReviewed: null,
            nextReview: Date.now(),
            correctStreak: 0,
            totalReviews: 0,
            averageResponseTime: 0,
            difficulty: currentDifficulty,
          };
        }
        return userProgress.cardProgress[cardId];
      }

      // Calculate next review date based on spaced repetition
      function calculateNextReview(cardProgress, difficulty) {
        const now = Date.now();
        const dayInMs = 24 * 60 * 60 * 1000;

        let intervalDays =
          spacedRepetitionIntervals[
            Math.min(cardProgress.level, spacedRepetitionIntervals.length - 1)
          ];

        // Adjust interval based on difficulty rating
        const easeFactor = cardEaseFactors[difficulty] || 2.5;
        intervalDays = Math.round(intervalDays * easeFactor);

        // Update ease factor based on performance
        if (difficulty === "hard") {
          cardProgress.easeFactor = Math.max(
            1.3,
            cardProgress.easeFactor - 0.15
          );
          cardProgress.correctStreak = 0;
        } else if (difficulty === "easy") {
          cardProgress.easeFactor = Math.min(
            3.0,
            cardProgress.easeFactor + 0.1
          );
          cardProgress.correctStreak++;
        } else {
          cardProgress.correctStreak++;
        }

        return now + intervalDays * dayInMs;
      }

      // Get cards due for review (spaced repetition)
      function getCardsDueForReview() {
        const now = Date.now();
        const allCards = Object.values(flashcardData).flat();
        const dueCards = [];

        allCards.forEach((card, index) => {
          const cardId = `${card.category}-${index}`;
          const progress = initializeCardProgress(cardId);

          if (progress.nextReview <= now) {
            dueCards.push({ ...card, cardId, progress });
          }
        });

        // Sort by priority (overdue cards first, then by ease factor)
        return dueCards.sort((a, b) => {
          const aOverdue = now - a.progress.nextReview;
          const bOverdue = now - b.progress.nextReview;

          if (aOverdue > 0 && bOverdue > 0) {
            return bOverdue - aOverdue; // Most overdue first
          }
          if (aOverdue > 0) return -1;
          if (bOverdue > 0) return 1;

          return a.progress.easeFactor - b.progress.easeFactor; // Harder cards first
        });
      }

      // Smart card selection for study session
      function getSmartCardOrder() {
        const dueCards = getCardsDueForReview();
        const regularCards = flashcards.filter((card, index) => {
          const cardId = `${currentDifficulty}-${index}`;
          const progress = userProgress.cardProgress[cardId];
          return !progress || progress.nextReview <= Date.now();
        });

        // Mix due cards with regular cards for variety
        const mixedCards = [];
        const maxCards = Math.min(20, dueCards.length + regularCards.length);

        for (let i = 0; i < maxCards; i++) {
          if (i % 3 === 0 && dueCards.length > 0) {
            mixedCards.push(dueCards.shift());
          } else if (regularCards.length > 0) {
            mixedCards.push(regularCards.shift());
          } else if (dueCards.length > 0) {
            mixedCards.push(dueCards.shift());
          }
        }

        return mixedCards;
      }

      // Audio functionality - Default enabled
      let audioEnabled = true;
      let speechSynthesis = window.speechSynthesis;
      let voiceVolume = 0.8;

      // Enhanced audio system with fallback
      let thaiVoices = [];

      function loadVoices() {
        return new Promise((resolve) => {
          const voices = speechSynthesis.getVoices();
          thaiVoices = voices.filter(
            (voice) =>
              voice.lang.includes("th") ||
              voice.lang.includes("TH") ||
              voice.name.toLowerCase().includes("thai")
          );
          resolve(thaiVoices);
        });
      }

      function speakThai(text, options = {}) {
        if (!audioEnabled || !speechSynthesis) return;

        const utterance = new SpeechSynthesisUtterance(text);

        // Use Thai voice if available
        if (thaiVoices.length > 0) {
          utterance.voice = thaiVoices[0];
        }

        utterance.lang = "th-TH";
        utterance.volume = options.volume || voiceVolume;
        utterance.rate = options.rate || 0.7; // Slower for better pronunciation
        utterance.pitch = options.pitch || 1;

        // Add visual feedback during speech
        const audioButton = document.querySelector(".audio-indicator");
        if (audioButton) {
          audioButton.classList.add("speaking");
          utterance.onend = () => audioButton.classList.remove("speaking");
        }

        try {
          speechSynthesis.cancel(); // Stop any current speech
          speechSynthesis.speak(utterance);
        } catch (error) {
          console.warn("Speech synthesis not available:", error);
          showFeedback("Audio not available on this device", "warning");
        }
      }

      // Auto-repeat pronunciation for difficult words
      function repeatPronunciation(text, times = 2) {
        if (!audioEnabled) return;

        let count = 0;
        const speak = () => {
          if (count < times) {
            speakThai(text);
            count++;
            setTimeout(speak, 1500);
          }
        };
        speak();
      }

      // Enhanced analytics and progress tracking
      function updateProgressAnalytics() {
        const totalCards = Object.values(flashcardData).flat().length;
        const learnedPercentage = Math.round(
          (userProgress.wordsLearned.length / totalCards) * 100
        );

        // Update streak record
        if (sessionStats.streak > userProgress.streakRecord) {
          userProgress.streakRecord = sessionStats.streak;
        }

        // Save progress
        localStorage.setItem(
          "thaiFlashcardProgress",
          JSON.stringify(userProgress)
        );

        // Update UI with enhanced stats
        updateProgressDisplay();
      }

      function updateProgressDisplay() {
        // Calculate mastered words (cards with level > 2)
        const masteredWords = Object.values(userProgress.cardProgress).filter(
          (progress) => progress.level >= 2
        ).length;

        document.getElementById("words-mastered").textContent = masteredWords;
        document.getElementById("cards-practiced").textContent =
          userProgress.totalCardsStudied;

        // Calculate accuracy from card progress
        const cardProgressValues = Object.values(userProgress.cardProgress);
        if (cardProgressValues.length > 0) {
          const totalCorrect = cardProgressValues.reduce(
            (sum, progress) => sum + progress.correctStreak,
            0
          );
          const totalReviews = cardProgressValues.reduce(
            (sum, progress) => sum + progress.totalReviews,
            0
          );
          const accuracy =
            totalReviews > 0
              ? Math.round((totalCorrect / totalReviews) * 100)
              : 0;
          document.getElementById("accuracy").textContent = accuracy + "%";
        } else {
          document.getElementById("accuracy").textContent = "0%";
        }

        // Show cards due for review
        const dueCards = getCardsDueForReview();
        document.getElementById("cards-due").textContent = dueCards.length;

        // Update daily goal progress
        const today = new Date().toDateString();
        const todayStudied = sessionStats.correct + sessionStats.incorrect;
        const dailyGoal = userProgress.studyGoal || 10;
        document.getElementById(
          "daily-goal-progress"
        ).textContent = `${Math.min(todayStudied, dailyGoal)}/${dailyGoal}`;

        // Update study streak
        document.getElementById("study-streak").textContent =
          userProgress.dailyStreak || 0;

        // Update overall progress based on mastered words
        const totalCards = Object.values(flashcardData).flat().length;
        const overallProgress = Math.round((masteredWords / totalCards) * 100);
        document.getElementById("overall-progress").textContent =
          overallProgress + "%";
        document.getElementById("progress-fill").style.width =
          overallProgress + "%";

        // Show achievement notification for milestones
        checkForNewAchievements();
      }

      // Performance tracking
      function trackCardPerformance(cardId, timeSpent, wasCorrect) {
        const performanceData = {
          cardId,
          timeSpent,
          wasCorrect,
          timestamp: Date.now(),
          difficulty: currentDifficulty,
        };

        sessionStats.cardTimes.push(performanceData);

        // Update user progress
        if (wasCorrect && !userProgress.wordsLearned.includes(cardId)) {
          userProgress.wordsLearned.push(cardId);
        }

        userProgress.totalCardsStudied++;
        updateProgressAnalytics();
      }

      // Enhanced functions
      function switchMode(mode, event) {
        document
          .querySelectorAll(".mode-btn")
          .forEach((btn) => btn.classList.remove("active"));
        if (event && event.target) {
          event.target.classList.add("active");
        }

        // Hide all modes
        document.getElementById("flashcard-mode").style.display = "none";
        document.getElementById("quiz-mode").style.display = "none";
        document.getElementById("writing-mode").style.display = "none";
        document.getElementById("conversation-mode").style.display = "none";

        // Show selected mode
        switch(mode) {
          case "flashcards":
            document.getElementById("flashcard-mode").style.display = "block";
            break;
          case "quiz":
            document.getElementById("quiz-mode").style.display = "block";
            initQuiz();
            break;
          case "writing":
            document.getElementById("writing-mode").style.display = "block";
            initWritingMode();
            break;
          case "conversation":
            document.getElementById("conversation-mode").style.display = "block";
            initConversationMode();
            break;
          case "study":
            document.getElementById("flashcard-mode").style.display = "block";
            showFeedback("Study mode - use flashcards with spaced repetition!", "info");
            break;
        }

        currentMode = mode;
      }

      function markCard(difficulty) {
        const cardStartTime = sessionStats.cardStartTime || Date.now();
        const timeSpent = Date.now() - cardStartTime;
        const currentCard = flashcards[flashcardIndex];
        const cardId = `${currentDifficulty}-${flashcardIndex}`;

        // Convert difficulty to standard format
        let difficultyLevel;
        if (difficulty === true) {
          difficultyLevel = "easy";
        } else if (difficulty === "medium") {
          difficultyLevel = "good";
        } else {
          difficultyLevel = "hard";
        }

        const isCorrect = difficultyLevel !== "hard";

        // Update spaced repetition data
        const cardProgress = initializeCardProgress(cardId);
        cardProgress.lastReviewed = Date.now();
        cardProgress.totalReviews++;

        // Update average response time
        cardProgress.averageResponseTime =
          cardProgress.averageResponseTime === 0
            ? timeSpent
            : (cardProgress.averageResponseTime + timeSpent) / 2;

        if (isCorrect) {
          sessionStats.correct++;
          sessionStats.streak++;

          // Update spaced repetition level and next review date
          if (difficultyLevel === "easy") {
            cardProgress.level = Math.min(
              cardProgress.level + 2,
              spacedRepetitionIntervals.length - 1
            );
            showFeedback(
              "🎉 Easy! Next review in " +
                getNextReviewText(cardProgress, difficultyLevel),
              "success"
            );
          } else {
            cardProgress.level = Math.min(
              cardProgress.level + 1,
              spacedRepetitionIntervals.length - 1
            );
            showFeedback(
              "👍 Good! Next review in " +
                getNextReviewText(cardProgress, difficultyLevel),
              "success"
            );
          }

          cardProgress.nextReview = calculateNextReview(
            cardProgress,
            difficultyLevel
          );

          // Add celebration effect for streaks
          if (sessionStats.streak > 0 && sessionStats.streak % 5 === 0) {
            showFeedback(
              `🔥 ${sessionStats.streak} streak! Amazing!`,
              "success"
            );
            celebrateStreak();
          }
        } else {
          sessionStats.incorrect++;
          sessionStats.streak = 0;

          // Reset spaced repetition progress for hard cards
          cardProgress.level = Math.max(0, cardProgress.level - 1);
          cardProgress.nextReview = calculateNextReview(
            cardProgress,
            difficultyLevel
          );

          showFeedback("📚 Will review again soon!", "warning");
        }

        // Update category progress
        const category = currentCard.category || "general";
        if (!userProgress.categoryProgress[category]) {
          userProgress.categoryProgress[category] = { correct: 0, total: 0 };
        }
        userProgress.categoryProgress[category].total++;
        if (isCorrect) {
          userProgress.categoryProgress[category].correct++;
        }

        // Track performance
        trackCardPerformance(cardId, timeSpent, isCorrect);
        updateSessionStats();
        updateProgressStats();

        // Save progress
        localStorage.setItem(
          "thaiFlashcardProgress",
          JSON.stringify(userProgress)
        );

        // Check for daily goal completion
        checkDailyGoalCompletion();

        if (document.getElementById("auto-advance").checked) {
          setTimeout(() => nextFlashcard(), 1500);
        }
      }

      // Helper function to get human-readable next review time
      function getNextReviewText(cardProgress, difficulty) {
        const now = Date.now();
        const nextReview = calculateNextReview({ ...cardProgress }, difficulty);
        const daysDiff = Math.ceil((nextReview - now) / (24 * 60 * 60 * 1000));

        if (daysDiff === 0) return "today";
        if (daysDiff === 1) return "tomorrow";
        if (daysDiff < 7) return `${daysDiff} days`;
        if (daysDiff < 30) return `${Math.round(daysDiff / 7)} weeks`;
        return `${Math.round(daysDiff / 30)} months`;
      }

      function celebrateStreak() {
        // Add confetti or celebration animation
        const celebration = document.createElement("div");
        celebration.innerHTML = "🎉";
        celebration.style.cssText = `
          position: fixed;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          font-size: 3rem;
          z-index: 2000;
          animation: bounce 0.6s ease;
          pointer-events: none;
        `;
        document.body.appendChild(celebration);
        setTimeout(() => celebration.remove(), 600);
      }

      function updateSessionStats() {
        document.getElementById("session-correct").textContent =
          sessionStats.correct;
        document.getElementById("session-incorrect").textContent =
          sessionStats.incorrect;
        document.getElementById("session-streak").textContent =
          sessionStats.streak;

        // Update session time
        const sessionTime = Math.floor(
          (Date.now() - sessionStats.startTime) / 1000
        );
        const minutes = Math.floor(sessionTime / 60);
        const seconds = sessionTime % 60;
        document.getElementById(
          "session-duration"
        ).textContent = `${minutes}:${seconds.toString().padStart(2, "0")}`;

        // Update streak record
        document.getElementById("streak-record").textContent =
          userProgress.streakRecord;
      }

      function changeDifficulty() {
        currentDifficulty = document.getElementById("difficulty-level").value;
        flashcards = flashcardData[currentDifficulty];
        flashcardIndex = 0;
        updateFlashcard();
        document.getElementById("difficulty-indicator").textContent =
          currentDifficulty.charAt(0).toUpperCase() +
          currentDifficulty.slice(1);

        showFeedback(`Switched to ${currentDifficulty} level!`, "info");
      }

      function toggleSettings() {
        document.getElementById("settings-panel").classList.toggle("open");
      }

      function toggleAudio() {
        audioEnabled = document.getElementById("audio-enabled").checked;
        showFeedback(
          audioEnabled ? "Audio enabled 🔊" : "Audio disabled 🔇",
          "info"
        );
      }

      function adjustVolume() {
        voiceVolume = document.getElementById("volume-slider").value;
      }

      function exportProgress() {
        const exportData = {
          progress: userProgress,
          sessionStats: sessionStats,
          exportDate: new Date().toISOString(),
          version: "2.0",
          achievements: calculateAchievements(),
        };

        const dataStr = JSON.stringify(exportData, null, 2);
        const dataUri =
          "data:application/json;charset=utf-8," + encodeURIComponent(dataStr);

        const exportFileDefaultName = `thai-flashcard-progress-${new Date()
          .toISOString()
          .slice(0, 10)}.json`;

        const linkElement = document.createElement("a");
        linkElement.setAttribute("href", dataUri);
        linkElement.setAttribute("download", exportFileDefaultName);
        linkElement.click();

        showFeedback("Progress exported! 📄", "success");
      }

      // Share progress on social media
      function shareProgress() {
        const masteredWords = Object.values(userProgress.cardProgress).filter(
          (progress) => progress.level >= 2
        ).length;

        const shareText = `🇹🇭 I've mastered ${masteredWords} Thai words using ESL Fun Online! 
${userProgress.dailyStreak} day study streak 🔥
Join me in learning Thai: ${window.location.href}`;

        if (navigator.share) {
          navigator
            .share({
              title: "My Thai Learning Progress",
              text: shareText,
              url: window.location.href,
            })
            .catch(console.error);
        } else {
          // Fallback to clipboard
          navigator.clipboard
            .writeText(shareText)
            .then(() => {
              showFeedback(
                "Progress copied to clipboard! Share it anywhere! 📋",
                "success"
              );
            })
            .catch(() => {
              // Manual copy fallback
              const textArea = document.createElement("textarea");
              textArea.value = shareText;
              document.body.appendChild(textArea);
              textArea.select();
              document.execCommand("copy");
              document.body.removeChild(textArea);
              showFeedback("Progress copied to clipboard! 📋", "success");
            });
        }
      }

      // Calculate achievements
      function calculateAchievements() {
        const achievements = [];
        const masteredWords = Object.values(userProgress.cardProgress).filter(
          (progress) => progress.level >= 2
        ).length;

        // Word count achievements
        if (masteredWords >= 10) achievements.push("🌟 First 10 Words");
        if (masteredWords >= 50) achievements.push("💫 Half Century");
        if (masteredWords >= 100) achievements.push("💎 Century Club");
        if (masteredWords >= 200) achievements.push("🏆 Thai Master");

        // Streak achievements
        if (userProgress.dailyStreak >= 3) achievements.push("🔥 3-Day Streak");
        if (userProgress.dailyStreak >= 7) achievements.push("📅 Week Warrior");
        if (userProgress.dailyStreak >= 30)
          achievements.push("🗓️ Monthly Master");
        if (userProgress.longestStreak >= 100)
          achievements.push("💯 Centurion Streak");

        // Category achievements
        const categoryStats = userProgress.categoryProgress;
        Object.keys(categoryStats).forEach((category) => {
          const accuracy =
            categoryStats[category].correct / categoryStats[category].total;
          if (accuracy >= 0.9 && categoryStats[category].total >= 10) {
            achievements.push(
              `🎯 ${
                category.charAt(0).toUpperCase() + category.slice(1)
              } Expert`
            );
          }
        });

        // Session achievements
        if (userProgress.studySessions >= 10)
          achievements.push("🎓 Dedicated Student");
        if (userProgress.studySessions >= 50) achievements.push("📚 Scholar");
        if (userProgress.studySessions >= 100)
          achievements.push("🧠 Learning Legend");

        return achievements;
      }

      // Show achievements modal
      function showAchievements() {
        const achievements = calculateAchievements();
        const modal = document.createElement("div");
        modal.style.cssText = `
          position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
          background: rgba(0,0,0,0.5); display: flex; align-items: center; 
          justify-content: center; z-index: 2000; backdrop-filter: blur(5px);
        `;

        modal.innerHTML = `
          <div style="background: white; padding: 2rem; border-radius: var(--border-radius); 
                      max-width: 500px; max-height: 80vh; overflow-y: auto; margin: 1rem;">
            <h2 style="color: var(--primary); margin-bottom: 1.5rem; text-align: center;">
              🏆 Your Achievements
            </h2>
            <div style="display: grid; gap: 0.75rem;">
              ${
                achievements.length > 0
                  ? achievements
                      .map(
                        (achievement) => `
                <div style="padding: 0.75rem; background: var(--primary-light); 
                           border-radius: var(--border-radius); border-left: 4px solid var(--primary);">
                  ${achievement}
                </div>
              `
                      )
                      .join("")
                  : '<p style="text-align: center; color: var(--text-muted);">Keep studying to unlock achievements! 🌟</p>'
              }
            </div>
            <div style="display: flex; gap: 1rem; margin-top: 2rem; justify-content: center;">
              <button onclick="shareProgress()" class="btn btn-primary btn-sm">
                <i class="fas fa-share"></i> Share Progress
              </button>
              <button onclick="this.closest('div').parentElement.remove()" class="btn btn-outline btn-sm">
                Close
              </button>
            </div>
          </div>
        `;

        modal.onclick = (e) => {
          if (e.target === modal) modal.remove();
        };

        document.body.appendChild(modal);
      }

      // Check for new achievements and show notifications
      function checkForNewAchievements() {
        const currentAchievements = calculateAchievements();
        const lastAchievements = userProgress.lastAchievements || [];

        const newAchievements = currentAchievements.filter(
          (achievement) => !lastAchievements.includes(achievement)
        );

        if (newAchievements.length > 0) {
          newAchievements.forEach((achievement, index) => {
            setTimeout(() => {
              showFeedback(
                `🎉 New Achievement: ${achievement}`,
                "success",
                4000
              );
            }, index * 1000);
          });

          userProgress.lastAchievements = currentAchievements;
          localStorage.setItem(
            "thaiFlashcardProgress",
            JSON.stringify(userProgress)
          );
        }
      }

      // Daily goal completion check
      function checkDailyGoalCompletion() {
        const todayStudied = sessionStats.correct + sessionStats.incorrect;
        const dailyGoal = userProgress.studyGoal || 10;

        if (todayStudied === dailyGoal && !userProgress.dailyGoalCompleted) {
          showFeedback("🎯 Daily goal completed! Great job!", "success", 3000);
          userProgress.dailyGoalCompleted = true;
          localStorage.setItem(
            "thaiFlashcardProgress",
            JSON.stringify(userProgress)
          );
        }
      }

      function resetProgress() {
        if (
          confirm(
            "Are you sure you want to reset all progress? This cannot be undone."
          )
        ) {
          localStorage.removeItem("thaiFlashcardProgress");
          userProgress = {
            wordsLearned: [],
            totalCardsStudied: 0,
            streakRecord: 0,
            studySessions: 0,
          };
          sessionStats = {
            correct: 0,
            incorrect: 0,
            streak: 0,
            totalTime: 0,
            startTime: Date.now(),
            cardTimes: [],
          };
          updateSessionStats();
          updateProgressDisplay();
          showFeedback("Progress reset! 🔄", "info");
        }
      }

      // Quiz functionality
      let currentQuizIndex = 0;
      let quizQuestions = [];

      function initQuiz() {
        quizQuestions = [...flashcards]
          .sort(() => Math.random() - 0.5)
          .slice(0, 5);
        currentQuizIndex = 0;
        loadQuizQuestion();
      }

      function loadQuizQuestion() {
        const question = quizQuestions[currentQuizIndex];
        document.getElementById("quiz-current").textContent =
          currentQuizIndex + 1;
        document.getElementById("quiz-total").textContent =
          quizQuestions.length;
        document.getElementById("quiz-thai").textContent = question.thai;
        document.getElementById("quiz-phonetic").textContent =
          question.phonetic;

        // Generate options
        const options = [question.answer];
        const otherAnswers = flashcards
          .filter((card) => card.answer !== question.answer)
          .sort(() => Math.random() - 0.5)
          .slice(0, 3)
          .map((card) => card.answer);

        options.push(...otherAnswers);
        options.sort(() => Math.random() - 0.5);

        const optionsContainer = document.getElementById("quiz-options");
        optionsContainer.innerHTML = "";

        options.forEach((option) => {
          const optionDiv = document.createElement("div");
          optionDiv.className = "quiz-option";
          optionDiv.textContent = option;
          optionDiv.onclick = () => selectQuizOption(optionDiv);
          optionsContainer.appendChild(optionDiv);
        });

        document.getElementById("quiz-submit").style.display = "inline-flex";
        document.getElementById("quiz-next").style.display = "none";
      }

      function selectQuizOption(element) {
        document
          .querySelectorAll(".quiz-option")
          .forEach((opt) => opt.classList.remove("selected"));
        element.classList.add("selected");
      }

      function submitQuizAnswer() {
        const selected = document.querySelector(".quiz-option.selected");
        if (!selected) return;

        const correctAnswer = quizQuestions[currentQuizIndex].answer;
        const isCorrect = selected.textContent === correctAnswer;

        document.querySelectorAll(".quiz-option").forEach((opt) => {
          if (opt.textContent === correctAnswer) {
            opt.classList.add("correct");
          } else if (opt.classList.contains("selected") && !isCorrect) {
            opt.classList.add("incorrect");
          }
        });

        showFeedback(
          isCorrect ? "Correct!" : "Try again next time!",
          isCorrect ? "success" : "danger"
        );

        document.getElementById("quiz-submit").style.display = "none";
        document.getElementById("quiz-next").style.display = "inline-flex";
      }

      function nextQuizQuestion() {
        currentQuizIndex++;
        if (currentQuizIndex < quizQuestions.length) {
          loadQuizQuestion();
        } else {
          showFeedback("Quiz completed!", "success");
          switchMode("flashcards");
        }
      }

      // Enhanced initialization with performance optimizations
      document.addEventListener("DOMContentLoaded", function () {
        // Initialize progress from localStorage
        updateProgressDisplay();
        updateSessionStats();
        updateFlashcard();
        changeDifficulty();

        // Ensure flashcard mode is visible by default
        switchMode("flashcards", null);

        // Force visibility of flashcard elements as backup
        const flashcardMode = document.getElementById("flashcard-mode");
        const flashcardCarousel = document.getElementById("flashcard-carousel");
        const flashcard = document.querySelector(".flashcard");

        if (flashcardMode) flashcardMode.style.display = "block";
        if (flashcardCarousel) flashcardCarousel.style.display = "flex";
        if (flashcard) {
          flashcard.style.display = "block";
          flashcard.style.visibility = "visible";
          flashcard.style.opacity = "1";
        }

        // Initialize audio first
        audioEnabled = true;
        document.getElementById("audio-enabled").checked = true;

        // Load user preferences (may override defaults)
        loadUserPreferences();

        // Load voices for better audio
        if (speechSynthesis.getVoices().length === 0) {
          speechSynthesis.addEventListener("voiceschanged", loadVoices);
        } else {
          loadVoices();
        }

        // Set up session timer (optimized to run less frequently)
        setInterval(updateSessionStats, 2000);

        // Keyboard shortcuts are now shown in the main interface

        // Add mobile menu functionality
        const mobileToggle = document.getElementById("mobileToggle");
        const navLinks = document.getElementById("navLinks");

        if (mobileToggle && navLinks) {
          mobileToggle.addEventListener("click", () => {
            navLinks.classList.toggle("active");
            const isOpen = navLinks.classList.contains("active");
            mobileToggle.innerHTML = isOpen
              ? '<i class="fas fa-times"></i>'
              : '<i class="fas fa-bars"></i>';
          });

          // Close mobile menu when clicking outside
          document.addEventListener("click", (e) => {
            if (
              !e.target.closest(".navbar") &&
              navLinks.classList.contains("active")
            ) {
              navLinks.classList.remove("active");
              mobileToggle.innerHTML = '<i class="fas fa-bars"></i>';
            }
          });
        }

        // Show enhanced welcome message for new users
        if (userProgress.studySessions === 0) {
          setTimeout(() => {
            showFeedback(
              "🇹🇭 Welcome to Thai Flashcards! Click a card to flip it, use keyboard shortcuts, and listen to pronunciations!",
              "success",
              4000
            );
          }, 1500);

          // Show additional tip after welcome
          setTimeout(() => {
            showFeedback(
              "💡 Tip: Audio is enabled by default - listen carefully to master Thai tones!",
              "info",
              3000
            );
          }, 6000);
        }

        // Add smooth scrolling
        document.documentElement.style.scrollBehavior = "smooth";
      });

      function loadUserPreferences() {
        const preferences =
          JSON.parse(localStorage.getItem("thaiFlashcardPreferences")) || {};

        if (preferences.audioEnabled !== undefined) {
          audioEnabled = preferences.audioEnabled;
          document.getElementById("audio-enabled").checked = audioEnabled;
        } else {
          // Default to enabled if no preference set
          audioEnabled = true;
          document.getElementById("audio-enabled").checked = true;
        }

        if (preferences.volume !== undefined) {
          voiceVolume = preferences.volume;
          document.getElementById("volume-slider").value = voiceVolume;
        }

        if (preferences.autoAdvance !== undefined) {
          document.getElementById("auto-advance").checked =
            preferences.autoAdvance;
        }

        if (preferences.showPhonetics !== undefined) {
          document.getElementById("show-phonetics").checked =
            preferences.showPhonetics;
        }

        if (preferences.difficulty !== undefined) {
          currentDifficulty = preferences.difficulty;
          document.getElementById("difficulty-level").value = currentDifficulty;
        }
      }

      function saveUserPreferences() {
        const preferences = {
          audioEnabled: document.getElementById("audio-enabled").checked,
          volume: document.getElementById("volume-slider").value,
          autoAdvance: document.getElementById("auto-advance").checked,
          showPhonetics: document.getElementById("show-phonetics").checked,
          difficulty: document.getElementById("difficulty-level").value,
        };

        localStorage.setItem(
          "thaiFlashcardPreferences",
          JSON.stringify(preferences)
        );
      }

      // Enhanced keyboard navigation
      document.addEventListener("keydown", function (event) {
        // Prevent shortcuts when typing in inputs
        if (
          event.target.tagName === "INPUT" ||
          event.target.tagName === "SELECT"
        ) {
          return;
        }

        if (event.code === "Space") {
          event.preventDefault();
          flipCard(document.querySelector(".flashcard"));
        } else if (event.code === "ArrowRight" || event.code === "ArrowDown") {
          event.preventDefault();
          nextFlashcard();
        } else if (event.code === "ArrowLeft" || event.code === "ArrowUp") {
          event.preventDefault();
          flashcardIndex =
            (flashcardIndex - 1 + flashcards.length) % flashcards.length;
          updateFlashcard();
        } else if (event.code === "Digit1") {
          event.preventDefault();
          markCard(false);
        } else if (event.code === "Digit2") {
          event.preventDefault();
          markCard("medium");
        } else if (event.code === "Digit3") {
          event.preventDefault();
          markCard(true);
        } else if (event.code === "KeyS") {
          event.preventDefault();
          toggleSettings();
        } else if (event.code === "KeyP") {
          event.preventDefault();
          const currentCard = flashcards[flashcardIndex];
          speakThai(currentCard.thai);
        } else if (event.code === "Escape") {
          document.getElementById("settings-panel").classList.remove("open");
        }
      });

      // Enhanced feedback system
      function showFeedback(message, type, duration = 2000) {
        // Remove existing notifications
        document.querySelectorAll(".notification").forEach((n) => n.remove());

        const notification = document.createElement("div");
        notification.className = `notification notification-${type}`;

        let icon = "";
        let bgColor = "";

        switch (type) {
          case "success":
            icon = '<i class="fas fa-check-circle"></i>';
            bgColor = "linear-gradient(135deg, var(--success), #20c997)";
            break;
          case "warning":
            icon = '<i class="fas fa-exclamation-triangle"></i>';
            bgColor = "linear-gradient(135deg, var(--warning), #f39c12)";
            break;
          case "danger":
            icon = '<i class="fas fa-times-circle"></i>';
            bgColor = "linear-gradient(135deg, var(--danger), #e74c3c)";
            break;
          case "info":
            icon = '<i class="fas fa-info-circle"></i>';
            bgColor = "linear-gradient(135deg, var(--info), #138496)";
            break;
        }

        notification.innerHTML = `${icon}<span>${message}</span>`;
        notification.style.background = bgColor;

        document.body.appendChild(notification);

        // Auto-remove notification
        setTimeout(() => {
          notification.style.animation = "slideInRight 0.3s ease reverse";
          setTimeout(() => notification.remove(), 300);
        }, duration);

        // Save preferences when settings change
        saveUserPreferences();
      }

      // Add service worker for offline functionality (if needed)
      if ("serviceWorker" in navigator) {
        window.addEventListener("load", function () {
          // Uncomment to enable offline functionality
          // navigator.serviceWorker.register('/sw.js');
        });
      }

      // Simple flashcard functions
      let isFlipped = false;
      
      function flipSimpleCard() {
        const hint = document.getElementById("flashcard-hint");
        const answer = document.getElementById("flashcard-answer");
        
        if (!isFlipped) {
          hint.style.display = "none";
          answer.style.display = "block";
          isFlipped = true;
        } else {
          hint.style.display = "block";
          answer.style.display = "none";
          isFlipped = false;
        }
      }
      
      function updateFlashcard() {
        const card = flashcards[flashcardIndex];
        document.getElementById("flashcard-thai").textContent = card.thai;
        document.getElementById("flashcard-phonetic").textContent = card.phonetic;
        document.getElementById("flashcard-answer").textContent = card.answer;
        document.getElementById("flashcard-current").textContent = flashcardIndex + 1;
        document.getElementById("flashcard-total").textContent = flashcards.length;

        // Reset simple card state
        document.getElementById("flashcard-hint").style.display = "block";
        document.getElementById("flashcard-answer").style.display = "none";
        isFlipped = false;

        // Hide phonetics if setting is disabled
        const showPhonetics = document.getElementById("show-phonetics") ? document.getElementById("show-phonetics").checked : true;
        const phoneticElement = document.getElementById("flashcard-phonetic");
        if (phoneticElement) {
          phoneticElement.style.display = showPhonetics ? "block" : "none";
        }

        // Track card start time for performance analytics
        sessionStats.cardStartTime = Date.now();

        // Auto-play pronunciation if enabled
        if (audioEnabled) {
          setTimeout(() => speakThai(card.thai), 500);
        }
      }

      function nextFlashcard() {
        flashcardIndex = (flashcardIndex + 1) % flashcards.length;
        updateFlashcard();
      }

      function flipCard(card) {
        // Use simple flip function instead
        flipSimpleCard();
        
        // Add haptic feedback on mobile
        if (navigator.vibrate) {
          navigator.vibrate(50);
        }
      }

      function startFlashcards() {
        document.getElementById("flashcard-carousel").scrollIntoView({
          behavior: "smooth",
        });

        // Start session timer and update daily streak
        sessionStats.startTime = Date.now();
        userProgress.studySessions++;
        updateDailyStreak();

        showFeedback("Study session started! 📚", "success");
      }

      // Update daily study streak
      function updateDailyStreak() {
        const today = new Date().toDateString();
        const yesterday = new Date(
          Date.now() - 24 * 60 * 60 * 1000
        ).toDateString();

        if (userProgress.lastStudyDate === today) {
          // Already studied today, no change
          return;
        }

        if (userProgress.lastStudyDate === yesterday) {
          // Studied yesterday, continue streak
          userProgress.dailyStreak++;
        } else if (userProgress.lastStudyDate === null) {
          // First time studying
          userProgress.dailyStreak = 1;
        } else {
          // Streak broken, reset
          userProgress.dailyStreak = 1;
        }

        userProgress.lastStudyDate = today;

        // Update longest streak record
        if (userProgress.dailyStreak > userProgress.longestStreak) {
          userProgress.longestStreak = userProgress.dailyStreak;
          if (userProgress.dailyStreak >= 7) {
            showFeedback(
              `🔥 New record! ${userProgress.dailyStreak} day streak!`,
              "success"
            );
          }
        }

        localStorage.setItem(
          "thaiFlashcardProgress",
          JSON.stringify(userProgress)
        );
      }

      function updateProgressStats() {
        updateProgressDisplay();
      }

      function updateProgress() {
        showFeedback("Progress updated! 📊", "info");
        updateProgressDisplay();
      }

      // Writing Mode Functions
      let writingCanvas, writingCtx;
      let writingExercises = [];
      let currentWritingIndex = 0;
      let isDrawing = false;

      function initWritingMode() {
        writingCanvas = document.getElementById('writing-canvas');
        writingCtx = writingCanvas.getContext('2d');
        
        // Set up canvas for drawing
        writingCtx.strokeStyle = '#333';
        writingCtx.lineWidth = 3;
        writingCtx.lineCap = 'round';
        
        // Create writing exercises from flashcard data
        writingExercises = flashcards.slice(0, 10).map(card => ({
          english: card.answer,
          phonetic: card.phonetic,
          thai: card.thai
        }));
        
        loadWritingExercise();
        setupCanvasEvents();
      }

      function setupCanvasEvents() {
        let rect = writingCanvas.getBoundingClientRect();
        
        writingCanvas.addEventListener('mousedown', startDrawing);
        writingCanvas.addEventListener('mousemove', draw);
        writingCanvas.addEventListener('mouseup', stopDrawing);
        writingCanvas.addEventListener('mouseout', stopDrawing);
        
        // Touch events for mobile
        writingCanvas.addEventListener('touchstart', (e) => {
          e.preventDefault();
          const touch = e.touches[0];
          const mouseEvent = new MouseEvent('mousedown', {
            clientX: touch.clientX,
            clientY: touch.clientY
          });
          writingCanvas.dispatchEvent(mouseEvent);
        });
        
        writingCanvas.addEventListener('touchmove', (e) => {
          e.preventDefault();
          const touch = e.touches[0];
          const mouseEvent = new MouseEvent('mousemove', {
            clientX: touch.clientX,
            clientY: touch.clientY
          });
          writingCanvas.dispatchEvent(mouseEvent);
        });
        
        writingCanvas.addEventListener('touchend', (e) => {
          e.preventDefault();
          const mouseEvent = new MouseEvent('mouseup', {});
          writingCanvas.dispatchEvent(mouseEvent);
        });
      }

      function startDrawing(e) {
        isDrawing = true;
        const rect = writingCanvas.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;
        writingCtx.beginPath();
        writingCtx.moveTo(x, y);
      }

      function draw(e) {
        if (!isDrawing) return;
        
        const rect = writingCanvas.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;
        
        writingCtx.lineTo(x, y);
        writingCtx.stroke();
      }

      function stopDrawing() {
        isDrawing = false;
      }

      function clearCanvas() {
        writingCtx.clearRect(0, 0, writingCanvas.width, writingCanvas.height);
      }

      function loadWritingExercise() {
        const exercise = writingExercises[currentWritingIndex];
        document.getElementById('writing-english').textContent = exercise.english;
        document.getElementById('writing-phonetic').textContent = exercise.phonetic;
        document.getElementById('writing-answer').textContent = exercise.thai;
        document.getElementById('writing-current').textContent = currentWritingIndex + 1;
        document.getElementById('writing-total').textContent = writingExercises.length;
        document.getElementById('writing-hint').style.display = 'none';
        clearCanvas();
      }

      function showWritingHint() {
        document.getElementById('writing-hint').style.display = 'block';
        showFeedback("Practice writing the Thai characters above!", "info");
      }

      function nextWritingExercise() {
        showFeedback("Great practice! ✍️", "success");
        currentWritingIndex = (currentWritingIndex + 1) % writingExercises.length;
        loadWritingExercise();
      }

      // Conversation Mode Functions
      let conversationScenarios = [
        {
          title: "🏪 At the Market",
          description: "You want to buy some fruit at a local Thai market.",
          dialogue: [
            {
              speaker: "you",
              thai: "ส้มราคาเท่าไหร่ครับ?",
              phonetic: "sôm raa-kaa tâo-rài kráp?",
              english: "How much are the oranges?"
            },
            {
              speaker: "vendor",
              thai: "ใบละสิบบาทค่ะ",
              phonetic: "bai lá sìp baat kâ",
              english: "Ten baht each."
            }
          ],
          options: [
            {
              thai: "เอาสามใบครับ",
              phonetic: "ao sǎam bai kráp",
              english: "I'll take three.",
              correct: true
            },
            {
              thai: "แพงเกินไปครับ",
              phonetic: "paeng gəən bpai kráp",
              english: "Too expensive.",
              correct: false
            }
          ],
          culturalTip: "In Thai markets, bargaining is common and expected. Vendors often start with higher prices, and polite negotiation is part of the cultural experience. Using 'ครับ/ค่ะ' shows respect and often leads to better prices!"
        },
        {
          title: "🍜 Ordering Food",
          description: "You're at a Thai restaurant and want to order.",
          dialogue: [
            {
              speaker: "waiter",
              thai: "สั่งอะไรดีครับ?",
              phonetic: "sàng à-rai dii kráp?",
              english: "What would you like to order?"
            }
          ],
          options: [
            {
              thai: "ขอผัดไทยหนึ่งจานครับ",
              phonetic: "kǒr pàt-tai nɯ̀ng jaan kráp",
              english: "I'd like one plate of Pad Thai, please.",
              correct: true
            },
            {
              thai: "ไม่เป็นไรครับ",
              phonetic: "mâi bpen rai kráp",
              english: "It's okay.",
              correct: false
            }
          ],
          culturalTip: "When ordering food in Thailand, it's polite to use 'ขอ' (kǒr) meaning 'please give me' rather than direct commands. Thai people appreciate politeness!"
        }
      ];
      
      let currentConversationIndex = 0;

      function initConversationMode() {
        loadConversationScenario();
      }

      function loadConversationScenario() {
        const scenario = conversationScenarios[currentConversationIndex];
        document.getElementById('conversation-current').textContent = currentConversationIndex + 1;
        document.getElementById('conversation-total').textContent = conversationScenarios.length;
        
        // Update scenario info
        const scenarioDiv = document.getElementById('conversation-scenario');
        scenarioDiv.innerHTML = `
          <h3 style="color: var(--primary); margin-bottom: 1rem;">${scenario.title}</h3>
          <p style="color: var(--text-secondary); font-size: 1.1rem; line-height: 1.6;">${scenario.description}</p>
        `;
        
        // Update dialogue
        const dialogueDiv = document.getElementById('conversation-dialogue');
        let dialogueHTML = '';
        
        scenario.dialogue.forEach(line => {
          const isUser = line.speaker === 'you';
          const icon = isUser ? 'fa-user' : 'fa-store';
          const color = isUser ? 'var(--primary)' : 'var(--secondary)';
          const bgColor = isUser ? 'var(--primary-light)' : 'var(--secondary-light)';
          const alignment = isUser ? 'flex-direction: row' : 'flex-direction: row-reverse';
          const textAlign = isUser ? 'left' : 'right';
          const marginSide = isUser ? 'margin-left: 1rem' : 'margin-right: 1rem';
          
          dialogueHTML += `
            <div class="conversation-line" style="margin-bottom: 1.5rem; display: flex; align-items: center; gap: 1rem; ${alignment}">
              <div style="width: 40px; height: 40px; background: ${color}; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                <i class="fas ${icon}"></i>
              </div>
              <div style="flex: 1; text-align: ${textAlign};">
                <div style="background: ${bgColor}; padding: 1rem; border-radius: var(--border-radius); margin-bottom: 0.5rem;">
                  <div style="font-size: 1.3rem; color: ${color}; margin-bottom: 0.5rem;">${line.thai}</div>
                  <div style="font-style: italic; color: var(--text-secondary);">${line.phonetic}</div>
                </div>
                <small style="color: var(--text-muted);">${line.english}</small>
                <button onclick="speakThai('${line.thai}')" style="${marginSide}; background: none; border: none; color: ${color}; cursor: pointer; font-size: 1.1rem;">
                  <i class="fas fa-volume-up"></i>
                </button>
              </div>
            </div>
          `;
        });
        
        dialogueDiv.innerHTML = dialogueHTML;
        
        // Update options (assuming we show options after dialogue)
        updateConversationOptions();
      }

      function updateConversationOptions() {
        const scenario = conversationScenarios[currentConversationIndex];
        // Options are already in HTML, just need to update the onclick handlers
        const optionsContainer = document.querySelector('#conversation-mode .conversation-option').parentElement;
        optionsContainer.innerHTML = '';
        
        scenario.options.forEach(option => {
          const button = document.createElement('button');
          button.className = 'conversation-option';
          button.style.cssText = 'padding: 1rem; background: white; border: 2px solid var(--border-color); border-radius: var(--border-radius); cursor: pointer; transition: all 0.3s ease;';
          button.onclick = () => selectConversationOption(button, option.correct);
          
          button.innerHTML = `
            <div style="font-size: 1.2rem; color: var(--primary); margin-bottom: 0.5rem;">${option.thai}</div>
            <div style="font-style: italic; color: var(--text-secondary); margin-bottom: 0.5rem;">${option.phonetic}</div>
            <small style="color: var(--text-muted);">${option.english}</small>
          `;
          
          optionsContainer.appendChild(button);
        });
      }

      function selectConversationOption(button, isCorrect) {
        // Remove previous selections
        document.querySelectorAll('.conversation-option').forEach(opt => {
          opt.style.borderColor = 'var(--border-color)';
          opt.style.background = 'white';
        });
        
        // Highlight selection
        if (isCorrect) {
          button.style.borderColor = 'var(--success)';
          button.style.background = 'var(--success-light)';
          showFeedback("Great choice! 👍", "success");
        } else {
          button.style.borderColor = 'var(--danger)';
          button.style.background = 'rgba(239, 68, 68, 0.1)';
          showFeedback("Try the other option for better results!", "warning");
        }
      }

      function showConversationHint() {
        const scenario = conversationScenarios[currentConversationIndex];
        const hintDiv = document.getElementById('conversation-hint');
        document.getElementById('cultural-explanation-text').textContent = scenario.culturalTip;
        hintDiv.style.display = hintDiv.style.display === 'block' ? 'none' : 'block';
      }

      function nextConversationScenario() {
        currentConversationIndex = (currentConversationIndex + 1) % conversationScenarios.length;
        loadConversationScenario();
        document.getElementById('conversation-hint').style.display = 'none';
      }

      // Cultural Quiz Functions
      let culturalQuestions = [
        {
          question: "What should you do when entering a Thai temple?",
          options: ["Keep your shoes on", "Remove your shoes", "Wear a hat", "Speak loudly"],
          correct: 1,
          explanation: "In Thai culture, shoes are considered unclean and must be removed before entering temples, homes, and some shops. This shows respect for sacred spaces."
        },
        {
          question: "How do you show respect when greeting elders in Thailand?",
          options: ["Shake hands firmly", "Wave casually", "Wai with hands higher", "Bow deeply"],
          correct: 2,
          explanation: "The wai (pressing palms together) with hands held higher shows more respect. For elders, monks, and people of higher status, raise your hands to chest or forehead level."
        },
        {
          question: "What does 'ครับ/ค่ะ' add to your speech?",
          options: ["Makes it louder", "Shows politeness", "Changes meaning", "Adds emphasis"],
          correct: 1,
          explanation: "ครับ (for males) and ค่ะ (for females) are polite particles that show respect and courtesy. Using them makes you sound more polite and respectful."
        }
      ];
      
      let currentCulturalIndex = 0;

      function selectCulturalAnswer(button, isCorrect) {
        // Remove previous selections
        document.querySelectorAll('.cultural-option').forEach(opt => {
          opt.style.borderColor = 'var(--border-color)';
          opt.style.background = 'var(--bg-secondary)';
        });
        
        // Show correct/incorrect
        if (isCorrect) {
          button.style.borderColor = 'var(--success)';
          button.style.background = 'var(--success-light)';
        } else {
          button.style.borderColor = 'var(--danger)';
          button.style.background = 'rgba(239, 68, 68, 0.1)';
          
          // Highlight correct answer
          const correctIndex = culturalQuestions[currentCulturalIndex].correct;
          const correctButton = document.querySelectorAll('.cultural-option')[correctIndex];
          correctButton.style.borderColor = 'var(--success)';
          correctButton.style.background = 'var(--success-light)';
        }
        
        // Show explanation
        const explanationDiv = document.getElementById('cultural-explanation');
        const explanationText = document.getElementById('cultural-explanation-text');
        explanationText.textContent = culturalQuestions[currentCulturalIndex].explanation;
        explanationDiv.style.display = 'block';
        
        // Show next button
        document.getElementById('cultural-next').style.display = 'inline-flex';
        
        // Disable all options
        document.querySelectorAll('.cultural-option').forEach(opt => {
          opt.style.pointerEvents = 'none';
        });
      }

      function nextCulturalQuestion() {
        currentCulturalIndex = (currentCulturalIndex + 1) % culturalQuestions.length;
        loadCulturalQuestion();
      }

      function loadCulturalQuestion() {
        const question = culturalQuestions[currentCulturalIndex];
        document.getElementById('cultural-question').textContent = question.question;
        
        const options = document.querySelectorAll('.cultural-option');
        options.forEach((opt, index) => {
          opt.textContent = question.options[index];
          opt.style.borderColor = 'var(--border-color)';
          opt.style.background = 'var(--bg-secondary)';
          opt.style.pointerEvents = 'auto';
          opt.onclick = () => selectCulturalAnswer(opt, index === question.correct);
        });
        
        document.getElementById('cultural-explanation').style.display = 'none';
        document.getElementById('cultural-next').style.display = 'none';
      }

      // Vocabulary Categories Functions
      let selectedCategory = 'all';
      let categoryColors = {
        'greetings': 'var(--primary)',
        'food': 'var(--secondary)', 
        'family': 'var(--accent)',
        'colors': 'var(--success)',
        'numbers': 'var(--info)',
        'verbs': 'var(--warning)',
        'adjectives': 'var(--danger)',
        'places': '#8b5fbf',
        'time': '#20c997',
        'emotions': '#fd7e14'
      };

      function filterVocabulary(category) {
        selectedCategory = category;
        
        // Update filter buttons
        document.querySelectorAll('.category-filter').forEach(btn => {
          btn.classList.remove('active');
          const btnColor = btn.textContent.toLowerCase().includes('greetings') ? 'var(--primary)' :
                          btn.textContent.toLowerCase().includes('food') ? 'var(--secondary)' :
                          btn.textContent.toLowerCase().includes('family') ? 'var(--accent)' :
                          btn.textContent.toLowerCase().includes('colors') ? 'var(--success)' :
                          btn.textContent.toLowerCase().includes('numbers') ? 'var(--info)' : 'var(--primary)';
          btn.style.background = 'transparent';
          btn.style.color = btnColor;
        });
        
        // Activate selected button
        event.target.classList.add('active');
        const activeColor = category === 'all' ? 'var(--primary)' : categoryColors[category] || 'var(--primary)';
        event.target.style.background = activeColor;
        event.target.style.color = 'white';
        
        // Update vocabulary grid
        updateVocabularyGrid();
        
        // Update study button
        const studyBtn = document.getElementById('study-category-btn');
        studyBtn.innerHTML = `<i class="fas fa-play"></i> Study ${category === 'all' ? 'All Categories' : category.charAt(0).toUpperCase() + category.slice(1)}`;
      }

      function updateVocabularyGrid() {
        const grid = document.getElementById('vocabulary-grid');
        const allCards = Object.values(flashcardData).flat();
        
        let filteredCards = selectedCategory === 'all' ? 
          allCards : 
          allCards.filter(card => card.category === selectedCategory);
        
        grid.innerHTML = '';
        
        filteredCards.slice(0, 20).forEach(card => {
          const cardColor = categoryColors[card.category] || 'var(--primary)';
          const cardDiv = document.createElement('div');
          cardDiv.style.cssText = `
            background: white;
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            border-left: 4px solid ${cardColor};
            transition: all 0.3s ease;
            cursor: pointer;
          `;
          
          cardDiv.innerHTML = `
            <div style="display: flex; justify-content: between; align-items: center; margin-bottom: 1rem;">
              <span style="background: ${cardColor}; color: white; padding: 0.3rem 0.8rem; border-radius: 15px; font-size: 0.8rem; font-weight: 600;">
                ${card.category}
              </span>
              <button onclick="speakThai('${card.thai}')" style="background: none; border: none; color: ${cardColor}; cursor: pointer; font-size: 1.2rem;">
                <i class="fas fa-volume-up"></i>
              </button>
            </div>
            <div style="text-align: center;">
              <div style="font-size: 2rem; color: ${cardColor}; margin-bottom: 0.5rem;">${card.thai}</div>
              <div style="font-style: italic; color: var(--text-secondary); margin-bottom: 0.5rem;">${card.phonetic}</div>
              <div style="color: var(--text-primary); font-weight: 600;">${card.answer}</div>
            </div>
          `;
          
          cardDiv.onmouseenter = () => {
            cardDiv.style.transform = 'translateY(-4px)';
            cardDiv.style.boxShadow = '0 8px 20px rgba(0,0,0,0.15)';
          };
          
          cardDiv.onmouseleave = () => {
            cardDiv.style.transform = 'translateY(0)';
            cardDiv.style.boxShadow = '0 4px 8px rgba(0,0,0,0.1)';
          };
          
          grid.appendChild(cardDiv);
        });
        
        if (filteredCards.length === 0) {
          grid.innerHTML = '<p style="text-align: center; color: var(--text-muted); grid-column: 1 / -1;">No vocabulary found for this category.</p>';
        }
      }

      function studyCategoryFlashcards() {
        if (selectedCategory !== 'all') {
          // Filter flashcards by category
          flashcards = flashcardData[currentDifficulty].filter(card => card.category === selectedCategory);
          if (flashcards.length === 0) {
            showFeedback("No cards found in this category for current difficulty level!", "warning");
            return;
          }
        } else {
          flashcards = flashcardData[currentDifficulty];
        }
        
        flashcardIndex = 0;
        switchMode('flashcards', null);
        updateFlashcard();
        document.getElementById('flashcard-mode').scrollIntoView({behavior: 'smooth'});
        showFeedback(`Studying ${selectedCategory === 'all' ? 'all categories' : selectedCategory}! 📚`, "success");
      }

      // Initialize vocabulary grid on page load
      document.addEventListener('DOMContentLoaded', function() {
        // Existing initialization code...
        
        // Initialize vocabulary categories
        setTimeout(() => {
          updateVocabularyGrid();
        }, 1000);
      });
    </script>
  </body>
</html>
