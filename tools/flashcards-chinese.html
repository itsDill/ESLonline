<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="Learn Chinese basics with interactive flashcards. Master essential Chinese characters, phrases, and vocabulary with our engaging learning tool."
    />
    <meta
      name="keywords"
      content="Chinese flashcards, learn Chinese, Chinese characters, Chinese vocabulary, Mandarin basics, Chinese language learning"
    />
    <meta name="author" content="ESL Fun Online" />
    <title>
      Chinese Basics Flashcards | ESL Fun Online - Learn Chinese Interactive
    </title>
        <!-- Favicon and Icons - Optimized for Google Search -->
    <link rel="icon" href="../favicon.ico" sizes="any" />
    <link rel="icon" type="image/png" sizes="16x16" href="../images/favicon-16x16.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="../images/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="48x48" href="../images/favicon-48x48.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="../images/1.png" />
    <link rel="icon" type="image/png" sizes="192x192" href="../images/favicon-192x192.png" />
    <link rel="icon" type="image/png" sizes="512x512" href="../images/favicon-512x512.png" />


    <!-- Header -->
    <header>
      <div class="container">
        <nav class="navbar">
          <a href="../index.html" class="logo-container">
            <img
              src="../images/1.png"
              alt="ESL Fun Online Logo"
              class="logo-image"
              width="40"
              height="40"
            />
            <span class="logo-text">ESL Fun Online</span>
          </a>
          <ul class="nav-links" id="navLinks">
            <li>
              <a href="../index.html" class="nav-link"
                ><i class="fas fa-home"></i> Home</a
              >
            </li>
            <li>
              <a href="../tools/tools.html" class="nav-link"
                ><i class="fas fa-tools"></i> Tools</a
              >
            </li>
            <li>
              <a href="../games/games.html" class="nav-link"
                ><i class="fas fa-gamepad"></i> Games</a
              >
            </li>
          </ul>
          <div class="controls">
            <button class="control-btn theme-toggle" id="themeToggle">
              <i class="fas fa-moon"></i>
            </button>
          </div>
        </nav>
      </div>
    </header>

    <!-- Immediate Mobile Menu Script - Inline for guaranteed execution -->
    <script>
      (function () {
        "use strict";

        function initMobileMenu() {
          const mobileToggle = document.getElementById("mobileToggle");
          const navLinks = document.getElementById("navLinks");
          const body = document.body;

          if (!mobileToggle || !navLinks) {
            console.warn("Mobile menu elements not found");
            return;
          }

          console.log("Immediate mobile menu initialized");

          let isMenuOpen = false;

          function toggleMenu(e) {
            if (e && e.preventDefault) e.preventDefault();
            if (e && e.stopPropagation) e.stopPropagation();

            isMenuOpen = !isMenuOpen;
            const icon = mobileToggle.querySelector("i");

            if (isMenuOpen) {
              navLinks.classList.add("active");
              body.classList.add("mobile-menu-open");
              body.style.overflow = "hidden";
              if (icon) icon.className = "fas fa-times";
              console.log("Menu opened");
            } else {
              navLinks.classList.remove("active");
              body.classList.remove("mobile-menu-open");
              body.style.overflow = "";
              if (icon) icon.className = "fas fa-bars";
              console.log("Menu closed");

              // Close all dropdowns
              document.querySelectorAll(".nav-item").forEach((item) => {
                item.classList.remove("mobile-open", "mobile-dropdown-open");
                const chevron = item.querySelector(".fa-chevron-down");
                if (chevron) chevron.style.transform = "rotate(0deg)";
              });
            }
          }

          // Simple unified handler - works for both touch and click
          let lastToggleTime = 0;
          
          function handleToggleClick(e) {
            const now = Date.now();
            // Prevent double-firing within 300ms
            if (now - lastToggleTime < 300) {
              console.log("Toggle ignored - too fast");
              return;
            }
            lastToggleTime = now;
            
            e.preventDefault();
            e.stopPropagation();
            console.log("Hamburger clicked/tapped");
            toggleMenu(e);
          }

          mobileToggle.addEventListener("click", handleToggleClick);
          mobileToggle.addEventListener("touchend", handleToggleClick);

          // Handle dropdown toggles on mobile
          document.querySelectorAll(".nav-item").forEach((item) => {
            const link = item.querySelector(".nav-link");
            const dropdown = item.querySelector(".dropdown");
            const chevron = link?.querySelector(".fa-chevron-down");

            // Only add special handling for links WITH dropdowns
            if (link && dropdown && chevron) {
              // Simple unified dropdown handler
              let lastDropdownToggle = 0;
              
              function handleDropdownClick(e) {
                if (window.innerWidth > 768) return; // Only on mobile
                
                const now = Date.now();
                // Prevent double-firing within 300ms
                if (now - lastDropdownToggle < 300) {
                  console.log("Dropdown toggle ignored - too fast");
                  return;
                }
                lastDropdownToggle = now;
                
                e.preventDefault();
                e.stopPropagation();

                const isOpen = item.classList.contains("mobile-open");
                console.log("Dropdown clicked:", isOpen ? "closing" : "opening");

                // Close other dropdowns
                document.querySelectorAll(".nav-item").forEach((otherItem) => {
                  if (otherItem !== item) {
                    otherItem.classList.remove("mobile-open", "mobile-dropdown-open");
                    const otherChevron = otherItem.querySelector(".fa-chevron-down");
                    if (otherChevron) otherChevron.style.transform = "rotate(0deg)";
                  }
                });

                // Toggle current dropdown
                if (isOpen) {
                  item.classList.remove("mobile-open", "mobile-dropdown-open");
                  chevron.style.transform = "rotate(0deg)";
                  link.setAttribute("aria-expanded", "false");
                } else {
                  item.classList.add("mobile-open", "mobile-dropdown-open");
                  chevron.style.transform = "rotate(180deg)";
                  link.setAttribute("aria-expanded", "true");
                }
              }

              // Remove href="#" behavior on mobile
              if (link.getAttribute("href") === "#") {
                link.style.cursor = "pointer";
              }

              // Attach handlers for both click and touch
              link.addEventListener("click", handleDropdownClick);
              link.addEventListener("touchend", handleDropdownClick);
            }
          });

          // Close menu when clicking outside
          document.addEventListener("click", function (e) {
            if (window.innerWidth <= 768 && isMenuOpen) {
              if (
                !mobileToggle.contains(e.target) &&
                !navLinks.contains(e.target)
              ) {
                toggleMenu(null);
              }
            }
          });

          // Close menu on escape key
          document.addEventListener("keydown", function (e) {
            if (e.key === "Escape" && isMenuOpen) {
              toggleMenu(null);
              mobileToggle.focus();
            }
          });

          // Close menu on window resize to desktop
          window.addEventListener("resize", function () {
            if (window.innerWidth > 768 && isMenuOpen) {
              toggleMenu(null);
            }
          });

          // Close menu after dropdown link click
          document.querySelectorAll(".dropdown a").forEach((link) => {
            link.addEventListener("click", function () {
              if (window.innerWidth <= 768 && isMenuOpen) {
                setTimeout(() => {
                  toggleMenu(null);
                }, 100);
              }
            });
          });
        }

        // Initialize immediately if DOM is ready, otherwise wait
        if (document.readyState === "loading") {
          document.addEventListener("DOMContentLoaded", initMobileMenu);
        } else {
          initMobileMenu();
        }
      })();
    </script>

    <!-- Additional Mobile Dropdown Fixes -->
    <style>
      /* Ensure mobile dropdowns work properly */
      @media (max-width: 768px) {
        /* FORCE mobile menu to display full width */
        .nav-links,
        #navLinks,
        ul.nav-links {
          display: flex !important;
          position: fixed !important;
          top: 70px !important;
          left: 0 !important;
          right: 0 !important;
          bottom: 0 !important;
          width: 100vw !important;
          height: auto !important;
          min-height: calc(100vh - 70px) !important;
        }

        .nav-links.active,
        #navLinks.active,
        ul.nav-links.active {
          display: flex !important;
          max-height: calc(100vh - 70px) !important;
          height: auto !important;
        }

        /* Make sure nav links with dropdowns are clearly tappable */
        .nav-item .nav-link {
          position: relative;
          user-select: none;
          -webkit-user-select: none;
          -webkit-tap-highlight-color: rgba(70, 187, 229, 0.2);
          cursor: pointer;
        }

        /* Ensure chevron is visible and clickable */
        .nav-link .fa-chevron-down {
          transition: transform 0.3s ease !important;
          opacity: 1 !important;
          pointer-events: none; /* Let clicks go through to parent link */
        }

        /* Visual feedback when dropdown is open */
        .nav-item.mobile-open > .nav-link,
        .nav-item.mobile-dropdown-open > .nav-link {
          background: rgba(70, 187, 229, 0.15) !important;
          border-color: var(--primary-color, #46bbe5) !important;
        }

        /* Make dropdowns smoother */
        .dropdown {
          transition: max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1),
            padding 0.4s cubic-bezier(0.4, 0, 0.2, 1) !important;
        }

        /* Ensure dropdown items are visible when parent is open */
        .nav-item.mobile-open .dropdown,
        .nav-item.mobile-dropdown-open .dropdown {
          display: block !important;
          visibility: visible !important;
          opacity: 1 !important;
          pointer-events: auto !important;
        }

        /* Override any conflicting hover states */
        .nav-item:hover .dropdown {
          max-height: 0 !important;
          padding: 0 !important;
        }

        .nav-item.mobile-open:hover .dropdown,
        .nav-item.mobile-dropdown-open:hover .dropdown {
          max-height: 600px !important;
          padding: 0.75rem 0.5rem !important;
        }
      }
    </style>



    <main>
      <div class="container">
        <div style="text-align: center; margin: 2rem 0">
          <h1
            style="
              font-size: 3rem;
              font-weight: 700;
              color: var(--text-primary);
              margin-bottom: 1rem;
            "
          >
            üá®üá≥ Chinese Basics Flashcards
          </h1>
          <p style="font-size: 1.2rem; color: var(--text-secondary)">
            Learn essential Chinese characters, pinyin, and vocabulary with
            interactive flashcards
          </p>
        </div>

        <div class="difficulty-selector">
          <h3>Choose Level:</h3>
          <button class="difficulty-btn active" data-level="beginner">
            Beginner
          </button>
          <button class="difficulty-btn" data-level="intermediate">
            Intermediate
          </button>
          <button class="difficulty-btn" data-level="advanced">Advanced</button>
        </div>

        <div class="stats-container">
          <div class="stat-card">
            <div class="stat-value" id="currentCard">1</div>
            <div class="stat-label">Current Card</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="totalCards">20</div>
            <div class="stat-label">Total Cards</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="correctAnswers">0</div>
            <div class="stat-label">Correct</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="accuracy">100</div>
            <div class="stat-label">Accuracy %</div>
          </div>
        </div>

        <div class="progress-bar">
          <div class="progress-fill" id="progressFill"></div>
        </div>

        <div class="flashcard-container">
          <div class="flashcard" id="flashcard">
            <div class="flashcard-face flashcard-front">
              <div class="chinese-character" id="chineseChar">‰Ω†Â•Ω</div>
              <div class="pinyin" id="pinyin">n«ê h«éo</div>
              <p style="font-size: 1rem; opacity: 0.8; margin-top: 1rem">
                Click to see translation
              </p>
            </div>
            <div class="flashcard-face flashcard-back">
              <div class="english-translation" id="englishTranslation">
                Hello
              </div>
              <div class="example-sentence" id="exampleSentence">
                "‰Ω†Â•ΩÔºåÊàëÊòØÊùéÊòé„ÄÇ" - "Hello, I am Li Ming."
              </div>
              <p style="font-size: 1rem; opacity: 0.8; margin-top: 1rem">
                Click to flip back
              </p>
            </div>
          </div>
        </div>

        <div class="controls">
          <button class="btn btn-secondary" id="prevBtn">
            <i class="fas fa-chevron-left"></i> Previous
          </button>
          <button class="btn btn-primary" id="flipBtn">
            <i class="fas fa-sync-alt"></i> Flip Card
          </button>
          <button class="btn btn-secondary" id="nextBtn">
            Next <i class="fas fa-chevron-right"></i>
          </button>
          <button class="btn btn-secondary" id="shuffleBtn">
            <i class="fas fa-random"></i> Shuffle
          </button>
          <button class="btn btn-primary" id="quizBtn">
            <i class="fas fa-question-circle"></i> Quiz Mode
          </button>
        </div>

        <div class="quiz-mode" id="quizMode" style="display: none">
          <h3>Quiz Time! üß†</h3>
          <div class="quiz-question" id="quizQuestion">
            What does this character mean?
          </div>
          <div
            class="chinese-character"
            id="quizCharacter"
            style="color: var(--chinese-red); margin: 1rem 0"
          >
            ‰Ω†Â•Ω
          </div>
          <div class="quiz-options" id="quizOptions">
            <!-- Quiz options will be populated here -->
          </div>
          <button class="btn btn-secondary" id="exitQuizBtn">
            <i class="fas fa-times"></i> Exit Quiz
          </button>
        </div>

        <div style="text-align: center; margin: 3rem 0">
          <a href="tools.html" class="btn btn-secondary">
            <i class="fas fa-arrow-left"></i> Back to Tools
          </a>
        </div>
      </div>
    </main>

    <script>
      // Chinese vocabulary data
      const vocabularyData = {
        beginner: [
          {
            char: "‰Ω†Â•Ω",
            pinyin: "n«ê h«éo",
            english: "Hello",
            example: "‰Ω†Â•ΩÔºåÊàëÊòØÊùéÊòé„ÄÇ - Hello, I am Li Ming.",
          },
          {
            char: "Ë∞¢Ë∞¢",
            pinyin: "xi√® xi√®",
            english: "Thank you",
            example: "Ë∞¢Ë∞¢‰Ω†ÁöÑÂ∏ÆÂä©„ÄÇ - Thank you for your help.",
          },
          {
            char: "ÂÜçËßÅ",
            pinyin: "z√†i ji√†n",
            english: "Goodbye",
            example: "ÂÜçËßÅÔºåÊòéÂ§©ËßÅÔºÅ - Goodbye, see you tomorrow!",
          },
          {
            char: "ÊòØ",
            pinyin: "sh√¨",
            english: "Yes/To be",
            example: "ÊàëÊòØÂ≠¶Áîü„ÄÇ - I am a student.",
          },
          {
            char: "‰∏ç",
            pinyin: "b√π",
            english: "No/Not",
            example: "Êàë‰∏çÁü•ÈÅì„ÄÇ - I don't know.",
          },
          {
            char: "Ê∞¥",
            pinyin: "shu«ê",
            english: "Water",
            example: "ÊàëË¶ÅÂñùÊ∞¥„ÄÇ - I want to drink water.",
          },
          {
            char: "ÂêÉ",
            pinyin: "chƒ´",
            english: "To eat",
            example: "ÊàëÊÉ≥ÂêÉÈ•≠„ÄÇ - I want to eat.",
          },
          {
            char: "ÂÆ∂",
            pinyin: "jiƒÅ",
            english: "Home/Family",
            example: "ÊàëÂõûÂÆ∂‰∫Ü„ÄÇ - I'm going home.",
          },
          {
            char: "ÊúãÂèã",
            pinyin: "p√©ng y«íu",
            english: "Friend",
            example: "‰ªñÊòØÊàëÁöÑÊúãÂèã„ÄÇ - He is my friend.",
          },
          {
            char: "Â≠¶‰π†",
            pinyin: "xu√© x√≠",
            english: "To study",
            example: "ÊàëÂñúÊ¨¢Â≠¶‰π†‰∏≠Êñá„ÄÇ - I like studying Chinese.",
          },
          {
            char: "Â∑•‰Ωú",
            pinyin: "g≈çng zu√≤",
            english: "Work/Job",
            example: "ÊàëÂú®Âåó‰∫¨Â∑•‰Ωú„ÄÇ - I work in Beijing.",
          },
          {
            char: "Êó∂Èó¥",
            pinyin: "sh√≠ jiƒÅn",
            english: "Time",
            example: "Áé∞Âú®Âá†ÁÇπ‰∫ÜÔºü - What time is it now?",
          },
          {
            char: "Èí±",
            pinyin: "qi√°n",
            english: "Money",
            example: "Ëøô‰∏™Â§öÂ∞ëÈí±Ôºü - How much does this cost?",
          },
          {
            char: "ÁîµËØù",
            pinyin: "di√†n hu√†",
            english: "Telephone",
            example: "‰Ω†ÁöÑÁîµËØùÂè∑Á†ÅÊòØÂ§öÂ∞ëÔºü - What's your phone number?",
          },
          {
            char: "ËΩ¶",
            pinyin: "chƒì",
            english: "Car/Vehicle",
            example: "ÊàëÂùêËΩ¶ÂéªÂ≠¶Ê†°„ÄÇ - I take a car to school.",
          },
          {
            char: "‰π¶",
            pinyin: "sh≈´",
            english: "Book",
            example: "ËøôÊú¨‰π¶ÂæàÊúâË∂£„ÄÇ - This book is very interesting.",
          },
          {
            char: "ÁîµÂΩ±",
            pinyin: "di√†n y«êng",
            english: "Movie",
            example: "Êàë‰ª¨ÂéªÁúãÁîµÂΩ±Âêß„ÄÇ - Let's go watch a movie.",
          },
          {
            char: "ÂåªÈô¢",
            pinyin: "yƒ´ yu√†n",
            english: "Hospital",
            example: "‰ªñÂú®ÂåªÈô¢Â∑•‰Ωú„ÄÇ - He works at the hospital.",
          },
          {
            char: "Â≠¶Ê†°",
            pinyin: "xu√© xi√†o",
            english: "School",
            example: "Â≠©Â≠ê‰ª¨Âú®Â≠¶Ê†°Â≠¶‰π†„ÄÇ - Children study at school.",
          },
          {
            char: "Áà±",
            pinyin: "√†i",
            english: "Love",
            example: "ÊàëÁà±ÊàëÁöÑÂÆ∂‰∫∫„ÄÇ - I love my family.",
          },
        ],
        intermediate: [
          {
            char: "ÁªèÊµé",
            pinyin: "jƒ´ng j√¨",
            english: "Economy",
            example:
              "‰∏≠ÂõΩÁöÑÁªèÊµéÂèëÂ±ïÂæàÂø´„ÄÇ - China's economy is developing rapidly.",
          },
          {
            char: "ÁéØÂ¢É",
            pinyin: "hu√°n j√¨ng",
            english: "Environment",
            example:
              "‰øùÊä§ÁéØÂ¢ÉÂæàÈáçË¶Å„ÄÇ - Protecting the environment is important.",
          },
          {
            char: "ÊñáÂåñ",
            pinyin: "w√©n hu√†",
            english: "Culture",
            example: "‰∏≠ÂõΩÊúâÊÇ†‰πÖÁöÑÊñáÂåñ„ÄÇ - China has a long culture.",
          },
          {
            char: "ÊïôËÇ≤",
            pinyin: "ji√†o y√π",
            english: "Education",
            example:
              "ÊïôËÇ≤ÊòØÂõΩÂÆ∂ÁöÑÊú™Êù•„ÄÇ - Education is the future of the country.",
          },
          {
            char: "ÂÅ•Â∫∑",
            pinyin: "ji√†n kƒÅng",
            english: "Health",
            example: "ËøêÂä®ÂØπÂÅ•Â∫∑ÊúâÂ•ΩÂ§Ñ„ÄÇ - Exercise is good for health.",
          },
          {
            char: "ÁßëÊäÄ",
            pinyin: "kƒì j√¨",
            english: "Technology",
            example:
              "ÁßëÊäÄÊîπÂèò‰∫ÜÊàë‰ª¨ÁöÑÁîüÊ¥ª„ÄÇ - Technology has changed our lives.",
          },
          {
            char: "Á§æ‰ºö",
            pinyin: "sh√® hu√¨",
            english: "Society",
            example: "Êàë‰ª¨ÁîüÊ¥ªÂú®Áé∞‰ª£Á§æ‰ºö„ÄÇ - We live in modern society.",
          },
          {
            char: "ÊîøÂ∫ú",
            pinyin: "zh√®ng f«î",
            english: "Government",
            example: "ÊîøÂ∫úÂà∂ÂÆö‰∫ÜÊñ∞ÊîøÁ≠ñ„ÄÇ - The government made new policies.",
          },
          {
            char: "ÂéÜÂè≤",
            pinyin: "l√¨ sh«ê",
            english: "History",
            example: "Â≠¶‰π†ÂéÜÂè≤ÂæàÊúâÊÑèÊÄù„ÄÇ - Studying history is interesting.",
          },
          {
            char: "ÊóÖË°å",
            pinyin: "l«ö x√≠ng",
            english: "Travel",
            example: "ÊàëÂñúÊ¨¢ÊóÖË°åÂíåÊé¢Á¥¢„ÄÇ - I like traveling and exploring.",
          },
        ],
        advanced: [
          {
            char: "Âì≤Â≠¶",
            pinyin: "zh√© xu√©",
            english: "Philosophy",
            example:
              "Âì≤Â≠¶ËÆ©Êàë‰ª¨ÊÄùËÄÉ‰∫∫ÁîüÁöÑÊÑè‰πâ„ÄÇ - Philosophy makes us think about the meaning of life.",
          },
          {
            char: "ÂøÉÁêÜÂ≠¶",
            pinyin: "xƒ´n l«ê xu√©",
            english: "Psychology",
            example:
              "ÂøÉÁêÜÂ≠¶Á†îÁ©∂‰∫∫ÁöÑË°å‰∏∫„ÄÇ - Psychology studies human behavior.",
          },
          {
            char: "‰ºÅ‰∏öÂÆ∂",
            pinyin: "q«ê y√® jiƒÅ",
            english: "Entrepreneur",
            example:
              "‰ªñÊòØ‰∏Ä‰∏™ÊàêÂäüÁöÑ‰ºÅ‰∏öÂÆ∂„ÄÇ - He is a successful entrepreneur.",
          },
          {
            char: "ÂàõÊñ∞",
            pinyin: "chu√†ng xƒ´n",
            english: "Innovation",
            example:
              "ÂàõÊñ∞ÊòØËøõÊ≠•ÁöÑÂä®Âäõ„ÄÇ - Innovation is the driving force of progress.",
          },
          {
            char: "ÂèØÊåÅÁª≠",
            pinyin: "kƒõ ch√≠ x√π",
            english: "Sustainable",
            example: "Êàë‰ª¨ÈúÄË¶ÅÂèØÊåÅÁª≠ÂèëÂ±ï„ÄÇ - We need sustainable development.",
          },
          {
            char: "ÂÖ®ÁêÉÂåñ",
            pinyin: "qu√°n qi√∫ hu√†",
            english: "Globalization",
            example:
              "ÂÖ®ÁêÉÂåñÂ∏¶Êù•‰∫ÜÊú∫ÈÅáÂíåÊåëÊàò„ÄÇ - Globalization brings opportunities and challenges.",
          },
          {
            char: "‰∫∫Â∑•Êô∫ËÉΩ",
            pinyin: "r√©n g≈çng zh√¨ n√©ng",
            english: "Artificial Intelligence",
            example: "‰∫∫Â∑•Êô∫ËÉΩÂ∞ÜÊîπÂèòÊú™Êù•„ÄÇ - AI will change the future.",
          },
          {
            char: "ÁîüÁâ©ÊäÄÊúØ",
            pinyin: "shƒìng w√π j√¨ sh√π",
            english: "Biotechnology",
            example:
              "ÁîüÁâ©ÊäÄÊúØÂú®ÂåªÂ≠¶‰∏≠Â∫îÁî®ÂπøÊ≥õ„ÄÇ - Biotechnology is widely used in medicine.",
          },
          {
            char: "ÂõΩÈôÖÂÖ≥Á≥ª",
            pinyin: "gu√≥ j√¨ guƒÅn x√¨",
            english: "International Relations",
            example:
              "ÂõΩÈôÖÂÖ≥Á≥ªÂΩ±Âìç‰∏ñÁïåÂíåÂπ≥„ÄÇ - International relations affect world peace.",
          },
          {
            char: "Ê∞îÂÄôÂèòÂåñ",
            pinyin: "q√¨ h√≤u bi√†n hu√†",
            english: "Climate Change",
            example: "Ê∞îÂÄôÂèòÂåñÊòØÂÖ®ÁêÉÈóÆÈ¢ò„ÄÇ - Climate change is a global issue.",
          },
        ],
      };

      let currentLevel = "beginner";
      let currentCardIndex = 0;
      let currentVocabulary = vocabularyData.beginner;
      let isFlipped = false;
      let quizMode = false;
      let correctAnswers = 0;
      let totalQuizQuestions = 0;

      // DOM elements
      const flashcard = document.getElementById("flashcard");
      const chineseChar = document.getElementById("chineseChar");
      const pinyin = document.getElementById("pinyin");
      const englishTranslation = document.getElementById("englishTranslation");
      const exampleSentence = document.getElementById("exampleSentence");
      const currentCardSpan = document.getElementById("currentCard");
      const totalCardsSpan = document.getElementById("totalCards");
      const correctAnswersSpan = document.getElementById("correctAnswers");
      const accuracySpan = document.getElementById("accuracy");
      const progressFill = document.getElementById("progressFill");
      const quizModeDiv = document.getElementById("quizMode");

      // Event listeners
      document.querySelectorAll(".difficulty-btn").forEach((btn) => {
        btn.addEventListener("click", () => {
          document
            .querySelectorAll(".difficulty-btn")
            .forEach((b) => b.classList.remove("active"));
          btn.classList.add("active");
          currentLevel = btn.dataset.level;
          currentVocabulary = vocabularyData[currentLevel];
          currentCardIndex = 0;
          correctAnswers = 0;
          totalQuizQuestions = 0;
          updateCard();
          updateStats();
        });
      });

      document.getElementById("prevBtn").addEventListener("click", () => {
        if (currentCardIndex > 0) {
          currentCardIndex--;
          updateCard();
          updateStats();
        }
      });

      document.getElementById("nextBtn").addEventListener("click", () => {
        if (currentCardIndex < currentVocabulary.length - 1) {
          currentCardIndex++;
          updateCard();
          updateStats();
        }
      });

      document.getElementById("flipBtn").addEventListener("click", flipCard);
      flashcard.addEventListener("click", flipCard);

      document.getElementById("shuffleBtn").addEventListener("click", () => {
        currentVocabulary = [...currentVocabulary].sort(
          () => Math.random() - 0.5
        );
        currentCardIndex = 0;
        updateCard();
        updateStats();
      });

      document.getElementById("quizBtn").addEventListener("click", startQuiz);
      document
        .getElementById("exitQuizBtn")
        .addEventListener("click", exitQuiz);

      function updateCard() {
        const card = currentVocabulary[currentCardIndex];
        chineseChar.textContent = card.char;
        pinyin.textContent = card.pinyin;
        englishTranslation.textContent = card.english;
        exampleSentence.textContent = card.example;

        if (isFlipped) {
          flashcard.classList.remove("flipped");
          isFlipped = false;
        }
      }

      function flipCard() {
        if (quizMode) return;

        flashcard.classList.toggle("flipped");
        isFlipped = !isFlipped;
      }

      function updateStats() {
        currentCardSpan.textContent = currentCardIndex + 1;
        totalCardsSpan.textContent = currentVocabulary.length;
        correctAnswersSpan.textContent = correctAnswers;

        const accuracy =
          totalQuizQuestions > 0
            ? Math.round((correctAnswers / totalQuizQuestions) * 100)
            : 100;
        accuracySpan.textContent = accuracy;

        const progress =
          ((currentCardIndex + 1) / currentVocabulary.length) * 100;
        progressFill.style.width = progress + "%";
      }

      function startQuiz() {
        quizMode = true;
        quizModeDiv.style.display = "block";
        flashcard.parentElement.style.display = "none";
        generateQuizQuestion();
      }

      function exitQuiz() {
        quizMode = false;
        quizModeDiv.style.display = "none";
        flashcard.parentElement.style.display = "block";
      }

      function generateQuizQuestion() {
        const card = currentVocabulary[currentCardIndex];
        const quizCharacter = document.getElementById("quizCharacter");
        const quizOptions = document.getElementById("quizOptions");

        quizCharacter.textContent = card.char;

        // Generate options (1 correct + 3 incorrect)
        const options = [card.english];
        const otherCards = currentVocabulary.filter((c) => c !== card);

        while (options.length < 4 && otherCards.length > 0) {
          const randomCard =
            otherCards[Math.floor(Math.random() * otherCards.length)];
          if (!options.includes(randomCard.english)) {
            options.push(randomCard.english);
          }
          otherCards.splice(otherCards.indexOf(randomCard), 1);
        }

        // Shuffle options
        options.sort(() => Math.random() - 0.5);

        // Create option buttons
        quizOptions.innerHTML = "";
        options.forEach((option) => {
          const button = document.createElement("button");
          button.className = "quiz-option";
          button.textContent = option;
          button.addEventListener("click", () =>
            checkAnswer(button, option, card.english)
          );
          quizOptions.appendChild(button);
        });
      }

      function checkAnswer(button, selected, correct) {
        totalQuizQuestions++;

        document.querySelectorAll(".quiz-option").forEach((opt) => {
          opt.style.pointerEvents = "none";
          if (opt.textContent === correct) {
            opt.classList.add("correct");
          } else if (opt === button && selected !== correct) {
            opt.classList.add("incorrect");
          }
        });

        if (selected === correct) {
          correctAnswers++;
        }

        updateStats();

        setTimeout(() => {
          if (currentCardIndex < currentVocabulary.length - 1) {
            currentCardIndex++;
            generateQuizQuestion();
          } else {
            alert(
              `Quiz completed! Your accuracy: ${Math.round(
                (correctAnswers / totalQuizQuestions) * 100
              )}%`
            );
            exitQuiz();
          }
        }, 2000);
      }

      // Initialize
      updateCard();
      updateStats();
    </script>

    <script src="../js/navigation.js"></script>
  </body>
</html>
