<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Interactive English lesson plan with engaging activities, games, and exercises for ESL learners">
    <title>Interactive English Lesson Plan - ESL Fun Online</title>
    
    <!-- Consistent fonts from main site -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Link to main site styles -->
    <link rel="stylesheet" href="../css/main.css">
    <link rel="stylesheet" href="../css/header.css">
    
    <style>
        /* Unified CSS Variables following site standards */
        :root {
            --primary-color: #46bbe5;
            --primary-hover: #05425c;
            --primary-light: rgba(70, 187, 229, 0.1);
            --primary-dark: #0d4f66;
            --secondary-color: #10b981;
            --accent-color: #f59e0b;
            --success-color: #10b981;
            --error-color: #ef4444;
            --warning-color: #f59e0b;
            --text-primary: #1f2937;
            --text-secondary: #6b7280;
            --text-muted: #9ca3af;
            --text-inverse: #ffffff;
            --bg-primary: #ffffff;
            --bg-secondary: #f9fafb;
            --bg-tertiary: #f3f4f6;
            --border-color: #e5e7eb;
            --shadow-sm: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
            --gradient-primary: linear-gradient(135deg, #46bbe5 0%, #0d4f66 100%);
            --gradient-hero: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            --radius: 0.5rem;
            --radius-lg: 1rem;
            --radius-xl: 1.5rem;
            --font-family-primary: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            --font-family-brand: 'Poppins', sans-serif;
            --transition-normal: 0.3s ease;
            --transition-fast: 0.15s ease;
            --header-height: 80px;
            --header-height-mobile: 70px;
        }

        /* Reset and base styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-family-primary);
            background: var(--gradient-hero);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Skip link for accessibility */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 6px;
            background: var(--primary-color);
            color: var(--text-inverse);
            padding: 0.5rem 1rem;
            text-decoration: none;
            border-radius: var(--radius);
            z-index: 1000;
            transition: top var(--transition-fast);
        }

        .skip-link:focus {
            top: 6px;
        }

        /* Main container with consistent styling */
        .main-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: calc(var(--header-height) + 2rem) 2rem 2rem;
            position: relative;
            z-index: 1;
        }

        /* Header section */
        .lesson-header {
            text-align: center;
            margin-bottom: 3rem;
            padding: 2rem 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-xl);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .lesson-title {
            font-family: var(--font-family-brand);
            font-size: clamp(2rem, 5vw, 3.5rem);
            font-weight: 800;
            background: var(--gradient-primary);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 1rem;
            line-height: 1.2;
        }

        .lesson-subtitle {
            font-size: 1.25rem;
            color: var(--text-secondary);
            margin-bottom: 2rem;
            font-weight: 500;
        }

        /* Progress tracking system */
        .progress-section {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-color);
        }

        .progress-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .progress-title {
            font-family: var(--font-family-brand);
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .progress-stats {
            display: flex;
            gap: 1.5rem;
            align-items: center;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
            line-height: 1;
        }

        .stat-label {
            font-size: 0.875rem;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .progress-bar-container {
            background: var(--bg-tertiary);
            border-radius: var(--radius);
            height: 12px;
            overflow: hidden;
            position: relative;
        }

        .progress-bar {
            height: 100%;
            background: var(--gradient-primary);
            border-radius: var(--radius);
            transition: width 0.5s ease;
            position: relative;
        }

        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        /* Section styling with consistent design */
        .lesson-section {
            margin-bottom: 3rem;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: var(--radius-xl);
            overflow: hidden;
            box-shadow: var(--shadow-xl);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: transform var(--transition-normal), box-shadow var(--transition-normal);
            position: relative;
        }

        .lesson-section:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-xl), 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }

        .section-header {
            background: var(--gradient-primary);
            color: var(--text-inverse);
            padding: 1.5rem 2rem;
            position: relative;
            overflow: hidden;
        }

        .section-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: left 0.5s ease;
        }

        .lesson-section:hover .section-header::before {
            left: 100%;
        }

        .section-title {
            font-family: var(--font-family-brand);
            font-size: 1.75rem;
            font-weight: 700;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .section-content {
            padding: 2rem;
        }

        /* Activity card styling */
        .activity-card {
            background: var(--bg-primary);
            border: 2px solid var(--border-color);
            border-radius: var(--radius-lg);
            margin-bottom: 1.5rem;
            overflow: hidden;
            transition: all var(--transition-normal);
            position: relative;
        }

        .activity-card:hover {
            border-color: var(--primary-color);
            box-shadow: var(--shadow-lg);
            transform: translateY(-2px);
        }

        .activity-card.completed {
            border-color: var(--success-color);
            background: linear-gradient(135deg, var(--bg-primary) 0%, rgba(16, 185, 129, 0.05) 100%);
        }

        .activity-header {
            padding: 1.25rem 1.5rem;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
            transition: background-color var(--transition-normal);
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
        }

        .activity-header:hover {
            background: var(--primary-light);
        }

        .activity-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .activity-meta {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .difficulty-badge {
            padding: 0.25rem 0.75rem;
            border-radius: var(--radius);
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .difficulty-easy {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success-color);
        }

        .difficulty-medium {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning-color);
        }

        .difficulty-hard {
            background: rgba(239, 68, 68, 0.1);
            color: var(--error-color);
        }

        .activity-icon {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background: var(--primary-light);
            color: var(--primary-color);
            font-size: 0.875rem;
            transition: all var(--transition-normal);
        }

        .activity-card.completed .activity-icon {
            background: var(--success-color);
            color: var(--text-inverse);
        }

        .chevron-icon {
            transition: transform var(--transition-normal);
            color: var(--text-secondary);
        }

        .activity-card.open .chevron-icon {
            transform: rotate(180deg);
        }

        .activity-content {
            padding: 0;
            max-height: 0;
            overflow: hidden;
            transition: all var(--transition-normal);
        }

        .activity-card.open .activity-content {
            padding: 1.5rem;
            max-height: 1000px;
        }

        .activity-body {
            padding: 0.5rem 0;
        }

        /* Question and Answer styling */
        .question-item {
            background: var(--bg-primary);
            border: 2px solid var(--border-color);
            border-radius: var(--radius-lg);
            margin-bottom: 1rem;
            overflow: hidden;
            transition: all var(--transition-normal);
        }

        .question-item:hover {
            border-color: var(--primary-color);
            box-shadow: var(--shadow-md);
        }

        .question-item.answered {
            border-color: var(--success-color);
            background: linear-gradient(135deg, var(--bg-primary) 0%, rgba(16, 185, 129, 0.05) 100%);
        }

        .question-header {
            padding: 1.25rem 1.5rem;
            cursor: pointer;
            transition: background-color var(--transition-normal);
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: var(--bg-secondary);
        }

        .question-header:hover {
            background: var(--primary-light);
        }

        .question-text {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .question-type {
            padding: 0.25rem 0.75rem;
            background: var(--primary-color);
            color: var(--text-inverse);
            border-radius: var(--radius);
            font-size: 0.875rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .answer-content {
            padding: 0;
            max-height: 0;
            overflow: hidden;
            transition: all var(--transition-normal);
            background: var(--bg-primary);
        }

        .question-item.open .answer-content {
            padding: 1.5rem;
            max-height: 500px;
        }

        .answer-text {
            font-size: 1rem;
            color: var(--text-secondary);
            line-height: 1.6;
            padding: 1rem;
            background: linear-gradient(135deg, var(--primary-light) 0%, rgba(70, 187, 229, 0.05) 100%);
            border-radius: var(--radius);
            border-left: 4px solid var(--primary-color);
        }

        /* Interactive game containers */
        .game-container {
            background: var(--bg-primary);
            border-radius: var(--radius-lg);
            padding: 2rem;
            position: relative;
            overflow: hidden;
        }

        .game-description {
            text-align: center;
            margin-bottom: 2rem;
            color: var(--text-secondary);
            font-size: 1.125rem;
            line-height: 1.6;
        }

        /* Star constellation game */
        .star-game {
            position: relative;
            width: 100%;
            height: 400px;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
            border-radius: var(--radius-lg);
            overflow: hidden;
            cursor: crosshair;
            border: 2px solid var(--border-color);
            box-shadow: inset 0 0 50px rgba(0, 0, 0, 0.3);
        }

        .star {
            position: absolute;
            width: 8px;
            height: 8px;
            background: #ffffff;
            border-radius: 50%;
            box-shadow: 0 0 15px currentColor, 0 0 30px currentColor;
            transition: all var(--transition-normal);
            cursor: pointer;
        }

        .star.clicked {
            width: 12px;
            height: 12px;
            animation: starPulse 0.6s ease-out;
        }

        @keyframes starPulse {
            0% { transform: scale(1); }
            50% { transform: scale(2); }
            100% { transform: scale(1); }
        }

        .star-connection {
            position: absolute;
            height: 2px;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.6), transparent);
            transform-origin: left center;
            animation: connectionGlow 3s infinite alternate;
        }

        @keyframes connectionGlow {
            0% { opacity: 0.3; }
            100% { opacity: 1; }
        }

        .constellation-info {
            position: absolute;
            bottom: 1rem;
            left: 1rem;
            right: 1rem;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(10px);
            color: white;
            padding: 1rem;
            border-radius: var(--radius);
            font-size: 0.875rem;
            text-align: center;
        }

        /* Phonics learning section */
        .phonics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin: 1.5rem 0;
        }

        .phonics-card {
            background: var(--bg-primary);
            border: 2px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: all var(--transition-normal);
            position: relative;
            overflow: hidden;
        }

        .phonics-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, var(--primary-light), transparent);
            transition: left var(--transition-normal);
        }

        .phonics-card:hover::before {
            left: 100%;
        }

        .phonics-card:hover {
            border-color: var(--accent-color);
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
        }

        .phonics-sound {
            font-size: 2rem;
            font-weight: 700;
            color: var(--accent-color);
            margin-bottom: 0.75rem;
            font-family: var(--font-family-brand);
        }

        .phonics-word {
            font-size: 1.25rem;
            color: var(--text-primary);
            font-weight: 500;
            margin-bottom: 0.5rem;
        }

        .phonics-example {
            font-size: 0.875rem;
            color: var(--text-secondary);
            font-style: italic;
        }

        /* Enhanced Tic Tac Toe game */
        .tic-tac-toe-container {
            max-width: 400px;
            margin: 2rem auto;
        }

        .game-status {
            text-align: center;
            margin-bottom: 1.5rem;
            padding: 1rem;
            background: var(--bg-secondary);
            border-radius: var(--radius-lg);
            border: 2px solid var(--border-color);
        }

        .game-status-text {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 0.5rem;
        }

        .game-score {
            display: flex;
            justify-content: center;
            gap: 2rem;
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .score-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .tic-tac-toe-board {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0.5rem;
            background: var(--bg-secondary);
            padding: 1rem;
            border-radius: var(--radius-lg);
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .tic-tac-toe-cell {
            aspect-ratio: 1;
            background: var(--bg-primary);
            border: 2px solid var(--border-color);
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            font-weight: 700;
            cursor: pointer;
            transition: all var(--transition-normal);
            position: relative;
            overflow: hidden;
        }

        .tic-tac-toe-cell::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: var(--primary-light);
            border-radius: 50%;
            transition: all var(--transition-normal);
            transform: translate(-50%, -50%);
        }

        .tic-tac-toe-cell:hover::before {
            width: 100%;
            height: 100%;
        }

        .tic-tac-toe-cell:hover {
            border-color: var(--primary-color);
            transform: scale(1.02);
        }

        .tic-tac-toe-cell.x {
            color: var(--error-color);
        }

        .tic-tac-toe-cell.o {
            color: var(--primary-color);
        }

        .tic-tac-toe-cell.winning {
            background: var(--success-color);
            color: var(--text-inverse);
            animation: winningCell 0.6s ease-out;
        }

        @keyframes winningCell {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .game-controls {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            background: var(--gradient-primary);
            color: var(--text-inverse);
            border: none;
            border-radius: var(--radius-lg);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-normal);
            text-decoration: none;
            font-family: var(--font-family-primary);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn-secondary {
            background: var(--bg-primary);
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
        }

        .btn-secondary:hover {
            background: var(--primary-color);
            color: var(--text-inverse);
        }

        /* Word matching game */
        .word-matching-game {
            margin: 2rem 0;
        }

        .matching-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .word-column {
            background: var(--bg-primary);
            border: 2px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: 1.5rem;
        }

        .column-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--primary-color);
            text-align: center;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .word-item {
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: var(--radius);
            padding: 1rem 1.25rem;
            margin-bottom: 0.75rem;
            text-align: center;
            cursor: pointer;
            transition: all var(--transition-normal);
            font-size: 1.125rem;
            font-weight: 500;
            position: relative;
            overflow: hidden;
        }

        .word-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left var(--transition-normal);
        }

        .word-item:hover::before {
            left: 100%;
        }

        .word-item:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .word-item.selected {
            background: var(--primary-color);
            color: var(--text-inverse);
            border-color: var(--primary-color);
            transform: scale(1.02);
        }

        .word-item.matched {
            background: var(--success-color);
            color: var(--text-inverse);
            border-color: var(--success-color);
            cursor: default;
            animation: matchSuccess 0.6s ease-out;
        }

        .word-item.incorrect {
            background: var(--error-color);
            color: var(--text-inverse);
            border-color: var(--error-color);
            animation: shake 0.5s ease-out;
        }

        @keyframes matchSuccess {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .game-score-display {
            text-align: center;
            padding: 1.5rem;
            background: var(--bg-secondary);
            border-radius: var(--radius-lg);
            border: 2px solid var(--border-color);
            margin-top: 1.5rem;
        }

        .score-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 1rem;
        }

        .score-stats {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-bottom: 1rem;
        }

        .score-stat {
            text-align: center;
        }

        .score-number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
            line-height: 1;
        }

        .score-label {
            font-size: 0.875rem;
            color: var(--text-secondary);
            font-weight: 500;
        }

        /* Completion celebration */
        .celebration {
            display: none;
            text-align: center;
            padding: 2rem;
            background: linear-gradient(135deg, var(--success-color), #059669);
            color: var(--text-inverse);
            border-radius: var(--radius-lg);
            margin-top: 2rem;
            animation: celebrationPulse 1s ease-out;
        }

        .celebration.show {
            display: block;
        }

        @keyframes celebrationPulse {
            0% { transform: scale(0.8); opacity: 0; }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); opacity: 1; }
        }

        .celebration-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-20px); }
            60% { transform: translateY(-10px); }
        }

        .celebration-text {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .celebration-message {
            font-size: 1rem;
            opacity: 0.9;
        }

        /* Responsive design */
        @media (max-width: 1024px) {
            .main-container {
                padding: calc(var(--header-height) + 1.5rem) 1.5rem 1.5rem;
            }
            
            .phonics-grid {
                grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            }
            
            .matching-grid {
                gap: 1.5rem;
            }
        }

        @media (max-width: 768px) {
            .main-container {
                padding: calc(var(--header-height-mobile) + 1rem) 1rem 1rem;
            }
            
            .lesson-title {
                font-size: clamp(1.75rem, 6vw, 2.5rem);
            }
            
            .section-content {
                padding: 1.5rem;
            }
            
            .phonics-grid {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                gap: 1rem;
            }
            
            .matching-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }
            
            .progress-stats {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .score-stats {
                flex-wrap: wrap;
                gap: 1.5rem;
            }
            
            .game-controls {
                flex-wrap: wrap;
            }
        }

        @media (max-width: 480px) {
            .lesson-header {
                padding: 1.5rem 1rem;
            }
            
            .section-header {
                padding: 1rem 1.5rem;
            }
            
            .section-content {
                padding: 1rem;
            }
            
            .activity-header {
                padding: 1rem;
            }
            
            .activity-content.open {
                padding: 1rem;
            }
            
            .phonics-grid {
                grid-template-columns: 1fr;
            }
            
            .phonics-card {
                padding: 1rem;
            }
            
            .star-game {
                height: 300px;
            }
        }

        /* Accessibility enhancements */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
                scroll-behavior: auto !important;
            }
        }

        /* Focus styles for keyboard navigation */
        .activity-header:focus,
        .question-header:focus,
        .word-item:focus,
        .phonics-card:focus,
        .tic-tac-toe-cell:focus {
            outline: 3px solid var(--primary-color);
            outline-offset: 2px;
        }

        /* High contrast mode support */
        @media (prefers-contrast: high) {
            .activity-card,
            .question-item,
            .phonics-card,
            .word-item {
                border-width: 3px;
            }
        }
    </style>
</head>
<body>
    <!-- Skip link for accessibility -->
    <a href="#main-content" class="skip-link">Skip to main content</a>
    
    <!-- Include site header if needed -->
    <!-- <div id="header-placeholder"></div> -->
    
    <main id="main-content" class="main-container">
        <!-- Lesson Header -->
        <header class="lesson-header">
            <h1 class="lesson-title">
                <i class="fas fa-graduation-cap" aria-hidden="true"></i>
                Interactive English Lesson
            </h1>
            <p class="lesson-subtitle">
                Master English through engaging activities, games, and interactive exercises
            </p>
        </header>

        <!-- Progress Tracking Section -->
        <section class="progress-section" role="region" aria-labelledby="progress-title">
            <div class="progress-header">
                <h2 class="progress-title" id="progress-title">
                    <i class="fas fa-chart-line" aria-hidden="true"></i>
                    Your Learning Progress
                </h2>
                <div class="progress-stats">
                    <div class="stat-item">
                        <div class="stat-value" id="completed-count">0</div>
                        <div class="stat-label">Completed</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="total-activities">7</div>
                        <div class="stat-label">Total Activities</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="progress-percentage">0%</div>
                        <div class="stat-label">Progress</div>
                    </div>
                </div>
            </div>
            <div class="progress-bar-container" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" aria-labelledby="progress-title">
                <div class="progress-bar" id="progress-bar" style="width: 0%;"></div>
            </div>
        </section>

        <!-- Question Practice Section -->
        <section class="lesson-section" role="region" aria-labelledby="questions-title">
            <header class="section-header">
                <h2 class="section-title" id="questions-title">
                    <i class="fas fa-question-circle" aria-hidden="true"></i>
                    Question Practice
                </h2>
            </header>
            <div class="section-content">
                <p class="game-description">
                    Practice answering common English questions. Click each question to reveal helpful prompts and practice your responses.
                </p>
                
                <div class="question-item" data-activity="question-1">
                    <div class="question-header" onclick="toggleQuestion('question-1')" tabindex="0" role="button" aria-expanded="false" aria-controls="answer-1">
                        <div class="question-text">
                            <span class="question-type">What</span>
                            What is your name?
                        </div>
                        <i class="fas fa-chevron-down chevron-icon" aria-hidden="true"></i>
                    </div>
                    <div class="answer-content" id="answer-1">
                        <div class="answer-text">
                            <strong>Practice saying:</strong> "My name is [your name]." or "I'm [your name]."<br>
                            <strong>Example:</strong> "My name is Sarah." or "I'm John."
                        </div>
                    </div>
                </div>

                <div class="question-item" data-activity="question-2">
                    <div class="question-header" onclick="toggleQuestion('question-2')" tabindex="0" role="button" aria-expanded="false" aria-controls="answer-2">
                        <div class="question-text">
                            <span class="question-type">Where</span>
                            Where do you live?
                        </div>
                        <i class="fas fa-chevron-down chevron-icon" aria-hidden="true"></i>
                    </div>
                    <div class="answer-content" id="answer-2">
                        <div class="answer-text">
                            <strong>Practice saying:</strong> "I live in [city/country]." or "I'm from [place]."<br>
                            <strong>Example:</strong> "I live in Tokyo, Japan." or "I'm from New York."
                        </div>
                    </div>
                </div>

                <div class="question-item" data-activity="question-3">
                    <div class="question-header" onclick="toggleQuestion('question-3')" tabindex="0" role="button" aria-expanded="false" aria-controls="answer-3">
                        <div class="question-text">
                            <span class="question-type">Who</span>
                            Who is your best friend?
                        </div>
                        <i class="fas fa-chevron-down chevron-icon" aria-hidden="true"></i>
                    </div>
                    <div class="answer-content" id="answer-3">
                        <div class="answer-text">
                            <strong>Practice saying:</strong> "My best friend is [name]." or "My best friend's name is [name]."<br>
                            <strong>Example:</strong> "My best friend is Maria." Tell me something about them!
                        </div>
                    </div>
                </div>

                <div class="question-item" data-activity="question-4">
                    <div class="question-header" onclick="toggleQuestion('question-4')" tabindex="0" role="button" aria-expanded="false" aria-controls="answer-4">
                        <div class="question-text">
                            <span class="question-type">When</span>
                            When is your birthday?
                        </div>
                        <i class="fas fa-chevron-down chevron-icon" aria-hidden="true"></i>
                    </div>
                    <div class="answer-content" id="answer-4">
                        <div class="answer-text">
                            <strong>Practice saying:</strong> "My birthday is [date]." or "I was born on [date]."<br>
                            <strong>Example:</strong> "My birthday is March 15th." or "I was born on December 3rd."
                        </div>
                    </div>
                </div>

                <div class="question-item" data-activity="question-5">
                    <div class="question-header" onclick="toggleQuestion('question-5')" tabindex="0" role="button" aria-expanded="false" aria-controls="answer-5">
                        <div class="question-text">
                            <span class="question-type">Why</span>
                            Why do you like learning English?
                        </div>
                        <i class="fas fa-chevron-down chevron-icon" aria-hidden="true"></i>
                    </div>
                    <div class="answer-content" id="answer-5">
                        <div class="answer-text">
                            <strong>Practice saying:</strong> "I like learning English because..." or "English is important to me because..."<br>
                            <strong>Example:</strong> "I like learning English because it helps me communicate with people from different countries."
                        </div>
                    </div>
                </div>

                <div class="question-item" data-activity="question-6">
                    <div class="question-header" onclick="toggleQuestion('question-6')" tabindex="0" role="button" aria-expanded="false" aria-controls="answer-6">
                        <div class="question-text">
                            <span class="question-type">How</span>
                            How old are you?
                        </div>
                        <i class="fas fa-chevron-down chevron-icon" aria-hidden="true"></i>
                    </div>
                    <div class="answer-content" id="answer-6">
                        <div class="answer-text">
                            <strong>Practice saying:</strong> "I am [age] years old." or "I'm [age]."<br>
                            <strong>Example:</strong> "I am 25 years old." or "I'm 16."
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <!-- Star Constellation Activity -->
        <section class="lesson-section" role="region" aria-labelledby="constellation-title">
            <header class="section-header">
                <h2 class="section-title" id="constellation-title">
                    <i class="fas fa-star" aria-hidden="true"></i>
                    Constellation Creator
                </h2>
            </header>
            <div class="section-content">
                <div class="game-container" data-activity="constellation">
                    <p class="game-description">
                        Click anywhere in the night sky to create stars and watch them connect into beautiful constellations! Practice saying "star," "bright," and "beautiful" as you create.
                    </p>
                    
                    <div class="star-game" id="starGame" onclick="createStar(event)" role="button" tabindex="0" aria-label="Click to create stars">
                        <div class="constellation-info">
                            <i class="fas fa-info-circle" aria-hidden="true"></i>
                            Click to create your own constellation! Stars will automatically connect when they're close together.
                        </div>
                    </div>
                    
                    <div class="game-controls">
                        <button class="btn btn-secondary" onclick="clearStars()">
                            <i class="fas fa-trash-alt" aria-hidden="true"></i>
                            Clear Sky
                        </button>
                        <button class="btn" onclick="randomConstellation()">
                            <i class="fas fa-random" aria-hidden="true"></i>
                            Random Pattern
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Phonics Learning Section -->
        <section class="lesson-section" role="region" aria-labelledby="phonics-title">
            <header class="section-header">
                <h2 class="section-title" id="phonics-title">
                    <i class="fas fa-volume-up" aria-hidden="true"></i>
                    Phonics Sounds Practice
                </h2>
            </header>
            <div class="section-content">
                <div class="game-container" data-activity="phonics">
                    <p class="game-description">
                        Click each phonics card to practice pronunciation. Pay attention to the sound patterns and example words!
                    </p>
                    
                    <div class="phonics-grid">
                        <div class="phonics-card" onclick="practicePhonics('a_e', 'cake')" tabindex="0" role="button">
                            <div class="phonics-sound">a_e</div>
                            <div class="phonics-word">cake</div>
                            <div class="phonics-example">/keɪk/</div>
                        </div>
                        
                        <div class="phonics-card" onclick="practicePhonics('ai', 'rain')" tabindex="0" role="button">
                            <div class="phonics-sound">ai</div>
                            <div class="phonics-word">rain</div>
                            <div class="phonics-example">/reɪn/</div>
                        </div>
                        
                        <div class="phonics-card" onclick="practicePhonics('ay', 'play')" tabindex="0" role="button">
                            <div class="phonics-sound">ay</div>
                            <div class="phonics-word">play</div>
                            <div class="phonics-example">/pleɪ/</div>
                        </div>
                        
                        <div class="phonics-card" onclick="practicePhonics('ee', 'tree')" tabindex="0" role="button">
                            <div class="phonics-sound">ee</div>
                            <div class="phonics-word">tree</div>
                            <div class="phonics-example">/triː/</div>
                        </div>
                        
                        <div class="phonics-card" onclick="practicePhonics('ea', 'beach')" tabindex="0" role="button">
                            <div class="phonics-sound">ea</div>
                            <div class="phonics-word">beach</div>
                            <div class="phonics-example">/biːtʃ/</div>
                        </div>
                        
                        <div class="phonics-card" onclick="practicePhonics('o_e', 'home')" tabindex="0" role="button">
                            <div class="phonics-sound">o_e</div>
                            <div class="phonics-word">home</div>
                            <div class="phonics-example">/hoʊm/</div>
                        </div>
                        
                        <div class="phonics-card" onclick="practicePhonics('oa', 'boat')" tabindex="0" role="button">
                            <div class="phonics-sound">oa</div>
                            <div class="phonics-word">boat</div>
                            <div class="phonics-example">/boʊt/</div>
                        </div>
                        
                        <div class="phonics-card" onclick="practicePhonics('ow', 'snow')" tabindex="0" role="button">
                            <div class="phonics-sound">ow</div>
                            <div class="phonics-word">snow</div>
                            <div class="phonics-example">/snoʊ/</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Tic Tac Toe Game -->
        <section class="lesson-section" role="region" aria-labelledby="tictactoe-title">
            <header class="section-header">
                <h2 class="section-title" id="tictactoe-title">
                    <i class="fas fa-th-large" aria-hidden="true"></i>
                    English Tic Tac Toe
                </h2>
            </header>
            <div class="section-content">
                <div class="game-container" data-activity="tictactoe">
                    <p class="game-description">
                        Play tic-tac-toe while practicing English! Say "It's my turn," "I win," or "Good game" as you play.
                    </p>
                    
                    <div class="tic-tac-toe-container">
                        <div class="game-status">
                            <div class="game-status-text" id="gameStatus">Player X's turn</div>
                            <div class="game-score">
                                <div class="score-item">
                                    <i class="fas fa-times" style="color: var(--error-color);"></i>
                                    <span>X: <span id="scoreX">0</span></span>
                                </div>
                                <div class="score-item">
                                    <i class="fas fa-circle" style="color: var(--primary-color);"></i>
                                    <span>O: <span id="scoreO">0</span></span>
                                </div>
                                <div class="score-item">
                                    <i class="fas fa-handshake" style="color: var(--text-secondary);"></i>
                                    <span>Ties: <span id="scoreTies">0</span></span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="tic-tac-toe-board" id="ticTacToeBoard" role="grid" aria-label="Tic tac toe game board">
                            <!-- Cells will be generated by JavaScript -->
                        </div>
                        
                        <div class="game-controls">
                            <button class="btn btn-secondary" onclick="resetTicTacToe()">
                                <i class="fas fa-redo" aria-hidden="true"></i>
                                New Game
                            </button>
                            <button class="btn btn-secondary" onclick="resetScores()">
                                <i class="fas fa-chart-line" aria-hidden="true"></i>
                                Reset Scores
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Word Matching Game -->
        <section class="lesson-section" role="region" aria-labelledby="matching-title">
            <header class="section-header">
                <h2 class="section-title" id="matching-title">
                    <i class="fas fa-puzzle-piece" aria-hidden="true"></i>
                    Rhyming Words Match
                </h2>
            </header>
            <div class="section-content">
                <div class="game-container" data-activity="wordmatch">
                    <p class="game-description">
                        Find pairs of words that rhyme! Click words that sound similar to match them together. Practice pronunciation as you play.
                    </p>
                    
                    <div class="word-matching-game">
                        <div class="matching-grid">
                            <div class="word-column">
                                <h3 class="column-title">
                                    <i class="fas fa-list" aria-hidden="true"></i>
                                    Group A
                                </h3>
                                <div class="word-item" onclick="selectWord(this, 'cat')" tabindex="0" role="button">cat</div>
                                <div class="word-item" onclick="selectWord(this, 'dog')" tabindex="0" role="button">dog</div>
                                <div class="word-item" onclick="selectWord(this, 'sun')" tabindex="0" role="button">sun</div>
                                <div class="word-item" onclick="selectWord(this, 'car')" tabindex="0" role="button">car</div>
                                <div class="word-item" onclick="selectWord(this, 'book')" tabindex="0" role="button">book</div>
                            </div>
                            
                            <div class="word-column">
                                <h3 class="column-title">
                                    <i class="fas fa-list" aria-hidden="true"></i>
                                    Group B
                                </h3>
                                <div class="word-item" onclick="selectWord(this, 'hat')" tabindex="0" role="button">hat</div>
                                <div class="word-item" onclick="selectWord(this, 'frog')" tabindex="0" role="button">frog</div>
                                <div class="word-item" onclick="selectWord(this, 'fun')" tabindex="0" role="button">fun</div>
                                <div class="word-item" onclick="selectWord(this, 'star')" tabindex="0" role="button">star</div>
                                <div class="word-item" onclick="selectWord(this, 'look')" tabindex="0" role="button">look</div>
                            </div>
                        </div>
                        
                        <div class="game-score-display">
                            <h3 class="score-title">Matching Progress</h3>
                            <div class="score-stats">
                                <div class="score-stat">
                                    <div class="score-number" id="matchedPairs">0</div>
                                    <div class="score-label">Matched Pairs</div>
                                </div>
                                <div class="score-stat">
                                    <div class="score-number" id="attempts">0</div>
                                    <div class="score-label">Attempts</div>
                                </div>
                                <div class="score-stat">
                                    <div class="score-number" id="accuracy">100%</div>
                                    <div class="score-label">Accuracy</div>
                                </div>
                            </div>
                            
                            <div class="game-controls">
                                <button class="btn btn-secondary" onclick="resetWordGame()">
                                    <i class="fas fa-redo" aria-hidden="true"></i>
                                    Reset Game
                                </button>
                                <button class="btn" onclick="shuffleWords()">
                                    <i class="fas fa-random" aria-hidden="true"></i>
                                    Shuffle Words
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Completion Celebration -->
        <div class="celebration" id="completionCelebration">
            <div class="celebration-icon">🎉</div>
            <div class="celebration-text">Congratulations!</div>
            <div class="celebration-message">You've completed all the activities! Your English skills are improving!</div>
        </div>
    </main>

    <script>
        // Enhanced lesson plan with progress tracking and improved interactivity
        
        // Global state management
        const gameState = {
            completedActivities: new Set(),
            totalActivities: 7,
            stars: [],
            connections: [],
            ticTacToe: {
                board: Array(9).fill(''),
                currentPlayer: 'X',
                gameActive: true,
                scores: { X: 0, O: 0, ties: 0 }
            },
            wordMatch: {
                selectedWords: [],
                matchedPairs: 0,
                attempts: 0,
                rhymePairs: {
                    'cat': 'hat', 'hat': 'cat',
                    'dog': 'frog', 'frog': 'dog', 
                    'sun': 'fun', 'fun': 'sun',
                    'car': 'star', 'star': 'car',
                    'book': 'look', 'look': 'book'
                }
            }
        };

        // Progress tracking functions
        function updateProgress() {
            const completed = gameState.completedActivities.size;
            const total = gameState.totalActivities;
            const percentage = Math.round((completed / total) * 100);
            
            // Update progress display
            document.getElementById('completed-count').textContent = completed;
            document.getElementById('progress-percentage').textContent = percentage + '%';
            document.getElementById('progress-bar').style.width = percentage + '%';
            document.querySelector('.progress-bar-container').setAttribute('aria-valuenow', percentage);
            
            // Check for completion
            if (completed === total) {
                showCompletionCelebration();
            }
        }

        function markActivityComplete(activityName) {
            if (!gameState.completedActivities.has(activityName)) {
                gameState.completedActivities.add(activityName);
                const element = document.querySelector(`[data-activity="${activityName}"]`);
                if (element) {
                    element.classList.add('completed');
                    const icon = element.querySelector('.activity-icon, .chevron-icon');
                    if (icon && icon.classList.contains('activity-icon')) {
                        icon.innerHTML = '<i class="fas fa-check"></i>';
                    }
                }
                updateProgress();
                
                // Visual feedback
                showActivityFeedback(activityName);
            }
        }

        function showActivityFeedback(activityName) {
            const messages = [
                "Great job! 🎉", "Excellent work! ⭐", "Well done! 👏", 
                "Amazing! 🌟", "Perfect! ✨", "Outstanding! 🎊"
            ];
            const message = messages[Math.floor(Math.random() * messages.length)];
            
            // Create temporary feedback element
            const feedback = document.createElement('div');
            feedback.style.cssText = `
                position: fixed; top: 20px; right: 20px; z-index: 1000;
                background: var(--success-color); color: white; padding: 1rem 1.5rem;
                border-radius: var(--radius-lg); box-shadow: var(--shadow-xl);
                font-weight: 600; animation: slideInRight 0.5s ease-out;
            `;
            feedback.textContent = message;
            document.body.appendChild(feedback);
            
            // Add animation styles
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideInRight {
                    from { transform: translateX(100%); opacity: 0; }
                    to { transform: translateX(0); opacity: 1; }
                }
            `;
            document.head.appendChild(style);
            
            setTimeout(() => {
                feedback.style.animation = 'slideInRight 0.5s ease-out reverse';
                setTimeout(() => feedback.remove(), 500);
                document.head.removeChild(style);
            }, 2000);
        }

        function showCompletionCelebration() {
            const celebration = document.getElementById('completionCelebration');
            celebration.classList.add('show');
            
            // Confetti effect (simple version)
            createConfetti();
            
            // Auto-hide after 5 seconds
            setTimeout(() => {
                celebration.classList.remove('show');
            }, 5000);
        }

        function createConfetti() {
            const colors = ['#46bbe5', '#10b981', '#f59e0b', '#ef4444', '#8b5cf6'];
            const confettiCount = 50;
            
            for (let i = 0; i < confettiCount; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.style.cssText = `
                        position: fixed; width: 10px; height: 10px; z-index: 1000;
                        background: ${colors[Math.floor(Math.random() * colors.length)]};
                        top: -10px; left: ${Math.random() * 100}vw;
                        animation: confettiFall ${2 + Math.random() * 3}s linear forwards;
                        border-radius: ${Math.random() > 0.5 ? '50%' : '0'};
                    `;
                    document.body.appendChild(confetti);
                    
                    setTimeout(() => confetti.remove(), 5000);
                }, i * 100);
            }
            
            // Add confetti animation
            if (!document.querySelector('#confetti-style')) {
                const style = document.createElement('style');
                style.id = 'confetti-style';
                style.textContent = `
                    @keyframes confettiFall {
                        to {
                            transform: translateY(100vh) rotate(720deg);
                            opacity: 0;
                        }
                    }
                `;
                document.head.appendChild(style);
            }
        }

        // Question and Answer functionality
        function toggleQuestion(questionId) {
            const questionItem = document.querySelector(`[data-activity="${questionId}"]`);
            const answerContent = document.getElementById(`answer-${questionId.split('-')[1]}`);
            const chevron = questionItem.querySelector('.chevron-icon');
            const header = questionItem.querySelector('.question-header');
            
            const isOpen = questionItem.classList.contains('open');
            
            if (isOpen) {
                questionItem.classList.remove('open');
                answerContent.style.maxHeight = '0';
                header.setAttribute('aria-expanded', 'false');
            } else {
                questionItem.classList.add('open');
                answerContent.style.maxHeight = '500px';
                header.setAttribute('aria-expanded', 'true');
                
                // Mark as answered after a delay
                setTimeout(() => {
                    questionItem.classList.add('answered');
                    markActivityComplete(questionId);
                }, 1000);
            }
        }

        // Enhanced star constellation game
        function createStar(event) {
            const rect = event.target.getBoundingClientRect();
            const x = event.clientX - rect.left;
            const y = event.clientY - rect.top;
            
            const star = document.createElement('div');
            star.className = 'star clicked';
            star.style.left = x + 'px';
            star.style.top = y + 'px';
            
            // Vibrant colors for stars
            const colors = ['#ffef94', '#87ceeb', '#ffa07a', '#98fb98', '#f0e68c', '#dda0dd'];
            const color = colors[Math.floor(Math.random() * colors.length)];
            star.style.background = color;
            star.style.boxShadow = `0 0 15px ${color}, 0 0 30px ${color}`;
            
            document.getElementById('starGame').appendChild(star);
            
            const starData = { element: star, x: x, y: y, color: color };
            gameState.stars.push(starData);
            
            // Connect to nearby stars
            connectNearbyStars(starData);
            
            // Add floating animation
            setTimeout(() => {
                star.style.animation = 'float 3s ease-in-out infinite';
                star.style.animationDelay = Math.random() * 2 + 's';
            }, 600);
            
            // Mark activity as complete after creating 3 stars
            if (gameState.stars.length >= 3) {
                markActivityComplete('constellation');
            }
        }

        function connectNearbyStars(newStar) {
            gameState.stars.forEach(star => {
                if (star !== newStar) {
                    const distance = Math.sqrt(
                        Math.pow(newStar.x - star.x, 2) + Math.pow(newStar.y - star.y, 2)
                    );
                    
                    if (distance < 120) {
                        createConnection(star, newStar);
                    }
                }
            });
        }

        function createConnection(star1, star2) {
            const connection = document.createElement('div');
            connection.className = 'star-connection';
            
            const dx = star2.x - star1.x;
            const dy = star2.y - star1.y;
            const length = Math.sqrt(dx * dx + dy * dy);
            const angle = Math.atan2(dy, dx) * 180 / Math.PI;
            
            connection.style.width = length + 'px';
            connection.style.left = star1.x + 'px';
            connection.style.top = star1.y + 'px';
            connection.style.transform = `rotate(${angle}deg)`;
            connection.style.background = `linear-gradient(90deg, ${star1.color}, ${star2.color})`;
            
            document.getElementById('starGame').appendChild(connection);
            gameState.connections.push(connection);
        }

        function clearStars() {
            const starGame = document.getElementById('starGame');
            const stars = starGame.querySelectorAll('.star');
            const connections = starGame.querySelectorAll('.star-connection');
            
            stars.forEach(star => star.remove());
            connections.forEach(connection => connection.remove());
            
            gameState.stars = [];
            gameState.connections = [];
        }

        function randomConstellation() {
            clearStars();
            
            // Create random star pattern
            const starCount = 5 + Math.floor(Math.random() * 5);
            const gameArea = document.getElementById('starGame').getBoundingClientRect();
            
            for (let i = 0; i < starCount; i++) {
                setTimeout(() => {
                    const x = 50 + Math.random() * (gameArea.width - 100);
                    const y = 50 + Math.random() * (gameArea.height - 100);
                    
                    const event = {
                        clientX: gameArea.left + x,
                        clientY: gameArea.top + y,
                        target: document.getElementById('starGame')
                    };
                    createStar(event);
                }, i * 200);
            }
        }

        // Enhanced phonics practice
        function practicePhonics(sound, word) {
            const card = event.target.closest('.phonics-card');
            
            // Visual feedback
            card.style.animation = 'bounce 0.6s ease-out';
            card.style.transform = 'scale(1.05)';
            card.style.borderColor = 'var(--accent-color)';
            
            // Reset after animation
            setTimeout(() => {
                card.style.animation = '';
                card.style.transform = '';
                card.style.borderColor = '';
            }, 600);
            
            // Mark phonics activity as complete after practicing 3 sounds
            const practiceCount = (gameState.phonicsPracticed || 0) + 1;
            gameState.phonicsPracticed = practiceCount;
            
            if (practiceCount >= 3) {
                markActivityComplete('phonics');
            }
        }

        // Enhanced Tic Tac Toe game
        function initTicTacToe() {
            const board = document.getElementById('ticTacToeBoard');
            board.innerHTML = '';
            
            for (let i = 0; i < 9; i++) {
                const cell = document.createElement('div');
                cell.className = 'tic-tac-toe-cell';
                cell.setAttribute('role', 'gridcell');
                cell.setAttribute('tabindex', '0');
                cell.setAttribute('aria-label', `Cell ${i + 1}`);
                cell.onclick = () => makeTicTacToeMove(i);
                cell.onkeydown = (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        makeTicTacToeMove(i);
                    }
                };
                board.appendChild(cell);
            }
        }

        function makeTicTacToeMove(index) {
            const state = gameState.ticTacToe;
            
            if (state.board[index] === '' && state.gameActive) {
                state.board[index] = state.currentPlayer;
                const cells = document.querySelectorAll('.tic-tac-toe-cell');
                cells[index].textContent = state.currentPlayer;
                cells[index].classList.add(state.currentPlayer.toLowerCase());
                cells[index].setAttribute('aria-label', `Cell ${index + 1}, ${state.currentPlayer}`);
                
                if (checkTicTacToeWinner()) {
                    const winningCombination = getWinningCombination();
                    highlightWinningCells(winningCombination);
                    
                    state.scores[state.currentPlayer]++;
                    updateTicTacToeScores();
                    document.getElementById('gameStatus').textContent = `Player ${state.currentPlayer} wins! 🎉`;
                    state.gameActive = false;
                    
                    markActivityComplete('tictactoe');
                } else if (state.board.every(cell => cell !== '')) {
                    state.scores.ties++;
                    updateTicTacToeScores();
                    document.getElementById('gameStatus').textContent = "It's a tie! 🤝";
                    state.gameActive = false;
                } else {
                    state.currentPlayer = state.currentPlayer === 'X' ? 'O' : 'X';
                    document.getElementById('gameStatus').textContent = `Player ${state.currentPlayer}'s turn`;
                }
            }
        }

        function checkTicTacToeWinner() {
            const winPatterns = [
                [0, 1, 2], [3, 4, 5], [6, 7, 8], // rows
                [0, 3, 6], [1, 4, 7], [2, 5, 8], // columns
                [0, 4, 8], [2, 4, 6] // diagonals
            ];
            
            return winPatterns.some(pattern => {
                const [a, b, c] = pattern;
                const board = gameState.ticTacToe.board;
                return board[a] && board[a] === board[b] && board[a] === board[c];
            });
        }

        function getWinningCombination() {
            const winPatterns = [
                [0, 1, 2], [3, 4, 5], [6, 7, 8], // rows
                [0, 3, 6], [1, 4, 7], [2, 5, 8], // columns
                [0, 4, 8], [2, 4, 6] // diagonals
            ];
            
            return winPatterns.find(pattern => {
                const [a, b, c] = pattern;
                const board = gameState.ticTacToe.board;
                return board[a] && board[a] === board[b] && board[a] === board[c];
            });
        }

        function highlightWinningCells(combination) {
            const cells = document.querySelectorAll('.tic-tac-toe-cell');
            combination.forEach(index => {
                cells[index].classList.add('winning');
            });
        }

        function updateTicTacToeScores() {
            const scores = gameState.ticTacToe.scores;
            document.getElementById('scoreX').textContent = scores.X;
            document.getElementById('scoreO').textContent = scores.O;
            document.getElementById('scoreTies').textContent = scores.ties;
        }

        function resetTicTacToe() {
            gameState.ticTacToe.board = Array(9).fill('');
            gameState.ticTacToe.currentPlayer = 'X';
            gameState.ticTacToe.gameActive = true;
            
            document.getElementById('gameStatus').textContent = "Player X's turn";
            initTicTacToe();
        }

        function resetScores() {
            gameState.ticTacToe.scores = { X: 0, O: 0, ties: 0 };
            updateTicTacToeScores();
        }

        // Enhanced word matching game
        function selectWord(element, word) {
            const matchState = gameState.wordMatch;
            
            if (element.classList.contains('matched')) return;
            
            if (element.classList.contains('selected')) {
                element.classList.remove('selected');
                matchState.selectedWords = matchState.selectedWords.filter(w => w.element !== element);
            } else {
                element.classList.add('selected');
                matchState.selectedWords.push({ element: element, word: word });
            }
            
            if (matchState.selectedWords.length === 2) {
                matchState.attempts++;
                checkWordMatch();
            }
        }

        function checkWordMatch() {
            const matchState = gameState.wordMatch;
            const [word1, word2] = matchState.selectedWords;
            
            if (matchState.rhymePairs[word1.word] === word2.word) {
                // Correct match!
                word1.element.classList.remove('selected');
                word2.element.classList.remove('selected');
                word1.element.classList.add('matched');
                word2.element.classList.add('matched');
                
                matchState.matchedPairs++;
                updateWordMatchScores();
                
                // Check if all pairs are matched
                if (matchState.matchedPairs === 5) {
                    markActivityComplete('wordmatch');
                    setTimeout(() => {
                        alert('🎉 Excellent! You found all the rhyming pairs!');
                    }, 500);
                }
            } else {
                // Incorrect match
                word1.element.classList.add('incorrect');
                word2.element.classList.add('incorrect');
                
                setTimeout(() => {
                    word1.element.classList.remove('selected', 'incorrect');
                    word2.element.classList.remove('selected', 'incorrect');
                }, 1000);
            }
            
            matchState.selectedWords = [];
            updateWordMatchScores();
        }

        function updateWordMatchScores() {
            const matchState = gameState.wordMatch;
            const accuracy = matchState.attempts > 0 ? 
                Math.round((matchState.matchedPairs / matchState.attempts) * 100) : 100;
            
            document.getElementById('matchedPairs').textContent = matchState.matchedPairs;
            document.getElementById('attempts').textContent = matchState.attempts;
            document.getElementById('accuracy').textContent = accuracy + '%';
        }

        function resetWordGame() {
            const matchState = gameState.wordMatch;
            
            // Reset all word items
            document.querySelectorAll('.word-item').forEach(item => {
                item.classList.remove('selected', 'matched', 'incorrect');
            });
            
            // Reset game state
            matchState.selectedWords = [];
            matchState.matchedPairs = 0;
            matchState.attempts = 0;
            
            updateWordMatchScores();
        }

        function shuffleWords() {
            const columns = document.querySelectorAll('.word-column');
            
            columns.forEach(column => {
                const items = Array.from(column.querySelectorAll('.word-item'));
                const container = items[0].parentNode;
                
                // Shuffle array
                for (let i = items.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [items[i], items[j]] = [items[j], items[i]];
                }
                
                // Re-append in new order
                items.forEach(item => container.appendChild(item));
            });
        }

        // Keyboard navigation support
        document.addEventListener('keydown', function(e) {
            if (e.target.matches('.question-header, .phonics-card, .word-item')) {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    e.target.click();
                }
            }
        });

        // Initialize the lesson when page loads
        window.addEventListener('load', function() {
            initTicTacToe();
            updateProgress();
            
            // Add floating animation CSS
            const floatStyle = document.createElement('style');
            floatStyle.textContent = `
                @keyframes float {
                    0%, 100% { transform: translateY(0px); }
                    50% { transform: translateY(-15px); }
                }
            `;
            document.head.appendChild(floatStyle);
            
            console.log('🎓 Interactive English Lesson loaded successfully!');
        });

        // Accessibility: Announce activity completions to screen readers
        function announceToScreenReader(message) {
            const announcement = document.createElement('div');
            announcement.setAttribute('aria-live', 'polite');
            announcement.setAttribute('aria-atomic', 'true');
            announcement.style.cssText = 'position: absolute; left: -10000px; width: 1px; height: 1px; overflow: hidden;';
            announcement.textContent = message;
            
            document.body.appendChild(announcement);
            setTimeout(() => document.body.removeChild(announcement), 1000);
        }

        // Enhanced activity completion with announcements
        const originalMarkComplete = markActivityComplete;
        markActivityComplete = function(activityName) {
            originalMarkComplete(activityName);
            
            const activityNames = {
                'question-1': 'Name question',
                'question-2': 'Location question', 
                'question-3': 'Friend question',
                'question-4': 'Birthday question',
                'question-5': 'English learning question',
                'question-6': 'Age question',
                'constellation': 'Star constellation game',
                'phonics': 'Phonics practice',
                'tictactoe': 'Tic tac toe game',
                'wordmatch': 'Word matching game'
            };
            
            const activityDisplayName = activityNames[activityName] || activityName;
            announceToScreenReader(`Completed: ${activityDisplayName}`);
        };
    </script>
</body>
</html>
    </script>
</body>
</html>