<!DOCTYPE html>
<html lang="en">
  <head>
    <script
      async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2456627863532019"
      crossorigin="anonymous"
    ></script>
    <meta name="google-adsense-account" content="ca-pub-2456627863532019" />
    <!-- Google tag (gtag.js) -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-9G9RD6BHLN"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
      gtag("config", "G-9G9RD6BHLN");
    </script>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="Test your typing speed and accuracy with our interactive typing speed test. Improve your WPM and typing skills with real-time feedback."
    />
    <meta
      name="keywords"
      content="typing test, typing speed, WPM, words per minute, typing skills, keyboard practice"
    />
    <meta name="author" content="ESL Fun Online" />
    <title>
      Typing Speed Test | ESL Fun Online - Improve Your Typing Skills
    </title>
    <!-- Favicon and Icons - Optimized for Google Search -->
    <link rel="icon" href="../favicon.ico" sizes="any" />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="../images/favicon-16x16.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="../images/favicon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="48x48"
      href="../images/favicon-48x48.png"
    />
    <link rel="apple-touch-icon" sizes="180x180" href="../images/1.png" />
    <link
      rel="icon"
      type="image/png"
      sizes="192x192"
      href="../images/favicon-192x192.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="512x512"
      href="../images/favicon-512x512.png"
    />

    <!-- Stylesheets -->
                <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link rel="stylesheet" href="../css/main.css?v=1763019900" />
    <link rel="stylesheet" href="../css/header.css?v=1763019900" />
    <link rel="stylesheet" href="../css/hero-unified.css?v=1763019900" />
    <link rel="stylesheet" href="../css/index-page.css?v=1763019900" />
    <link rel="stylesheet" href="../css/typing-test-page.css?v=1763019900" />
    <link rel="stylesheet" href="../css/mobile-optimized.css?v=1763019900" />
    <link rel="stylesheet" href="../css/layout-fixes.css?v=1763019900" />
    </head>
  <body>
    <!-- Header -->
    <div class="scroll-progress" id="scrollProgress"></div>
    <!-- Header & Navigation -->
    <header>
      <div class="container">
        <nav class="navbar">
          <a href="../index.html" class="logo-container">
            <img
              src="../images/1.png"
              alt="ESL Fun Online Logo"
              class="logo-image"
              width="40"
              height="40"
            />
            <span class="logo-text">ESL Fun Online</span>
          </a>

          <ul
            class="nav-links"
            id="navLinks"
            role="menubar"
            aria-label="Main navigation"
          >
            <li class="nav-item" role="none">
              <a href="../index.html" class="nav-link" role="menuitem">
                <i class="fas fa-home"></i>
                Home
              </a>
            </li>
            <li class="nav-item" role="none">
              <a
                href="#"
                class="nav-link"
                role="menuitem"
                aria-haspopup="true"
                aria-expanded="false"
              >
                <i class="fas fa-book"></i>
                English
                <i class="fas fa-chevron-down"></i>
              </a>
              <div class="dropdown" role="menu" aria-label="English submenu">
                <a href="../english/grammar.html" class="dropdown-item">
                  <i class="fas fa-spell-check"></i>
                  Grammar Guides
                </a>
                <a href="../english/vocabguide.html" class="dropdown-item">
                  <i class="fas fa-book-open"></i>
                  Vocabulary Building
                </a>
                <a href="../english/worksheets.html" class="dropdown-item">
                  <i class="fas fa-file-alt"></i>
                  Worksheets
                </a>
                <a href="../english/writingf.html" class="dropdown-item">
                  <i class="fas fa-pen"></i>
                  Writing for Success
                </a>
                <a href="../english/business.html" class="dropdown-item">
                  <i class="fas fa-briefcase"></i>
                  Business English
                </a>
                <a href="../english/test.html" class="dropdown-item">
                  <i class="fas fa-graduation-cap"></i>
                  Test Preparation
                </a>
              </div>
            </li>
            <li class="nav-item">
              <a href="#" class="nav-link">
                <i class="fas fa-code"></i>
                Coding
                <i class="fas fa-chevron-down"></i>
              </a>
              <div class="dropdown">
                <a href="../coding/computerbasics.html" class="dropdown-item">
                  <i class="fas fa-desktop"></i>
                  Computer Basics
                </a>
                <a href="../coding/ai.html" class="dropdown-item">
                  <i class="fas fa-robot"></i>
                  AI Basics
                </a>
                <a href="../coding/codingresources.html" class="dropdown-item">
                  <i class="fas fa-code"></i>
                  Coding Basics
                </a>
              </div>
            </li>

            <li class="nav-item">
              <a href="../games/games.html" class="nav-link">
                <i class="fas fa-dice"></i>
                Games
              </a>
            </li>
            <li class="nav-item">
              <a href="../tools/tools.html" class="nav-link">
                <i class="fas fa-tools"></i>
                Toolkit
              </a>
            </li>
            <li class="nav-item">
              <a href="../blog/blog.html" class="nav-link">
                <i class="fas fa-book-open"></i>
                Blog
              </a>
            </li>
          </ul>

          <div class="controls">
            <button
              class="control-btn theme-toggle"
              id="themeToggle"
              aria-label="Toggle dark mode"
            >
              <i class="fas fa-moon"></i>
            </button>
            <a
              class="control-btn admin-toggle"
              id="adminToggle"
              aria-label="Admin"
              href="../login.html"
            >
              <i class="fas fa-user-shield"></i>
            </a>
          </div>
          <button
            class="control-btn mobile-toggle"
            id="mobileToggle"
            aria-label="Toggle mobile menu"
          >
            <i class="fas fa-bars"></i>
          </button>
        </nav>
      </div>
    </header>

    <!-- Immediate Mobile Menu Script - Inline for guaranteed execution -->
    <script>
      (function () {
        "use strict";

        function initMobileMenu() {
          const mobileToggle = document.getElementById("mobileToggle");
          const navLinks = document.getElementById("navLinks");
          const body = document.body;

          if (!mobileToggle || !navLinks) {
            console.warn("Mobile menu elements not found");
            return;
          }

          console.log("Immediate mobile menu initialized");

          let isMenuOpen = false;

          function toggleMenu(e) {
            if (e && e.preventDefault) e.preventDefault();
            if (e && e.stopPropagation) e.stopPropagation();

            isMenuOpen = !isMenuOpen;
            const icon = mobileToggle.querySelector("i");

            if (isMenuOpen) {
              navLinks.classList.add("active");
              body.classList.add("mobile-menu-open");
              body.style.overflow = "hidden";
              if (icon) icon.className = "fas fa-times";
              console.log("Menu opened");
            } else {
              navLinks.classList.remove("active");
              body.classList.remove("mobile-menu-open");
              body.style.overflow = "";
              if (icon) icon.className = "fas fa-bars";
              console.log("Menu closed");

              // Close all dropdowns
              document.querySelectorAll(".nav-item").forEach((item) => {
                item.classList.remove("mobile-open", "mobile-dropdown-open");
                const chevron = item.querySelector(".fa-chevron-down");
                if (chevron) chevron.style.transform = "rotate(0deg)";
              });
            }
          }

          // Simple unified handler - works for both touch and click
          let lastToggleTime = 0;

          function handleToggleClick(e) {
            const now = Date.now();
            // Prevent double-firing within 300ms
            if (now - lastToggleTime < 300) {
              console.log("Toggle ignored - too fast");
              return;
            }
            lastToggleTime = now;

            e.preventDefault();
            e.stopPropagation();
            console.log("Hamburger clicked/tapped");
            toggleMenu(e);
          }

          mobileToggle.addEventListener("click", handleToggleClick);
          mobileToggle.addEventListener("touchend", handleToggleClick);

          // Handle dropdown toggles on mobile
          document.querySelectorAll(".nav-item").forEach((item) => {
            const link = item.querySelector(".nav-link");
            const dropdown = item.querySelector(".dropdown");
            const chevron = link?.querySelector(".fa-chevron-down");

            // Only add special handling for links WITH dropdowns
            if (link && dropdown && chevron) {
              // Simple unified dropdown handler
              let lastDropdownToggle = 0;

              function handleDropdownClick(e) {
                if (window.innerWidth > 768) return; // Only on mobile

                // Don't interfere with dropdown item clicks
                if (
                  e.target.closest(".dropdown-item") ||
                  e.target.closest(".dropdown a")
                ) {
                  console.log("Dropdown item clicked - allowing navigation");
                  return; // Let the link work normally
                }

                const now = Date.now();
                // Prevent double-firing within 300ms
                if (now - lastDropdownToggle < 300) {
                  console.log("Dropdown toggle ignored - too fast");
                  return;
                }
                lastDropdownToggle = now;

                e.preventDefault();
                e.stopPropagation();

                const isOpen = item.classList.contains("mobile-open");
                console.log(
                  "Dropdown clicked:",
                  isOpen ? "closing" : "opening"
                );

                // Close other dropdowns
                document.querySelectorAll(".nav-item").forEach((otherItem) => {
                  if (otherItem !== item) {
                    otherItem.classList.remove(
                      "mobile-open",
                      "mobile-dropdown-open"
                    );
                    const otherChevron =
                      otherItem.querySelector(".fa-chevron-down");
                    if (otherChevron)
                      otherChevron.style.transform = "rotate(0deg)";
                  }
                });

                // Toggle current dropdown
                if (isOpen) {
                  item.classList.remove("mobile-open", "mobile-dropdown-open");
                  chevron.style.transform = "rotate(0deg)";
                  link.setAttribute("aria-expanded", "false");
                } else {
                  item.classList.add("mobile-open", "mobile-dropdown-open");
                  chevron.style.transform = "rotate(180deg)";
                  link.setAttribute("aria-expanded", "true");
                }
              }

              // Remove href="#" behavior on mobile
              if (link.getAttribute("href") === "#") {
                link.style.cursor = "pointer";
              }

              // Attach handlers for both click and touch
              link.addEventListener("click", handleDropdownClick);
              link.addEventListener("touchend", handleDropdownClick);
            }
          });

          // Close menu when clicking outside
          document.addEventListener("click", function (e) {
            if (window.innerWidth <= 768 && isMenuOpen) {
              if (
                !mobileToggle.contains(e.target) &&
                !navLinks.contains(e.target)
              ) {
                toggleMenu(null);
              }
            }
          });

          // Close menu on escape key
          document.addEventListener("keydown", function (e) {
            if (e.key === "Escape" && isMenuOpen) {
              toggleMenu(null);
              mobileToggle.focus();
            }
          });

          // Close menu on window resize to desktop
          window.addEventListener("resize", function () {
            if (window.innerWidth > 768 && isMenuOpen) {
              toggleMenu(null);
            }
          });

          // Close menu after dropdown link click
          document.querySelectorAll(".dropdown a").forEach((link) => {
            link.addEventListener("click", function () {
              if (window.innerWidth <= 768 && isMenuOpen) {
                setTimeout(() => {
                  toggleMenu(null);
                }, 100);
              }
            });
          });
        }

        // Initialize immediately if DOM is ready, otherwise wait
        if (document.readyState === "loading") {
          document.addEventListener("DOMContentLoaded", initMobileMenu);
        } else {
          initMobileMenu();
        }
      })();
    </script>

    <!-- Additional Mobile Dropdown Fixes -->
    

    <main>
      <div class="container">
        <!-- Page Header -->
        <div
          style="
            text-align: center;
            margin-bottom: 3rem;
            padding: 2rem 1rem;
            background: linear-gradient(
              135deg,
              rgba(70, 187, 229, 0.1),
              rgba(16, 185, 129, 0.1)
            );
            border-radius: 20px;
          "
        >
          <h1
            style="
              font-size: 3rem;
              font-weight: 700;
              background: linear-gradient(135deg, #46bbe5, #10b981);
              -webkit-background-clip: text;
              -webkit-text-fill-color: transparent;
              background-clip: text;
              margin-bottom: 1rem;
            "
          >
            <i class="fas fa-keyboard" style="color: #46bbe5"></i> Typing Speed
            Test
          </h1>
          <p
            style="
              font-size: 1.2rem;
              color: #6b7280;
              max-width: 600px;
              margin: 0 auto;
            "
          >
            Test your typing speed and accuracy. Challenge yourself to type
            faster and more accurately!
          </p>
        </div>

        <div class="difficulty-selector">
          <h3>Choose Difficulty:</h3>
          <button class="difficulty-btn active" data-difficulty="easy">
            Easy
          </button>
          <button class="difficulty-btn" data-difficulty="medium">
            Medium
          </button>
          <button class="difficulty-btn" data-difficulty="hard">Hard</button>
        </div>

        <div class="typing-container">
          <div class="typing-text" id="typingText">
            Click "Start Test" to begin your typing challenge!
          </div>

          <textarea
            id="typingInput"
            placeholder="Type here when the test starts..."
            disabled
            autocomplete="off"
            autocorrect="off"
            autocapitalize="off"
            spellcheck="false"
            rows="4"
          ></textarea>

          <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
          </div>

          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-value" id="wpmStat">0</div>
              <div class="stat-label">WPM</div>
            </div>
            <div class="stat-card">
              <div class="stat-value" id="accuracyStat">100</div>
              <div class="stat-label">Accuracy %</div>
            </div>
            <div class="stat-card">
              <div class="stat-value" id="timeStat">60</div>
              <div class="stat-label">Time Left</div>
            </div>
            <div class="stat-card">
              <div class="stat-value" id="errorsStat">0</div>
              <div class="stat-label">Errors</div>
            </div>
          </div>

          <div class="controls">
            <button class="btn btn-primary" id="startBtn">
              <i class="fas fa-play"></i> Start Test
            </button>
            <button class="btn btn-secondary" id="resetBtn">
              <i class="fas fa-redo"></i> Reset
            </button>
            <a href="tools.html" class="btn btn-secondary">
              <i class="fas fa-arrow-left"></i> Back to Tools
            </a>
          </div>

          <div class="results-container" id="resultsContainer">
            <div class="results-title">ðŸŽ‰ Test Complete!</div>
            <div class="results-grid">
              <div class="result-item">
                <h3>Final WPM</h3>
                <div id="finalWPM" style="font-size: 2rem; font-weight: bold">
                  0
                </div>
              </div>
              <div class="result-item">
                <h3>Accuracy</h3>
                <div
                  id="finalAccuracy"
                  style="font-size: 2rem; font-weight: bold"
                >
                  0%
                </div>
              </div>
              <div class="result-item">
                <h3>Total Errors</h3>
                <div
                  id="finalErrors"
                  style="font-size: 2rem; font-weight: bold"
                >
                  0
                </div>
              </div>
              <div class="result-item">
                <h3>Performance</h3>
                <div
                  id="performanceRating"
                  style="font-size: 2rem; font-weight: bold"
                >
                  Great!
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Tips Section -->
        <div
          style="
            background: white;
            border-radius: 12px;
            padding: 2rem;
            margin-top: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
          "
        >
          <h3
            style="
              color: #374151;
              margin-bottom: 1.5rem;
              display: flex;
              align-items: center;
              gap: 0.5rem;
            "
          >
            <i class="fas fa-lightbulb" style="color: #f59e0b"></i>
            Tips to Improve Your Typing Speed
          </h3>
          <div style="display: grid; gap: 1rem">
            <div style="display: flex; gap: 1rem; align-items: start">
              <div
                style="
                  flex-shrink: 0;
                  width: 40px;
                  height: 40px;
                  background: linear-gradient(135deg, #46bbe5, #10b981);
                  border-radius: 50%;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  color: white;
                  font-weight: bold;
                "
              >
                1
              </div>
              <div>
                <strong style="color: #374151"
                  >Practice proper finger placement:</strong
                >
                <p style="color: #6b7280; margin: 0.5rem 0 0 0">
                  Keep your fingers on the home row (ASDF JKL;) and use the
                  correct finger for each key.
                </p>
              </div>
            </div>
            <div style="display: flex; gap: 1rem; align-items: start">
              <div
                style="
                  flex-shrink: 0;
                  width: 40px;
                  height: 40px;
                  background: linear-gradient(135deg, #46bbe5, #10b981);
                  border-radius: 50%;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  color: white;
                  font-weight: bold;
                "
              >
                2
              </div>
              <div>
                <strong style="color: #374151"
                  >Look at the screen, not the keyboard:</strong
                >
                <p style="color: #6b7280; margin: 0.5rem 0 0 0">
                  Train yourself to type without looking down at your hands.
                </p>
              </div>
            </div>
            <div style="display: flex; gap: 1rem; align-items: start">
              <div
                style="
                  flex-shrink: 0;
                  width: 40px;
                  height: 40px;
                  background: linear-gradient(135deg, #46bbe5, #10b981);
                  border-radius: 50%;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  color: white;
                  font-weight: bold;
                "
              >
                3
              </div>
              <div>
                <strong style="color: #374151">Focus on accuracy first:</strong>
                <p style="color: #6b7280; margin: 0.5rem 0 0 0">
                  Speed will naturally improve as you make fewer mistakes.
                </p>
              </div>
            </div>
            <div style="display: flex; gap: 1rem; align-items: start">
              <div
                style="
                  flex-shrink: 0;
                  width: 40px;
                  height: 40px;
                  background: linear-gradient(135deg, #46bbe5, #10b981);
                  border-radius: 50%;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  color: white;
                  font-weight: bold;
                "
              >
                4
              </div>
              <div>
                <strong style="color: #374151">Practice consistently:</strong>
                <p style="color: #6b7280; margin: 0.5rem 0 0 0">
                  Regular practice, even just 10-15 minutes a day, will show
                  significant improvement.
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- Footer -->
    <footer
      style="
        background: #1f2937;
        color: white;
        padding: 3rem 0 1rem;
        margin-top: 4rem;
      "
    >
      <div
        class="container"
        style="max-width: 1200px; margin: 0 auto; padding: 0 1rem"
      >
        <div
          style="
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
          "
        >
          <div>
            <h3 style="color: #46bbe5; margin-bottom: 1rem">ESL Fun Online</h3>
            <p style="color: #9ca3af; line-height: 1.6">
              Your comprehensive resource for learning English as a Second
              Language.
            </p>
          </div>
          <div>
            <h4 style="margin-bottom: 1rem">Quick Links</h4>
            <ul style="list-style: none; padding: 0">
              <li style="margin-bottom: 0.5rem">
                <a
                  href="../index.html"
                  style="color: #9ca3af; text-decoration: none"
                  >Home</a
                >
              </li>
              <li style="margin-bottom: 0.5rem">
                <a
                  href="../english/grammar.html"
                  style="color: #9ca3af; text-decoration: none"
                  >Grammar</a
                >
              </li>
              <li style="margin-bottom: 0.5rem">
                <a
                  href="../games/games.html"
                  style="color: #9ca3af; text-decoration: none"
                  >Games</a
                >
              </li>
              <li style="margin-bottom: 0.5rem">
                <a
                  href="tools.html"
                  style="color: #9ca3af; text-decoration: none"
                  >Tools</a
                >
              </li>
            </ul>
          </div>
          <div>
            <h4 style="margin-bottom: 1rem">Connect With Us</h4>
            <div style="display: flex; gap: 1rem">
              <a href="#" style="color: #46bbe5; font-size: 1.5rem"
                ><i class="fab fa-facebook"></i
              ></a>
              <a href="#" style="color: #46bbe5; font-size: 1.5rem"
                ><i class="fab fa-twitter"></i
              ></a>
              <a href="#" style="color: #46bbe5; font-size: 1.5rem"
                ><i class="fab fa-instagram"></i
              ></a>
              <a href="#" style="color: #46bbe5; font-size: 1.5rem"
                ><i class="fab fa-youtube"></i
              ></a>
            </div>
          </div>
        </div>
        <div
          style="
            border-top: 1px solid #374151;
            padding-top: 1rem;
            text-align: center;
            color: #9ca3af;
          "
        >
          <p>&copy; 2024 ESL Fun Online. All rights reserved.</p>
        </div>
      </div>
    </footer>

    <script>
      // Typing test texts for different difficulties
      const texts = {
        easy: [
          "The quick brown fox jumps over the lazy dog. This sentence contains every letter of the alphabet and is perfect for typing practice.",
          "Learning to type fast is a valuable skill. With practice and patience, anyone can improve their typing speed and accuracy.",
          "Technology has changed the way we communicate. Typing quickly helps us express our thoughts more efficiently in the digital age.",
        ],
        medium: [
          "Proficient typing skills are essential in today's digital workplace. Whether you're writing emails, creating documents, or coding, faster typing improves productivity and reduces fatigue during long work sessions.",
          "The art of touch typing involves muscle memory and proper finger placement. By positioning your fingers correctly on the home row keys, you can achieve remarkable speed improvements.",
          "Regular practice with challenging texts helps develop both speed and accuracy. Focus on maintaining consistent rhythm rather than rushing, as smooth typing often leads to better overall performance.",
        ],
        hard: [
          "Sophisticated algorithms and complex data structures require meticulous implementation. Professional programmers must balance efficiency with readability, ensuring their code remains maintainable while optimizing performance.",
          "Entrepreneurial ventures necessitate comprehensive market analysis, strategic planning, and exceptional execution capabilities. Successful organizations demonstrate adaptability, innovation, and unwavering commitment to excellence.",
          "Pharmaceutical research involves intricate molecular interactions, rigorous clinical trials, and extensive regulatory compliance. Scientists meticulously analyze experimental data to develop breakthrough treatments.",
        ],
      };

      let currentText = "";
      let currentDifficulty = "easy";
      let startTime = null;
      let endTime = null;
      let timer = null;
      let timeLimit = 60;
      let timeLeft = timeLimit;
      let isTestActive = false;
      let currentPosition = 0;
      let errors = 0;
      let correctChars = 0;

      // DOM elements
      const typingText = document.getElementById("typingText");
      const typingInput = document.getElementById("typingInput");
      const startBtn = document.getElementById("startBtn");
      const resetBtn = document.getElementById("resetBtn");
      const progressFill = document.getElementById("progressFill");
      const resultsContainer = document.getElementById("resultsContainer");

      // Stat elements
      const wpmStat = document.getElementById("wpmStat");
      const accuracyStat = document.getElementById("accuracyStat");
      const timeStat = document.getElementById("timeStat");
      const errorsStat = document.getElementById("errorsStat");

      // Difficulty selector
      document.querySelectorAll(".difficulty-btn").forEach((btn) => {
        btn.addEventListener("click", () => {
          document
            .querySelectorAll(".difficulty-btn")
            .forEach((b) => b.classList.remove("active"));
          btn.classList.add("active");
          currentDifficulty = btn.dataset.difficulty;
          if (!isTestActive) {
            loadNewText();
          }
        });
      });

      function loadNewText() {
        const textArray = texts[currentDifficulty];
        currentText = textArray[Math.floor(Math.random() * textArray.length)];
        displayText();
      }

      function displayText() {
        let displayHTML = "";
        for (let i = 0; i < currentText.length; i++) {
          let charClass = "";
          if (i < currentPosition) {
            charClass =
              typingInput.value[i] === currentText[i] ? "correct" : "incorrect";
          } else if (i === currentPosition) {
            charClass = "current";
          }
          displayHTML += `<span class="${charClass}">${currentText[i]}</span>`;
        }
        typingText.innerHTML = displayHTML;
      }

      function startTest() {
        if (isTestActive) return;

        isTestActive = true;
        startTime = Date.now();
        timeLeft = timeLimit;
        currentPosition = 0;
        errors = 0;
        correctChars = 0;

        loadNewText();
        typingInput.value = "";
        typingInput.disabled = false;
        typingInput.focus();

        startBtn.innerHTML = '<i class="fas fa-pause"></i> Test Running...';
        startBtn.disabled = true;

        resultsContainer.style.display = "none";

        timer = setInterval(updateTimer, 1000);
      }

      function updateTimer() {
        timeLeft--;
        timeStat.textContent = timeLeft;

        if (timeLeft <= 0) {
          endTest();
        }
      }

      function endTest() {
        isTestActive = false;
        endTime = Date.now();
        clearInterval(timer);

        typingInput.disabled = true;
        startBtn.innerHTML = '<i class="fas fa-play"></i> Start Test';
        startBtn.disabled = false;

        calculateResults();
        showResults();
      }

      function calculateResults() {
        const timeElapsed = (endTime - startTime) / 1000 / 60; // in minutes
        const wordsTyped = correctChars / 5; // Standard: 5 characters = 1 word
        const wpm = Math.round(wordsTyped / timeElapsed);
        const accuracy =
          Math.round((correctChars / (correctChars + errors)) * 100) || 0;

        wpmStat.textContent = wpm;
        accuracyStat.textContent = accuracy;
        errorsStat.textContent = errors;

        // Update final results
        document.getElementById("finalWPM").textContent = wpm;
        document.getElementById("finalAccuracy").textContent = accuracy + "%";
        document.getElementById("finalErrors").textContent = errors;

        // Performance rating
        let rating = "Needs Practice ðŸ“š";
        let emoji = "ðŸ’ª";
        if (wpm >= 80 && accuracy >= 95) {
          rating = "Excellent!";
          emoji = "ðŸ†";
        } else if (wpm >= 60 && accuracy >= 90) {
          rating = "Very Good!";
          emoji = "â­";
        } else if (wpm >= 40 && accuracy >= 85) {
          rating = "Good!";
          emoji = "ðŸ‘";
        } else if (wpm >= 25 && accuracy >= 80) {
          rating = "Fair";
          emoji = "ðŸ“ˆ";
        }

        document.getElementById(
          "performanceRating"
        ).innerHTML = `${emoji} ${rating}`;
      }

      function showResults() {
        resultsContainer.style.display = "block";
        resultsContainer.scrollIntoView({ behavior: "smooth" });
      }

      function resetTest() {
        isTestActive = false;
        clearInterval(timer);

        currentPosition = 0;
        errors = 0;
        correctChars = 0;
        timeLeft = timeLimit;

        typingInput.value = "";
        typingInput.disabled = true;

        startBtn.innerHTML = '<i class="fas fa-play"></i> Start Test';
        startBtn.disabled = false;

        resultsContainer.style.display = "none";

        // Reset stats
        wpmStat.textContent = "0";
        accuracyStat.textContent = "100";
        timeStat.textContent = timeLimit;
        errorsStat.textContent = "0";
        progressFill.style.width = "0%";

        loadNewText();
      }

      // Event listeners
      startBtn.addEventListener("click", startTest);
      resetBtn.addEventListener("click", resetTest);

      typingInput.addEventListener("input", (e) => {
        if (!isTestActive) return;

        const typedText = e.target.value;
        currentPosition = typedText.length;

        // Count errors and correct characters
        errors = 0;
        correctChars = 0;

        for (let i = 0; i < typedText.length; i++) {
          if (i < currentText.length) {
            if (typedText[i] === currentText[i]) {
              correctChars++;
            } else {
              errors++;
            }
          }
        }

        // Update progress
        const progress = (currentPosition / currentText.length) * 100;
        progressFill.style.width = Math.min(progress, 100) + "%";

        // Update real-time stats
        const timeElapsed = (Date.now() - startTime) / 1000 / 60;
        if (timeElapsed > 0) {
          const wpm = Math.round(correctChars / 5 / timeElapsed);
          wpmStat.textContent = wpm;
        }

        const accuracy =
          Math.round((correctChars / (correctChars + errors)) * 100) || 100;
        accuracyStat.textContent = accuracy;
        errorsStat.textContent = errors;

        displayText();

        // Check if text is completed
        if (currentPosition >= currentText.length) {
          endTest();
        }
      });

      // Prevent paste
      typingInput.addEventListener("paste", (e) => {
        e.preventDefault();
      });

      // Initialize
      loadNewText();

      // Add keyboard shortcuts
      document.addEventListener("keydown", (e) => {
        // Escape to reset
        if (e.key === "Escape" && isTestActive) {
          resetTest();
        }
        // Enter to start (when not active)
        if (e.key === "Enter" && !isTestActive && !typingInput.disabled) {
          startTest();
        }
      });

      // Show helpful hint on first load
      setTimeout(() => {
        if (!isTestActive) {
          const hint = document.createElement("div");
          hint.style.cssText =
            "position: fixed; bottom: 20px; right: 20px; background: linear-gradient(135deg, #46bbe5, #10b981); color: white; padding: 1rem 1.5rem; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.2); animation: slideInUp 0.5s ease; z-index: 1000; max-width: 300px;";
          hint.innerHTML =
            '<strong>ðŸ’¡ Tip:</strong> Press <kbd style="background: rgba(255,255,255,0.2); padding: 0.2rem 0.5rem; border-radius: 4px; font-family: monospace;">Enter</kbd> to start!';
          document.body.appendChild(hint);
          setTimeout(() => {
            hint.style.animation = "slideOutDown 0.5s ease";
            setTimeout(() => hint.remove(), 500);
          }, 3000);
        }
      }, 1000);
    </script>

    

    <script src="../js/navigation.js"></script>
  </body>
</html>
